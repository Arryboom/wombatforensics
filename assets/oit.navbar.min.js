'use strict';var webview_navbar=function(){var u=function(a,b){if(a.classList)a.classList.add(b);else{var c;if(c=a.getAttribute){a:if(c=b,a.classList)c=a.classList.contains(c);else{if(a.getAttribute){var e=a.getAttribute("class");if(e){e=" "+e+" ";c=" "+c.trim()+" ";c=-1!=e.indexOf(c);break a}}c=!1}c=!c}c&&a.setAttribute("class",a.getAttribute("class")+" "+b)}},G=function(a,b){a.classList?a.classList.remove(b):a.getAttribute&&a.setAttribute("class",a.getAttribute("class").replace(b,""))},r=function(a,
b,c){this.m_instance=document.createElement("input");this.m_onclick=null;a&&this.m_instance.setAttribute("class",a);this.m_instance.type="button";this.setText(c);b&&(this.m_instance.title=b)};r.prototype.destroy=function(){this.m_onclick&&(this.m_instance.removeEventListener("click",this.m_onclick),this.m_onclick=null);this.m_instance&&this.m_instance.parentNode&&this.m_instance.parentNode.removeChild(this.m_instance);this.m_instance=null};r.prototype.instance=function(){return this.m_instance};r.prototype.onclick=
function(a){this.m_instance.addEventListener("click",a);this.m_onclick=a};r.prototype.addClass=function(a){u(this.m_instance,a)};r.prototype.removeClass=function(a){G(this.m_instance,a)};r.prototype.show=function(a){a||void 0===a?this.m_instance.style.removeProperty("display"):this.m_instance.style.display="none"};r.prototype.disable=function(a){this.m_instance.disabled=a||void 0===a?!0:!1};r.prototype.setActive=function(a){a||void 0===a?this.addClass("oit-navbar-button-active"):this.removeClass("oit-navbar-button-active")};
r.prototype.setTooltip=function(a){a&&(this.m_instance.title=a)};r.prototype.setText=function(a){this.removeClass("oit-navbar-smbutton");this.removeClass("oit-navbar-button");this.removeClass("oit-navbar-icon");a?(this.m_instance.value=a,1==a.length?this.addClass("oit-navbar-smbutton"):this.addClass("oit-navbar-button")):(this.m_instance.value="",this.addClass("oit-navbar-icon"))};r.prototype.setStyle=function(a){this.m_instance.setAttribute("style",a)};var g=function(){};g.prototype.init=function(a,
b){this.m_active=this.m_compactMode=!1;this.m_compactFormLabel=this.m_compactForm=this.m_form=null;this.m_navSection=document.createElement("div");this.m_width=0;this.m_visible=!1;this.m_enabled=!0;this.m_buttons=null;b&&(b.id&&(this.m_navSection.id=b.id),b.className&&u(this.m_navSection,b.className));b&&"right"==b.align?u(this.m_navSection,"oit-navbar-right"):u(this.m_navSection,"oit-navbar-left");if(a){this.m_compactForm=document.createElement("form");u(this.m_compactForm,"oit-navbar-popup");this.m_navSection.appendChild(this.m_compactForm);
this.m_compactForm.style.display="none";this.m_compactFormLabel=document.createElement("label");this.m_compactFormLabel.innerHTML=a;this.m_compactForm.appendChild(this.m_compactFormLabel);var c=this;this.m_compactFormLabel.addEventListener("click",function(a){c.active()?(c.setActive(!1),C&&(C=!1,k.style.removeProperty("display"),k.firstElementChild&&k.removeChild(k.firstElementChild),OIT.toolbars.setSize(t,"auto"))):C?(k.firstElementChild&&k.removeChild(k.firstElementChild),c.setActive(!0),k.appendChild(c.form())):
(c.setActive(!0),k.appendChild(c.form()),C||(C=!0,k.style.display="block",OIT.toolbars.setSize(t,"auto")));for(a=0;a<f.length;a++)c!=f[a]&&f[a].setActive(!1)})}this.m_form=document.createElement("form");this.m_navSection.appendChild(this.m_form);D.appendChild(this.m_navSection)};g.prototype.reset=function(){this.resetSection();if(this.m_buttons){for(var a=0;a<this.m_buttons.length;a++)this.m_buttons[a].destroy();this.m_buttons=null}this.m_active=this.m_compactMode=!1;this.m_navSection=this.m_compactFormLabel=
this.m_compactForm=this.m_form=null;this.m_width=0;this.m_visible=!1;this.m_enabled=!0};g.prototype.instance=function(){return this.m_navSection};g.prototype.width=function(){0==this.m_width&&(this.m_width=this.m_navSection.offsetWidth);return this.m_width};g.prototype.form=function(){return this.m_form};g.prototype.show=function(a){(this.m_visible=!1!==a?!0:!1)&&this.m_enabled?this.m_navSection.style.removeProperty("display"):this.m_navSection.style.display="none"};g.prototype.enable=function(a){this.m_enabled=
!1!==a?!0:!1;this.m_visible&&this.m_enabled?this.m_navSection.style.removeProperty("display"):this.m_navSection.style.display="none"};g.prototype.visible=function(){return this.m_visible&&this.m_enabled};g.prototype.compactMode=function(a){this.m_compactForm&&(!1!==a&&(a=!0),a!=this.m_compactMode&&(this.setActive(!1),(this.m_compactMode=a)?(this.m_navSection.removeChild(this.m_form),this.m_compactForm.style.removeProperty("display"),u(this.m_navSection,"oit-navbar-compact")):(this.m_navSection.appendChild(this.m_form),
this.m_compactForm.style.display="none",G(this.m_navSection,"oit-navbar-compact"))))};g.prototype.setActive=function(a){this.m_compactForm&&(!1!==a&&(a=!0),a!=this.m_active&&((this.m_active=a)?u(this.m_navSection,"oit-navbar-compact-active"):G(this.m_navSection,"oit-navbar-compact-active")))};g.prototype.active=function(){return this.m_active};g.prototype.createFormElement=function(a,b,c){a=document.createElement(a);b&&a.setAttribute("class",b);c&&(a.id=c);this.m_form.appendChild(a);this.m_width=
0;return a};g.prototype.createButton=function(a,b,c,e,g){a=new r(a,b,c);if(e)a.onclick(e);!1===g&&a.disable();this.m_form.appendChild(a.instance());this.m_width=0;this.m_buttons||(this.m_buttons=[]);this.m_buttons.push(a);return a};g.prototype.onPageChange=function(a){};g.prototype.resetSection=function(){};var N=function(){var a=null,b=!0,c=null,e=null,g=null,J=null,h=!1,f=function(b){b=b?b.detail.startPage:0;for(var c=OIT.pages.count();b<c;b++){var d=document.createElement("option");d.text=OIT.pages.pageName(b);
d.value=b;a.appendChild(d);h&&OIT.pages.info(b).hiddenFromSlideshow&&(d.disabled=!0)}},l=function(){OIT.pages.moveto(a.selectedIndex)},d=function(){if(h){for(var b=a.selectedIndex;0<b;b--)if(!OIT.pages.info(b-1).hiddenFromSlideshow)return!1;return!0}return 0==a.selectedIndex},m=function(){if(h){for(var b=a.selectedIndex+1;b<a.length;b++)if(!OIT.pages.info(b).hiddenFromSlideshow)return!1;return!0}return a.selectedIndex>=a.length-1};this.resetSection=function(){OIT.pages.removeEventListener("add",f);
a&&(a.removeEventListener("change",l),a=null);J=g=e=c=null};this.onPageChange=function(n){a.selectedIndex=n.detail.page;(b=n.detail.features?n.detail.features.pages:!0)?this.enable(!0):this.enable(!1);c.disable(!b||d());e.disable(!b||m());n=n.detail.features?n.detail.features.rotate:!0;g.show(n);J.show(n)};var k=function(n){var w=h;h=n;if(a&&w!=n){for(var w=a.childNodes,s=0;s<w.length;s++)OIT.pages.info(s).hiddenFromSlideshow&&(w[s].disabled=n);c.disable(!b||d());e.disable(!b||m())}};this.init("Page ");
a=this.createFormElement("select");OIT.document.addEventListener("optionschanged",function(a){"slideshow"==a.detail.presentationMode?k(!0):"normal"==a.detail.presentationMode&&k(!1)});f();OIT.pages.addEventListener("add",f);a.addEventListener("change",l,!1);c=this.createButton("oit-navbar-pageup","Previous Page",null,function(){OIT.pages.movetoPrev()});e=this.createButton("oit-navbar-pagedown","Next Page",null,function(){OIT.pages.movetoNext()});g=this.createButton("oit-navbar-rotateleft","Rotate left",
null,function(){OIT.document.rotate(OIT.document.rotate()+90)});J=this.createButton("oit-navbar-rotateright","Rotate right",null,function(){OIT.document.rotate(OIT.document.rotate()-90)})};N.prototype=new g;var P=function(){var a=[0.1,0.25,0.5,0.75,1,1.25,1.5,2,3,5,10,20,40],b=null,c=null,e=null,g=null,f=null,h=!0,k,l=function(){OIT.document.zoom(Number(b.options[b.selectedIndex].value))},d=function(d){if(b){var w=-1;void 0!=k&&(b.remove(k),k=void 0);"page"===d.detail.mode?(g.setActive(!0),f.setActive(!1)):
"pagewidth"===d.detail.mode?(g.setActive(!1),f.setActive(!0)):(g.setActive(!1),f.setActive(!1));for(var s,O,E=0;E<b.options.length;E++){var l=Number(b.options[E].value);if(d.detail.zoom==l){w=E;break}if(l<d.detail.zoom&&(void 0===s||l>O))s=E,O=l}-1==w&&(w=k=s+1,s=document.createElement("option"),s.text=(100*d.detail.zoom).toFixed(0)+"%",s.value=d.detail.zoom,b.add(s,b[k]));-1!=w&&(h?b.selectedIndex=w:b.value=1);c.disable(!h||d.detail.zoom<=a[0]);e.disable(!h||d.detail.zoom>=a[a.length-1])}};this.resetSection=
function(){b&&(b.removeEventListener("change",l),b=null);f=g=e=c=null;OIT.document.removeEventListener("zoom",d)};this.onPageChange=function(a){(h=a.detail.features.zoom)?this.enable(!0):this.enable(!1);g.disable(!a.detail.features.fitpage);f.disable(!a.detail.features.fitpage)};this.init("Zoom ");for(var b=this.createFormElement("select"),m=0;m<a.length;m++){var z=document.createElement("option");z.text=(100*a[m]).toFixed(0)+"%";z.value=a[m];b.appendChild(z);1==a[m]&&(b.selectedIndex=m)}b.addEventListener("change",
l,!1);c=this.createButton("oit-navbar-zoomout","Zoom out",null,OIT.document.zoomOut);e=this.createButton("oit-navbar-zoomin","Zoom in",null,OIT.document.zoomIn);g=this.createButton("oit-navbar-zoompage","Fit page to window",null,function(){OIT.document.zoom("page")});f=this.createButton("oit-navbar-zoomwidth","Fit page to window width",null,function(){OIT.document.zoom("pagewidth")});this.createButton("oit-navbar-zoomactual","Zoom to actual size",null,function(){OIT.document.zoom(1)});OIT.document.addEventListener("zoom",
d)};P.prototype=new g;var Q=function(){var a=this,b=null,c=null,e=null,g=null,f=null,h=null,k=null,l=[],d=null,m=!0,z={};this.resetSection=function(){OIT.highlights.removeEventListener("mode",n);OIT.highlights.removeEventListener("activate",a.onHighlightChange);z=l=a=g=e=d=k=h=f=b=c=null};this.onPageChange=function(b){z=b.detail.features;(m=z.highlights)?(a.enable(!0),a.updateHighlightButtons()):a.enable(!1)};this.onHighlightChange=function(a){if(c){var e=OIT.highlights.current();if(!m||void 0===
e)d.disable(!0),c.disable(!0),b.disable(!0);else{var g=OIT.highlights.active(),E=a?a.detail.before:!1;a=a?a.detail.after:!1;d.disable(void 0===g);c.disable(e==OIT.highlights.first()&&!a);b.disable(e==OIT.highlights.last()&&!E)}}};this.updateHighlightButtons=function(){var a=OIT.highlights.autoHighlight(),b=OIT.highlights.autoHighlightOptions(),c="selection"===a,d=c&&!0===b.comment,m="note"===a;d&&(c=!1);f.setActive(c);h.setActive(d);k.setActive(m);a=OIT.document.selectionMode();if((c||d)&&z.textselection&&
z.rectselection){var n="rect"===a;e.setActive(!n);g.setActive(n);e.show(!0);g.show(!0)}else e.show(!1),g.show(!1);var c=c||d||m,p;for(p in l)if(d=l[p]){if(m=c&&d.style)switch(a){case "text":m=d.text;break;case "rect":m=d.rect;break;case "cell":m=d.cell}m?(d.parentdiv.style.removeProperty("display"),d.style===b.style?u(d.parentdiv,"oit-navbar-button-active"):G(d.parentdiv,"oit-navbar-button-active")):(d.parentdiv.style.display="none",G(d.parentdiv,"oit-navbar-button-active"))}};this.setHighlightStyle=
function(b,c,d){if(0<=b){var e=l[b];if(!e){var g=document.createElement("div"),f=document.createElement("div"),h=a.createFormElement("div","oit-navbar-highlightstyle oit-navbar-highlight"+b);h.appendChild(f);h.appendChild(g);e={stylediv:g,parentdiv:h,style:c};l[b]=e}e.style=c;e.parentdiv.title=d&&d.tooltip?d.tooltip:"";e.stylediv.style.cssText=d&&d.buttonStyle?d.buttonStyle:c;e.text=!d||void 0===d.text||!0===d.text;e.rect=!d||void 0===d.rect||!0===d.rect;e.cell=!d||void 0===d.cell||!0===d.cell;e.parentdiv.onclick=
function(){var a=OIT.highlights.autoHighlight();("selection"===a||"note"===a)&&OIT.highlights.autoHighlightOptions({style:e.style})}}};var n=function(b){a.updateHighlightButtons()};a.init("Highlight ");c=a.createButton("oit-navbar-prevhighlight","Previous highlight","\u25b2",function(a){OIT.highlights.movetoPrev()},!1);b=a.createButton("oit-navbar-nexthighlight","Next highlight","\u25bc",function(a){OIT.highlights.movetoNext()},!1);f=a.createButton("oit-navbar-highlight","Add highlights",null,function(){var a=
OIT.highlights.autoHighlight(),b=OIT.highlights.autoHighlightOptions(),c=!0===b.comment,d=!0===b.anchoredNote;"selection"==a&&!c&&!d?OIT.highlights.autoHighlight(!1):OIT.highlights.autoHighlight("selection",{style:b.style,comment:null,sticky:!0})});h=a.createButton("oit-navbar-comment","Add comments",null,function(){var a=OIT.highlights.autoHighlight(),b=OIT.highlights.autoHighlightOptions(),c=!0===b.comment,d=!0===b.anchoredNote;"selection"==a&&c&&!d?OIT.highlights.autoHighlight(!1):OIT.highlights.autoHighlight("selection",
{style:b.style,comment:!0,sticky:!0})});k=a.createButton("oit-navbar-note","Add notes",null,function(){var a=OIT.highlights.autoHighlight(),b=OIT.highlights.autoHighlightOptions(),c=!0===b.anchoredNote;"selection"==a&&c?OIT.highlights.autoHighlight(!1):OIT.highlights.autoHighlight("note",{style:b.style,comment:!0,sticky:!1})});d=a.createButton("oit-navbar-removehighlight","Remove current highlight",null,function(){OIT.highlights.remove()},!1);e=a.createButton("oit-navbar-textmode","Text selection mode",
null,function(){OIT.document.selectionMode("text");a.updateHighlightButtons()});g=a.createButton("oit-navbar-rectmode","Rectangular selection mode",null,function(){OIT.document.selectionMode("rect");a.updateHighlightButtons()});a.setHighlightStyle(0,"background-color:rgba(255,255,127,0.5);",{tooltip:"Yellow highlight"});a.setHighlightStyle(1,"background-color:rgba(191,255,191,0.5);",{tooltip:"Green highlight"});a.setHighlightStyle(2,"background-color:rgba(255,191,191,0.5);",{tooltip:"Pink highlight"});
OIT.highlights.autoHighlightOptions({style:"background-color:rgba(255,255,127,0.5);"});OIT.highlights.addEventListener("mode",n);OIT.highlights.addEventListener("activate",a.onHighlightChange)};Q.prototype=new g;var R=function(){var a=this,b=null,c=null,e=null,g=!1;this.resetSection=function(){e=c=b=a=null};this.hasProperties=function(){return g};var f=function(a,b){var c=document.createElement("tr"),d=document.createElement("td");u(d,"oit-navbar-propname");c.appendChild(d);d.innerHTML=a;d=document.createElement("td");
c.appendChild(d);void 0!==b&&(d.innerHTML=b);return c},h=function(a,b){a.lastElementChild.innerHTML=void 0===b?"":b.toString()},k=function(){this.m_propertiesVisible?(this.m_propertiesVisible=!1,b.setActive(!1),c.style.removeProperty("display"),a.instance().removeChild(c)):(this.m_propertiesVisible=!0,b.setActive(!0),a.instance().getBoundingClientRect(),c.style.display="block",a.instance().appendChild(c),c.style.left=b.instance().offsetWidth-e.offsetWidth+"px")};this.init(null,{align:"right"});var l=
OIT.document.properties();if(l){g=!0;c=document.createElement("div");u(c,"oit-navbar-proplist");e=document.createElement("div");u(e,"oit-navbar-proplist-content");c.appendChild(e);var d=f("Title"),m=f("Author"),p=f("Company"),n=f("Subject"),q=f("Keywords"),s=f("Category"),r=f("Created"),t=f("Modified");l.general&&(h(d,l.general.title),h(m,l.general.author),h(p,l.general.company),h(n,l.general.subject),h(q,l.general.keywords),h(s,l.general.category),h(r,l.general.creationDate),h(t,l.general.lastSaveDate));
h=document.createElement("table");h.appendChild(d);h.appendChild(m);h.appendChild(p);h.appendChild(n);h.appendChild(q);h.appendChild(s);h.appendChild(r);h.appendChild(t);e.appendChild(h);if(l.statistics){d=document.createElement("div");d.innerHTML="Statistics";u(d,"oit-navbar-propheading");e.appendChild(d);var m=document.createElement("table"),v;for(v in l.statistics){d=v;switch(v){case "backupDate":d="Backup date";break;case "completedDate":d="Completed Date";break;case "charCount":d="Characters";
break;case "pageCount":d="Pages";break;case "wordCount":d="Words";break;case "byteCount":d="Bytes";break;case "lineCount":d="Lines";break;case "paraCount":d="Paragraphs";break;case "slideCount":d="Slides";break;case "hiddenSlideCount":d="Hidden Slides";break;case "noteCount":d="Notes";break;case "charCountWithSpaces":d="Characters (with spaces)";break;case "editMinutes":d="Total editing time";break;case "lastPrintDate":d="Print Date";break;case "lastSavedBy":d="Last saved by";break;case "revisionDate":d=
"Revision date";break;case "revisionNumber":d="Revision number";break;case "versionDate":d="Version date";break;case "versionNumber":d="Version number"}d=f(d,l.statistics[v]);m.appendChild(d)}e.appendChild(m)}if(l.other){v=document.createElement("div");v.innerHTML="Other Properties";u(v,"oit-navbar-propheading");e.appendChild(v);v=document.createElement("table");m=0;for(p=l.other.length;m<p;m++)d=f(l.other[m].name,l.other[m].value),v.appendChild(d);e.appendChild(v)}b=this.createButton("oit-navbar-properties",
"Document properties",null,k)}};R.prototype=new g;var S=function(){this.init(null,{className:"oit-navbar-branding"});this.setLogo=function(a){a?(this.instance().innerHTML="<img src='"+a+"' height='35'>",this.enable(!0)):this.enable(!1)}};S.prototype=new g;var t,p=null,K=null,D=null,H=!1,k=null,C=!1,f=[],L=!1,I=!1,F=!1,A=null,B=null,q=null,x=null,y=null,T=function(a){a&&(A.onPageChange(a),B.onPageChange(a),q.onPageChange(a),I&&(!L&&(!x||!x.visible())&&!A.visible()&&!B.visible()&&!q.visible()&&!y.visible()?
F||(F=!0,OIT.toolbars.hide(t)):F&&(F=!1,OIT.toolbars.show(t))))},W=function(){p&&(OIT.toolbars.remove(t),OIT.toolbars.removeEventListener("show",U),OIT.toolbars.removeEventListener("hide",V),OIT.toolbars.removeEventListener("resize",M),OIT.pages.removeEventListener("change",T),p=null);t=void 0;D=K=p=null;H=!1;k=null;C=!1;f=[];F=I=L=!1;A&&(A.reset(),A=null);B&&(B.reset(),B=null);q&&(q.reset(),q=null);x&&(x.reset(),x=null);y&&(y.reset(),y=null)},M=function(a){if("top"==a.detail.edge){for(var b=0,c=
0;c<f.length;c++)f[c].visible()&&(b+=f[c].width());var e=p.clientWidth;a&&(e=a.detail.width,p.style.width=e+"px");if(H&&b<e){for(c=b=0;c<f.length&&!(f[c].compactMode(!1),f[c].visible()&&(b+=f[c].width()),b>e);c++);if(b>e)for(c=0;c<f.length;c++)f[c].compactMode(!0);else H=!1,C&&(C=!1,k.style.removeProperty("display"),k.firstElementChild&&k.removeChild(k.firstElementChild),OIT.toolbars.setSize(t,"auto")),OIT.toolbars.setSize(t,"auto")}else if(!H&&b>e){H=!0;for(c=0;c<f.length;c++)f[c].compactMode(!0);
OIT.toolbars.setSize(t,"auto")}}},U=function(a){if("top"==a.detail.edge){var b=K;x.show(!b.hideProperties&&x.hasProperties());A.show(!b.hidePageSelection);B.show(!b.hideZoomSelection);q.show(!b.hideHighlights);b.logo?(y.setLogo(b.logo),y.show(!0)):y.show(!1);I=!0;F=!1;p.style.removeProperty("display");M(a);q.updateHighlightButtons()}},V=function(){p&&I&&(I=!1)};OIT.document.addEventListener("load",function(a){W();K=a||{};p||(p=document.createElement("nav"),p.setAttribute("class","oit-navbar"));D||
(D=document.createElement("nav"),D.setAttribute("class","oit-navbar-sections"),p.appendChild(D));x||(x=new R,f.push(x));y||(y=new S,f.push(y));A||(A=new N,f.push(A));B||(B=new P,f.push(B));q||(q=new Q,f.push(q));a=document.createElement("div");a.setAttribute("class","oit-navbar-filler");D.appendChild(a);a=document.createElement("div");a.setAttribute("class","oit-navbar-clear");D.appendChild(a);k||(k=document.createElement("div"),k.setAttribute("class","oit-navbar-popupmenu"),p.appendChild(k));t=OIT.toolbars.add("top",
p,{border:"1px solid #aaa"});OIT.toolbars.addEventListener("show",U);OIT.toolbars.addEventListener("hide",V);OIT.toolbars.addEventListener("resize",M);OIT.pages.addEventListener("change",T);OIT.toolbars.show(t)});OIT.document.addEventListener("unload",W);return{createSection:function(a,b){var c=new g;c.init(a,b);f.push(c);L=!0;return c.instance()},setHighlightStyle:function(a,b,c){q&&(q.setHighlightStyle(a,b,c),q.updateHighlightButtons())}}}();
