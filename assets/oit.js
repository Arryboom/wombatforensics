/*
 Copyright (c) 2012, 2016, Oracle. All rights reserved. */
'use strict';if(window.OIT){var modView=window.OIT.view;modView&&(modView.detach?modView.detach():modView.unload&&modView.unload())}
window.OIT=function(){var a=function(){b.globalEvents.init.dispatch();b.globalEvents.init.reset()},b={extend:function(){if(0<arguments.length){var c=arguments[0];switch(typeof c){case "function":c.call(b,b);break;case "string":var d=b[c];d&&(c=d.extend)&&c.apply(d,arguments);break;case "boolean":d=b,d.globalEvents.install.dispatch(d),d.globalEvents.install.reset(),!c&&window.OIT&&delete window.OIT.extend,window.addEventListener("load",a)}}},subclass:function(a,d){d||(d=b.Object);return a.prototype=
Object.create(d.prototype)},uninstall:function(){var a=window.OIT.view;a&&a.detach()},"export":function(a,b,d){Object.defineProperty(OIT,a,{value:b,writable:!!d})}},d={extend:function(){b.extend.apply(this,arguments)}};Object.defineProperties(d,{uninstall:{value:function(){b&&(b.uninstall(),b=null);window.OIT=void 0},writable:!0}});return d}();(function(a,b){OIT.extend(function(d){var c=/^[.#\w][-_\.\w\d]*$/,g=("oit"+Math.random()).replace(/\W/g,""),f=[],k=1,m=d.doc=function(a){if(c.test(a)){if(0==a.lastIndexOf("#",0))return m.byId(a.slice(1));if(0==a.lastIndexOf(".",0))return m.byClass(a.slice(1));if(0===a.indexOf(" "))return m.byTagName(a)}return m.bySelector(a)};Object.defineProperties(m,{html:{get:function(){return m.wrap(b.documentElement)}},body:{get:function(){return m.wrap(b.body)}},head:{get:function(){return m.wrap(m.html.childByTagName("head"))}},
expando:{value:g}});m.byId=function(a){return m.wrap(b.getElementById(a))};m.byClass=function(a){return m.wrap(b.getElementsByClassName(a))};m.byTagName=function(a){return m.wrap(b.getElementsByTagName(a))};m.bySelector=function(a){return m.wrap(b.querySelectorAll(a))};m.attach=function(a){a.data("_elem",a)};m.query=function(a){return m.data(a,"_elem")};m.isElement=function(a){return a&&(a.dom||1===a.nodeType)};m.isText=function(a){return a&&3===a.nodeType};m.isDescendantOf=function(a,b){a=m.unwrap(a);
for(b=m.unwrap(b);a.parentNode;){if(a.parentNode===b)return!0;a=a.parentNode}return!1};m.unwrap=function(a){a&&a.dom&&(a=a.dom);return a};m.wrap=function(a){if(a){if(0<=a.length){var b;"function"===typeof a.item?b=[]:Array.isArray(a)&&(b=a);if(b){for(var c=0;c<a.length;c++)b[c]=m.wrap(a[c]);0===b.length&&(b=void 0);return b}}if(a.tagName&&!a.dom)return(b=m.query(a))||(b=new d.Element(a)),b}return a};m.acceptsData=function(a){return a&&(1===a.nodeType||9===a.nodeType)};m.data=function(a,b,c){a=m.unwrap(a);
if(m.acceptsData(a)&&b){var n=a[g];if(void 0!==c){if(!n){do n=k++;while(void 0!==f[n]);Object.defineProperty(a,g,{value:n})}f[n]||(f[n]={});m.nodeToString&&(a=m.nodeToString(a),f[n].domNode=a);return f[n][b]=c}var d;n&&(c=f[n])&&(d=c[b]);void 0===d&&a.getAttribute&&(d=a.getAttribute("data-"+b),null===d&&(d=void 0));return d}};m.destroyData=function(a){a=m.unwrap(a);if(m.acceptsData(a)&&(a=a[g]))f[a]=void 0,a<k&&(k=a)};m.removeData=function(a,b){a=m.unwrap(a);if(m.acceptsData(a)){var c=a[g];if(c)if(b){if(c=
f[c]){delete c[b];var d;a:{for(d in c)if(Object.prototype.hasOwnProperty.call(c,d)){d=!0;break a}d=!1}d||m.removeData(a)}}else f[c]=void 0}};m.removeSubtreeData=function(a){m.removeData(a);for(a=a.firstElementChild;a;a=a.nextElementSibling)m.removeSubtreeData(a)};m.reset=function(){var a,b;for(b in f){var c=f[b];c&&(m.logUnreleasedData&&m.logUnreleasedData(c),a||(a=[]),a[b]=c)}a?f=a:(f=[],k=1)};m.hasClass=function(a,b){if(Array.isArray(b)){for(var c=0;c<b.length;c++)if(m.hasClass(a,b[c]))return!0;
return!1}a=m.unwrap(a);return a.classList?a.classList.contains(b):a.getAttribute&&(c=a.getAttribute("class"))?(c=" "+c+" ",b=" "+b.trim()+" ",-1!=c.indexOf(b)):!1};m.addClass=function(a,b){a=m.unwrap(a);if(a.classList)a.classList.add(b);else if(a.getAttribute&&!m.hasClass(a,b)){var c=a.getAttribute("class");a.setAttribute("class",c+(" "+b))}};m.removeClass=function(a,b){a=m.unwrap(a);if(a.classList)a.classList.remove(b);else if(a.getAttribute){var c=a.getAttribute("class").replace(b,"");a.setAttribute("class",
c)}};m.create=function(a,b,c,n){return new d.Element(a,b,c,n)};m.createText=function(a){return b.createTextNode(a)};m.listen=function(a,c,d){return b.addEventListener(a,c,d)};m.unlisten=function(a,c,d){return b.removeEventListener(a,c,d)};m.cursor=function(a){void 0!==a&&(b.body.style.cursor=a);return b.body.style.cursor};m.clearSelection=function(){a.focus();if(a.getSelection){var b=a.getSelection();null!=b&&b.removeAllRanges()}};m.selectRange=function(c,f,l,n){a.focus();if(a.getSelection){var g;
d.util.isDOMRange(c)?g=c:(g=b.createRange(),g.setStart(c,f),g.setEnd(l,n));c=a.getSelection();c.removeAllRanges();c.addRange(g)}};m.selectedText=function(){var c;if(a.getSelection){var d=a.getSelection();d&&(c=d.toString())}else b.selection&&"Control"!=b.selection.type&&(c=b.selection.createRange().text);c||(c="");return c}})})(window,document);OIT.extend(function(a){a.Object=function(){};var b=a.Object.prototype;b.prop=function(a,b,g,f){"string"===typeof a&&void 0!==b&&Object.defineProperty(this,a,{value:b,writable:!!g})};b.deleteAll=function(){for(var a in this)this.hasOwnProperty(a)&&delete this[a]};b.invalidArg=function(b,c,g,f){var k="";this.publicName&&b&&(k=this.publicName+"."+b+": ");k=c?k+("Invalid value specified for argument '"+c+"'"):k+"Invalid argument";g&&(k+=": '"+a.util.stringify(g)+"'");f&&(k+=", "+f);this.logError(b,k)};
b.logError=function(b,c){var g;this.publicName&&b&&(g=this.publicName+"."+b+": ");c&&(g=(g?g+": ":"")+String(c));g&&0<g.length&&a.dispatch("document","error",g)&&console.error(g)};b.logFatalError=function(b,c){var g;this.publicName&&b&&(g=this.publicName+"."+b+": ");c&&(g=(g?g+": ":"")+String(c));g&&0<g.length&&a.dispatch("document","error",g)&&console.error(g)}});OIT.extend(function(a){var b=a.doc,d=[];d[0]=d[23]="right";d[5]=d[6]="up";d[11]=d[12]="left";d[17]=d[18]="down";a.Element=function(a){void 0===a&&(a="div");if("string"==typeof a){var e=this.dom=document.createElement(a),c=1;if(c<arguments.length){var d;"string"==typeof arguments[c]?d=arguments[c++]:Array.isArray(arguments[c])&&(d=arguments[c++].join(" "));d&&d.length&&e.setAttribute("class",d)}c<arguments.length&&"string"==typeof arguments[c]&&(e.id=arguments[c++]);c<arguments.length&&(e=b.wrap(arguments[c++]))&&
b.isElement(e)&&e.append(this)}else b.isElement(a)&&(this.dom=b.unwrap(a))};for(var c=a.subclass(a.Element),g="clientLeft clientTop clientWidth clientHeight offsetWidth offsetHeight scrollWidth scrollHeight parentNode tagName".split(" "),f=function(a){Object.defineProperty(c,a,{get:function(){return this.dom[a]}})},k=0;k<g.length;k++)f(g[k]);Object.defineProperties(c,{id:{get:function(){return this.dom.id},set:function(a){this.dom.id=a}},opacity:{get:function(){return Number(this.computedStyleProp("opacity"))},
set:function(a){this.dom.style.opacity=a}},offsetLeft:{get:function(){return this.dom.offsetLeft},set:function(b){this.dom.style.left=a.math.round(b)+"px"}},offsetTop:{get:function(){return this.dom.offsetTop},set:function(b){this.dom.style.top=a.math.round(b)+"px"}},scrollLeft:{get:function(){return this.dom.scrollLeft},set:function(b){this.dom.scrollLeft=a.math.round(b)}},scrollTop:{get:function(){return this.dom.scrollTop},set:function(b){this.dom.scrollTop=a.math.round(b)}},innerWidth:{get:function(){var a=
this.computedStyleProp("width");return-1!=a.indexOf("px")?parseInt(a):this.dom.clientWidth},set:function(b){this.dom.style.width=a.math.round(b)+"px"}},innerHeight:{get:function(){var a=this.computedStyleProp("height");return-1!=a.indexOf("px")?parseInt(a):this.dom.clientHeight},set:function(b){this.dom.style.height=a.math.round(b)+"px"}}});c.focus=function(){this.dom.focus()};c.blur=function(){this.dom.blur()};c.parent=function(){return b.wrap(this.dom.parentNode)};c.firstChildElem=function(){return b.wrap(this.dom.firstElementChild)};
c.nextSiblingElem=function(){return b.wrap(this.dom.nextElementSibling)};c.destroy=function(){var a=this.dom.parentNode;a&&a.removeChild(this.dom);this.destroyChildren();b.destroyData(this.dom);this.deleteAll()};var m=function(a){for(var e=a.firstElementChild;e;e=a){a=e.nextElementSibling;m(e);var c=b.query(e);c?c.destroy():b.removeData(e)}};c.destroyChildren=function(){m(this.dom)};c.equals=function(a){return this.dom==b.unwrap(a)};c.html=function(a){void 0!==a&&(this.destroyChildren(),this.dom.innerHTML=
a);return this.dom.innerHTML};c.text=function(a){void 0!==a&&(this.destroyChildren(),this.dom.textContent=a);return this.dom.textContent};c.data=function(a,e){return b.data(this.dom,a,e)};c.ancestorData=function(e){for(var c,d=this.dom,n=b.unwrap(a.glob.rootNode);d;){c=b.data(d,e);if(void 0!==c)break;if(d==n)break;d=d.parentNode}return c};c.removeData=function(a){return b.removeData(this.dom,a)};c.hasClass=function(a){return b.hasClass(this.dom,a)};c.addClass=function(a){b.addClass(this.dom,a);return this};
c.removeClass=function(a){b.removeClass(this.dom,a);return this};c.attr=function(a,b){if(Array.isArray(a)){for(var e={},c=0;c<a.length;c++){var d=a[c];e[d]=this.dom.getAttribute(d)}return e}if(void 0===b){if("string"===typeof a)return this.dom.getAttribute(a);for(d in a)a.hasOwnProperty(d)&&this.dom.setAttribute(d,a[d])}else null===b?this.dom.removeAttribute(a):this.dom.setAttribute(a,b);return this};c.css=function(b,e){var c=this.dom;if(c){c=c.style;try{if(Array.isArray(b)){for(var d={},n=0;n<b.length;n++){var r=
b[n];d[r]=c.getPropertyValue(h(r))}return d}if(void 0===e){if("string"===typeof b){if(-1==b.indexOf(":"))return c.getPropertyValue(h(b));(d=a.css.parse(b))&&this.css(d)}for(r in b)b.hasOwnProperty(r)&&(n=b[r],null===n||void 0===n?c.removeProperty(h(r)):c.setProperty(h(r),n,""))}else null===e?c.removeProperty(h(b)):c.setProperty(h(b),e,"")}catch(q){}}return this};var h=function(b){return a.css.nameMap[b]||b};c.removeStyle=function(a){var b=this.dom;if(Array.isArray(a))for(var e=0;e<a.length;e++)b.style.removeProperty(a[e]);
else if("string"===typeof a)b.style.removeProperty(a);else for(e in a)a.hasOwnProperty(e)&&b.style.removeProperty(e);return this};c.resetStyle=function(){return this.attr("style",null)};c.computedStyle=function(){return window.getComputedStyle(this.dom)};c.computedStyleProp=function(a){return this.computedStyle().getPropertyValue(a)};c.show=function(){this._hidden&&(this.removeStyle("display"),delete this._hidden);return this};c.hide=function(){this._hidden||(this.css("display","none"),this._hidden=
!0);return this};c.isHidden=function(){return this._hidden};c.autoscroll=function(a,b){var e=this.dom;switch(arguments.length){case 0:return{left:e.scrollLeft,top:e.scrollTop};case 1:return this.autoscroll(a.left,a.top);case 2:void 0!==a&&(e.scrollLeft=a),void 0!==b&&(e.scrollTop=b)}return this};c.scroll=function(a,b){(void 0!==a||void 0!==b)&&this.cancelKinetic();return this.autoscroll.apply(this,arguments)};c.dscroll=function(a,b){this.cancelKinetic();a&&(this.dom.scrollLeft+=a);b&&(this.dom.scrollTop+=
b)};c.animate=function(b){b&&(this.finishAnimation(),this.dom&&new a.Animation(this,b))};c.finishAnimation=function(){var a=this.data("_animation");a&&a.finish()};c.abortAnimation=function(){var a=this.data("_animation");a&&a.abort()};c.append=function(){if(this.dom)for(var a=arguments,e=0;e<a.length;e++){var c=a[e];Array.isArray(c)?this.append.apply(this,c):this.dom.appendChild(b.unwrap(c))}return this};c.insert=function(a,e){this.dom&&this.dom.insertBefore(b.unwrap(a),b.unwrap(e));return this};
c.insertAfter=function(a,e){this.dom&&(a=b.unwrap(a),e=b.unwrap(e),e=e.nextSibling,this.dom.insertBefore(a,e));return this};c.insertFirst=function(a){this.dom&&this.dom.insertBefore(b.unwrap(a),this.dom.firstChild);return this};c.transferFrom=function(a){a=b.unwrap(a);if(this.dom&&a)for(;0<a.childNodes.length;)this.dom.appendChild(a.childNodes[0]);return this};c.forElementAndAncestors=function(e){for(var c=this,d=b.unwrap(a.glob.rootNode);c&&!1!==e(c)&&c!=d;)c=c.parent();return this};c.forChildElements=
function(a){return p.call(this,a,!1,arguments)};c.queryChildElements=function(a){return p.call(this,a,!0,arguments)};var p=function(a,e,c){for(var d=[null,-1],n=1;n<c.length;n++)d.push(c[n]);c=0;var h=this.dom.firstElementChild;for(c=0;h;h=n,c++)if(n=h.nextElementSibling,h=!0===e?b.query(h):b.wrap(h))if(d[0]=h,d[1]=c,!1===a.apply(null,d))break;return this};c.pos=function(a){var e=this.dom;a=b.unwrap(a);if(a==e)return{left:0,top:0};for(;e&&!e.getBoundingClientRect;)e=e.parentNode;if(e)return e=e.getBoundingClientRect(),
e={left:e.left,top:e.top},a&&a!==document.body&&(a=a.getBoundingClientRect(),e.left-=a.left,e.top-=a.top),e};c.size=function(){for(var a=this.dom;a&&!a.getBoundingClientRect;)a=a.parentNode;if(a)return a=a.getBoundingClientRect(),{width:a.width,height:a.height}};c.rect=function(a){a=b.unwrap(a);for(var e=this.dom;e&&!e.getBoundingClientRect;)e=e.parentNode;if(e){var c=e.getBoundingClientRect(),c={left:c.left,top:c.top,right:c.right,bottom:c.bottom,width:c.width,height:c.height};a&&a!==document.body&&
(a==e?(c.right-=c.left,c.bottom-=c.top,c.left=0,c.top=0):(a=a.getBoundingClientRect(),c.left-=a.left,c.top-=a.top,c.right-=a.left,c.bottom-=a.top));return c}};c.inRect=function(a,b){var e=this.dom;return e&&0<=a&&0<=b&&a<=e.clientWidth&&b<=e.clientHeight};c.ancestorByClass=function(b){for(var e=this.parent(),c=a.glob.rootNode;e;){if(e.hasClass(b))return e;if(e.equals(c))break;e=e.parent()}return null};c.childByTagName=function(a){a=a.toUpperCase();for(var e=this.dom.firstElementChild;e;e=e.nextElementSibling)if(e.tagName.toUpperCase()===
a)return b.wrap(e);return null};c.childByClass=function(a){if(this)for(var b=this.firstChildElem();b;b=b.nextSiblingElem())if(b.hasClass(a))return b;return null};c.byClass=function(a){return b.wrap(this.dom.getElementsByClassName(a))};c.byId=function(a){for(var e=[b.unwrap(this.dom)];0<e.length;)for(var c=e.shift().firstElementChild;c;c=c.nextElementSibling){if(c.id===a)return b.wrap(c);e.push(c)}};c.byTag=function(a){a=a.toUpperCase();for(var e=[b.unwrap(this.dom)],c=[];0<e.length;)for(var d=e.shift().firstElementChild;d;d=
d.nextElementSibling)d.tagName.toUpperCase()===a?c.push(b.wrap(d)):e.push(d);if(c.length)return c};c.isDescendantOf=function(a){return b.isDescendantOf(this.dom,a)};c.mousePos=function(a){a||(a=window.event);for(var b={x:0,y:0},e=this.dom;e;e=e.offsetParent)b.x+=e.offsetLeft,b.y+=e.offsetTop;if(a.pageX||a.pageY)b.x=a.pageX-b.x,b.y=a.pageY-b.y;else if(a.clientX||a.clientY)b.x=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft-b.x,b.y=a.clientY+document.body.scrollTop+document.documentElement.scrollTop-
b.y;return b};c.touchPos=function(a){if(a){for(var b=0,e=0,c=this.dom;c;c=c.offsetParent)b+=c.offsetLeft,e+=c.offsetTop;return{identifier:a.identifier,x:a.pageX-b,y:a.pageY-e}}};c.select=function(){window.focus();if(window.getSelection){var a=document.createRange();a.selectNodeContents(this.dom);b.selectRange(a)}else document.selection&&document.body.createTextRange&&(a=document.body.createTextRange(),a.moveToElementText(this.dom),a.select())};var l=function(a){for(var e=!0;e;){var c=a.currentNode;
if(1===c.nodeType)if("svg"===c.nodeName)e=a.skipNode();else if(c=b.data(c,"acc"),void 0!==c)if("none"===c)e=a.skipNode();else break;else break;else if(3===c.nodeType)break;else e=a.nextNode()}return e},n=function(){for(;;){var a=this.nextSibling();if(a)return a;if(!this.parentNode())return null}},x=function(a){for(;this.currentNode!==a&&this.nextNode(););return this.currentNode===a},s=function(){return l(this)},w=function(){var a=this.nextNode();a&&(a=l(this));return a};c.createTreeWalker=function(a,
b,e){void 0===a&&(a=NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);void 0===b&&(b=null);void 0===e&&(e=!1);a=document.createTreeWalker(this.dom,a,b,e);a.skipNode=n;a.skipToNode=x;a.firstACCNode=s;a.nextACCNode=w;return a};c.createCanvas=function(){return new a.Canvas(this)};c.on=function(a,e,c){if("function"===typeof c){var d=Array.prototype.slice.call(arguments,2);d[0]=null;e=e||this;var n,h=this.dom;n=a;var r=b.data(h,"_events");r||(r={},b.data(h,"_events",r));(h=r[n])||(h=r[n]=[]);n=h;for(r=0;r<
n.length;r++)if(h=n[r],h.fn===c){h.ref=e;h.args=d;c=null;break}c&&(n.push({fn:c,ref:e,args:d}),1==n.length&&(d=this._events[a])&&d.add&&d.add(this,a))}return this};c.off=function(a,b){if("function"===typeof b){var e=t(this.dom,a);if(e){for(var c=0;c<e.length;c++)if(e[c].fn===b){e.splice(c,1);break}0==e.length&&(e=this._events[a])&&e.remove&&e.remove(this,a)}}return this};for(var t=function(a,e){var c=b.data(a,"_events");if(c&&(c=c[e])&&0<c.length)return c},e=function(a,b,e){a["on"+b]=function(a,e){1==
arguments.length&&(e=a,a=null);return this.on(b,a,e)};a["off"+b]=function(a){return this.off(b,a)};a._events||(a._events={});a._events[b]=e},q=function(b){var e=t(b.currentTarget,b.type);if(e){for(var c=!0,d=0;d<e.length;d++){var n=e[d];n.args[0]=b;!1===n.fn.apply(n.ref,n.args)&&(c=!1);n.args[0]=null}c||a.util.preventDefault(b)}},g="mouseover mouseout mouseenter mouseleave mousedown mousemove mouseup mousewheel touchstart touchmove touchend touchcancel click dblclick contextmenu keydown keyup keypress blur focus scroll".split(" "),
f={add:function(a,b){a.dom.addEventListener(b,q)},remove:function(a,b){a.dom.removeEventListener(b,q)}},k=0;k<g.length;k++)e(c,g[k],f);for(var g="tap press pressup panstart panmove panend pancancel dragstart dragmove dragend dragcancel swipeleft swiperight swipeup swipedown pinchstart pinchmove pinchend pinchcancel rotatestart rotatemove rotateend rotatecancel".split(" "),y=function(a){return"dragstart"===a||"dragmove"===a||"dragend"===a||"dragcancel"===a},v=function(a,b){var e=a.data("_gestures");
!e&&b&&(e={listenerCount:0},a.data("_gestures",e));return e},f={add:function(a,b){var e=v(a,!0);e.touches||(e.touches=[],a.ontouchstart(J));e.listenerCount++;y(b)&&(e.dragCount||(e.dragCount=0,a.onmousedown(I)),e.dragCount++)},remove:function(a,b){var e=v(a);e&&(e.listenerCount--,0==e.listenerCount&&(a.removeData("_gestures"),a.offtouchstart(J)),y(b)&&0<e.dragCount&&(e.dragCount--,e.dragCount||a.offmousedown(I)))}},k=0;k<g.length;k++)e(c,g[k],f);var D={add:function(a,b){},remove:function(a,b){}};
c.customEvent=function(a){e(this,a,D)};c.dispatchCustom=function(a,b){var e=!0,c=t(this.dom,a);if(c)for(var d=0;d<c.length;d++){var n=c[d];n.args[0]=b;!1==n.fn.apply(n.ref,n.args)&&(e=!1);n.args[0]=null}return e};var u=function(b,e,c,n){var h=!0;if(t(b.dom,e)){var h=a.math,r=c.start,q=c.current,f=r.center,g=q.center,l=c.delta;l||(l=c.delta={x:0,y:0});l.x=g.x-f.x;l.y=g.y-f.y;if(l.x||l.y)c.moved=!0;var k=c.moved||!1,u=c.press?!!c.press.started:!1,w=h.round(h.distanceBetweenPoints(f.x,f.y,g.x,g.y)),
p=h.round(h.angleBetweenPoints(f.x,f.y,g.x,g.y),100),s;0<w&&(s=d[Math.floor((12*p/Math.PI+24)%24)]);var y=1,z=0;c.touches&&1<c.touches.length&&(0<r.distance&&(y=q.distance/r.distance),z=h.normalizeAngle(q.angle-r.angle));c={type:e,srcEvent:n,target:b.dom,distance:w,angle:p,scale:y,rotation:z,start:f,center:g,delta:l,direction:s,moved:k,press:u};a.logGesture&&a.logGesture(e,b,c);h=b.dispatchCustom(e,c)}return h},E=function(a,b,e){b.press&&(b.press.started=!0,u(a,"press",b,e))},r=function(b,e,c){e.press&&
(e.press.started&&u(b,"pressup",e,c),e.press.timer&&a.util.clearTimeout(e.press.timer),delete e.press)},z=function(b,e,c,d,n,h){if(b=c.kinetic){c.start=n;c.current=h;var r=Date.now()-b.frameTime,r=Math.exp(-r/325),q,f;b.ax&&(q=-b.ax*r,0.5>Math.abs(q)&&(q=0),c.current.center.x=n.center.x+b.tx+q);b.ay&&(f=-b.ay*r,0.5>Math.abs(f)&&(f=0),c.current.center.y=n.center.y+b.ty+f);q||f?(q=c.dragCount?"dragmove":"panmove",u(e,q,c,d),b.anim=a.util.requestAnimationFrame(z,null,e,c,d,n,h)):(q=c.dragCount?"dragend":
"panend",u(e,q,c,d),delete c.kinetic,delete c.start,delete c.current)}},B=function(a,b,e){b.pan&&(u(a,"pancancel",b,e),delete b.pan)},C=function(b){if(b){var e=a.math,c=Date.now();if(1==b.length){var d=b[0];b={x:e.round(d.x),y:e.round(d.y)};return{distance:0,angle:0,center:b,time:c}}if(2<=b.length){for(var d=0,n,h,r=b.length-1,q=0;q<r;q++)for(var f=b[q],g=q+1;g<b.length;g++){var l=b[g],l=e.distanceBetweenPoints(f.x,f.y,l.x,l.y);l>d&&(d=l,n=f,h=b[g])}b=e.centroid(b);b.x=e.round(b.x);b.y=e.round(b.y);
return{distance:e.round(d),angle:e.round(e.angleBetweenPoints(n.x,n.y,h.x,h.y),100),center:b,time:c}}}};c.kinetic=function(a){!0===a?v(this,!0).enableKinetic=!0:!1===a&&(a=v(this))&&delete a.enableKinetic};c.cancelKinetic=function(){var b=v(this);b&&b.kinetic&&(b.kinetic.anim&&a.util.cancelAnimationFrame(b.kinetic.anim),delete b.kinetic)};var J=function(b){var e=v(this);if(e){this.cancelKinetic();for(var c=e.touches,d=b.changedTouches,n=e.dragCount?a.glob.viewNode:this,h=0;h<d.length;h++){var q=n.touchPos(d[h]);
q.ox=q.x;q.oy=q.y;c.push(q)}e.current=C(e.touches);e.start=e.current;1==c.length?(delete e.tap,e.tap={time:e.current.time},r(this,e,b),c=a.util.setTimeout(E,500,null,this,e,b),e.press={timer:c}):1<c.length&&!e.pinch&&(delete e.tap,r(this,e,b),B(this,e,b),delete e.distance,e.pinch||(e.pinch={},u(this,"pinchstart",e,b)));a.user.setTouchCapture(H,M,A,this);a.util.preventDefault(b);return!1}},H=function(b){var e=v(this);if(e){for(var c=e.touches,d=b.changedTouches,n=e.dragCount?a.glob.viewNode:this,h=
0;h<d.length;h++)for(var q=n.touchPos(d[h]),f=0;f<c.length;f++){var l=c[f];if(l.identifier===q.identifier){l.x=q.x;l.y=q.y;l.dx=q.x-l.ox;l.dy=q.y-l.oy;break}}l=e.current;d=C(e.touches);if(d.distance!==l.distance||d.angle!==l.angle||d.center.x!==l.center.x||d.center.y!==l.center.y)if(e.previous=l,e.current=d,1==c.length&&!e.multi){if(l=c[0],c=e.distance=a.math.distanceBetweenPoints(l.dx,l.dy,0,0),l=d.time-e.start.time,10<c&&50<l&&(delete e.tap,e.press&&e.press.started||r(this,e,b),e.pan||(B(this,e,
b),e.pan={time:e.current.time},e.enableKinetic&&!e.press&&(e.kinetic={vx:0,vy:0,frameTime:e.current.time,frameX:0,frameY:0}),u(this,e.dragCount?"dragstart":"panstart",e,b)),e.pan&&(u(this,e.dragCount?"dragmove":"panmove",e,b),c=e.kinetic)))l=e.current.time,d=l-c.frameTime,e=e.delta,n=1E3*(e.y-c.frameY)/(d+1),c.vx=0.8*(1E3*(e.x-c.frameX)/(d+1))+0.2*c.vx,c.vy=0.8*n+0.2*c.vy,c.frameTime=l,c.frameX=e.x,c.frameY=e.y}else 1<c.length&&(e.multi=!0,e.pinch&&(c=a.math,l=e.previous,d=e.current,n=e.start,0<n.distance&&
(h=c.round(l.distance/n.distance,100),c.round(d.distance/n.distance,100)!=h&&u(this,"pinchmove",e,b)),d.angle!=l.angle&&(e.rotate||(e.rotate={start:e.start.angle},u(this,"rotatestart",e,b)),u(this,"rotatemove",e,b))));a.util.preventDefault(b);return!1}},M=function(a){F(this,a,!1)},A=function(a){F(this,a,!0)},F=function(b,e,c){var d=v(b);if(d){var n=d.touches,h=n.length-e.changedTouches.length;if(1==n.length)if(c)delete d.tap,r(b,d,e),B(b,d,e);else{if(d.pan){c=Date.now();var h=c-d.pan.time,q=!1,l=
d.kinetic;l&&(10<Math.abs(l.vx)&&(l.ax=0.8*l.vx,l.tx=Math.round(d.delta.x+l.ax)),10<Math.abs(l.vy)&&(l.ay=0.8*l.vy,l.ty=Math.round(d.delta.y+l.ay)),l.ax||l.ay?(l.frameTime=c,l.anim=a.util.requestAnimationFrame(z,null,b,d,e,d.start,d.current),q=!0):delete d.kinetic);if(!q){var f=d.dragCount?"dragend":"panend";u(b,f,d,e)}if(!d.dragCount&&(!d.press||!d.press.started)&&1E3>h)c=d.touches[0],h=Math.abs(c.dx),q=Math.abs(c.dy),60<=h&&60>q?f=0>c.dx?"swiperight":"swipeleft":60<=q&&60>h&&(f=0>c.dy?"swipeup":
"swipedown"),f&&u(b,f,d,e);delete d.pan}r(b,d,e);d.tap&&(200>d.current.time-d.tap.time&&u(b,"tap",d,e),delete d.tap)}else 1<n.length&&1>=h&&(c?(d.rotate&&(u(b,"rotatecancel",d,e),delete d.rotate),d.pinch&&(u(b,"pinchcancel",d,e),delete d.pinch)):(d.rotate&&(u(b,"rotateend",d,e),delete d.rotate),d.pinch&&(u(b,"pinchend",d,e),delete d.pinch)));b=e.changedTouches;for(f=0;f<b.length;f++){c=b[f];for(h=0;h<n.length;h++)if(n[h].identifier===c.identifier){n.splice(h,1);break}}delete d.distance;0==n.length&&
(delete d.start,delete d.current,delete d.previous,delete d.multi,a.user.releaseTouchCapture());a.util.preventDefault(e);return!1}},K=function(b){b=a.glob.viewNode.mousePos(b);return{distance:0,angle:0,center:{x:b.x,y:b.y}}},I=function(b){if(0==(b.button||0)){var e=K(b),c=v(this,!0);c.start=e;c.current=e;u(this,"dragstart",c,b)&&(a.user.setMouseCapture(L,N,this),a.util.preventDefault(b))}},L=function(b){var e=K(b),c=v(this,!0),d=c.current.center;if(e.center.x!=d.x||e.center.y!=d.y)c.current=e,u(this,
"dragmove",c,b);a.util.preventDefault(b)},N=function(b){var e=v(this,!0);u(this,"dragend",e,b);a.user.releaseMouseCapture();a.util.preventDefault(b)};a.Button=function(b,e,c){a.Element.call(this,"input",c);this.dom.type="button";"string"===typeof b&&(this.dom.value=b);"string"===typeof e&&(this.dom.title=e)};k=a.subclass(a.Button,a.Element);Object.defineProperties(k,{disabled:{get:function(){return this.dom.disabled},set:function(a){this.dom.disabled=a}}});a.TextArea=function(b,e){a.Element.call(this,
"textarea",e);"string"===typeof b&&(this.dom.value=b)};k=a.subclass(a.TextArea,a.Element);Object.defineProperties(k,{value:{get:function(){return this.dom.value},set:function(a){this.dom.value=a}}});k.moveCaret=function(a){var b=this.dom;b.createTextRange?(b=b.createTextRange(),b.move("character",a),b.select()):void 0!==b.selectionStart?(b.focus(),b.setSelectionRange(a,a)):b.focus()};a.Canvas=function(e,c){a.Element.call(this,"canvas");2===arguments.length?(this.dom.width=e,this.dom.height=c):1===
arguments.length&&(this.dom.width=e.clientWidth,this.dom.height=e.clientHeight,b.wrap(e).append(this))};k=a.subclass(a.Canvas,a.Element);Object.defineProperties(k,{width:{get:function(){return this.dom.width}},height:{get:function(){return this.dom.height}}});var P=function(a,b,e,c,d,n){this.globalAlpha=1;void 0!==d&&(this.fillStyle=d);n?(this.strokeStyle=n,this.lineWidth=1,this.lineCap="square",this.beginPath(),this.rect(a,b,e,c),this.fill(),this.stroke(),this.closePath()):(this.lineWidth=0,this.fillRect(a,
b,e,c))},O=function(a,b,e,c,d){void 0!==d&&(this.strokeStyle=d);this.lineWidth=1;this.lineCap="square";this.globalAlpha=1;this.beginPath();this.moveTo(a,b);this.lineTo(e,c);this.stroke();this.closePath()};k.getContext=function(a){a=this.dom.getContext(a);a.oitrect=P;a.oitline=O;return a}});OIT.extend(function(a){a.Plugin=function(a){this.prop("name",a)};a.subclass(a.Plugin)});OIT.extend(function(a){a.PluginList=function(a){this._createFn=a;this._plugins={}};a=a.subclass(a.PluginList);a.item=function(a){return this._plugins[a]};a.extend=function(a,d){if(Array.isArray(d))for(var c=Array.prototype.slice.call(arguments),g=0;g<d.length;g++)c[1]=d[g],this.extend.apply(this,c);else{if("string"===typeof d)return c=this._plugins[d],c||(c=this._createFn.apply(this,arguments))&&(this._plugins[d]=c),c&&c.extend.apply(c,arguments),c;if("object"===typeof d)for(g in c=[a,null,null],
d)c[1]=g,c[2]=d[g],this.extend.apply(this,c)}}});OIT.extend(function(a){a.glob=new a.PluginList(function(b,c,g){return new a.Global(c)});a.glob.reset=function(a){for(var b in this._plugins)this._plugins[b].reset(a)};a.Global=function(b){a.Plugin.call(this,b)};var b=a.subclass(a.Global,a.Plugin);b.extend=function(b,c,g){g=g||{};var f={_v:{value:void 0,writable:!0}};g.init&&(f.init={value:g.init});void 0!==g.def&&("function"===typeof g.def?f.defFn={value:g.def}:f.def={value:g.def});if("opt"===b&&(!0===g.pub&&(f.pub={value:g.pub}),g.legal&&(f.legal=
{value:g.legal}),g.validate&&(f.validate={value:g.validate}),g.type&&(f.type={value:g.type||"boolean"},"number"===g.type||Array.isArray(g.type)&&-1!=g.type.indexOf("number"))))"number"===typeof g.min&&(f.min={value:g.min}),"number"===typeof g.max&&(f.max={value:g.max});Object.defineProperties(this,f);b=a[b];var k=this;b["on"+c]=function(a,b){return k.listen(a,b)};Object.defineProperty(b,c,{enumerable:!0,get:function(){return void 0===k._v&&(k.init&&(k._v=k.init(a)),void 0===k._v)?k.default():k._v},
set:function(a){k.set(a)}})};b.listen=function(a,b){void 0===b&&(b=a,a=void 0);this._listeners||(this._listeners=[]);this._listeners.push({context:a,fn:b})};b.set=function(b,c){if(b!==this._v){if(void 0!==b){var g=!0;if(this.type){var f=null===b?"null":typeof b,g=f===this.type;!g&&Array.isArray(this.type)&&(g=-1!=this.type.indexOf(f));!g&&"string"===f&&(g="color"===this.type,!g&&Array.isArray(this.type)&&(g=-1!=this.type.indexOf("color")),g&&(f="color"));g&&"color"===f?a.css.stringToColor(b)||(this.pub&&
a.document.invalidArg("setOptions",this.name,b,"Must be a CSS color string"),b=this._v):g||("null"===f?b=void 0:(this.pub&&(f=Array.isArray(this.type)?"Must be one of these types: "+JSON.stringify(this.type):"Must be of type "+this.type,a.document.invalidArg("setOptions",this.name,b,f)),b=this._v))}g&&(this.legal&&-1==this.legal.indexOf(b)?(this.pub&&a.document.invalidArg("setOptions",this.name,b,"Must be one of "+JSON.stringify(this.legal)),b=this._v):void 0!==this.min&&b<this.min?(this.pub&&a.document.invalidArg("setOptions",
this.name,b,"Using minimum value of "+this.min,!1),b=this.min):void 0!==this.max&&b>this.max?(this.pub&&a.document.invalidArg("setOptions",this.name,b,"Using maximum value of "+this.max,!1),b=this.max):this.validate&&(b=this.validate(a,this.name,b,this._v)))}if(b!==this._v){g=this._v;if("object"===this.type){this._v={};for(var k in b)b.hasOwnProperty(k)&&(this._v[k]=b[k])}else this._v=b;if(!1!==c&&this._listeners)for(k=0;k<this._listeners.length;k++)f=this._listeners[k],f.fn.call(f.context,this._v,
g,this.name)}}};b.setProperty=function(a,b){if("object"===this.type||Array.isArray(this.type)&&-1!=this.type.indexOf("object")&&(!this._v||this._v[a]!==b))if(this._v||(this._v={}),this._v[a]!==b&&(this._v[a]=b,this._listeners))for(var g=0;g<this._listeners.length;g++){var f=this._listeners[g];f.fn.call(f.context,this._v,null,this.name)}};b.reset=function(a){this.set(void 0,a)};b.default=function(){if(void 0!==this.def)return this.def;if(void 0!==this.defFn)return this.defFn.call(this,a)}});
OIT.extend("glob",{URL:{init:function(a){return document.URL}},baseURL:{def:function(a){return a.opt.outputBaseUrl}},viewNode:{init:function(a){if(a=a.glob.rootNode)return a.childByClass("oit-view")}},rootNode:{init:function(a){if((a=a.doc.byClass("oit-view-root"))&&0<a.length)return a[0]}},deFeatures:{def:{zoom:!1,rotate:!1,pages:!1,fitpage:!1,highlights:!1,textselection:!1,rectselection:!1,cellselection:!1,customtextselection:!1,anchorednotes:!1}},deType:{},drawing:{},libversion:{},documentLoading:{def:!1},
documentLoaded:{def:!1},documentComplete:{def:!1},dynamicContent:{def:!1},enableRawText:{},guid:{},singlePageIndex:{},isMobile:{init:function(a){a=!1;var b=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(b)||
/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,
4)))a=!0;return a}},isMobileOrTablet:{init:function(a){a=!1;var b=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,
4)))a=!0;return a}},editingComment:{def:0}});OIT.extend(function(a){a.opt=new a.PluginList(function(b,d,c){return new a.Global(d)});a.opt.isPublic=function(a){return(a=this.item(a))&&a.pub};a.opt.reset=function(b){a.util.eachSparse(this._plugins,"reset",null,b)}});
OIT.extend("opt",{disableAnimation:{pub:!0,type:"boolean",init:function(a){return a.glob.isMobileOrTablet}},memoryModel:{pub:!0,type:"string",legal:["large","small","micro","none"],init:function(a){return a.glob.isMobileOrTablet?"small":"large"}},detectBaseUrl:{pub:!0,type:"boolean",def:!0},outputBaseUrl:{pub:!0,type:"string",def:""},centerPages:{pub:!0,type:"boolean",def:!0},redactionColor:{pub:!0,type:"color",def:"#000"},redactionFillColor:{pub:!0,type:"color",def:null},showHighlightLabels:{pub:!0,
type:"boolean",def:!0},highlightLabelFontFamily:{pub:!0,type:"string",def:null},highlightLabelFontSize:{pub:!0,type:"string",def:null},highlightActivationBoxColor:{pub:!0,type:["color","null"],def:null},redactionMode:{pub:!0,type:"string",legal:["simple","compound","hybrid"],def:"hybrid"},contentTimeout:{pub:!0,type:"number",min:1,def:2E4},doubleClickInterval:{pub:!0,type:"number",def:500,min:1,max:1E4},removeExtraEmailHeaders:{pub:!0,type:"boolean",def:!1},emailHeaderStyle:{pub:!0,type:"object",
def:null},zoom:{type:"number",def:1,min:0.1,max:40},zoomMode:{type:["string","null"],legal:[null,"page","pagewidth","pageheight","mobile"],init:function(a){return a.glob.isMobileOrTablet?"mobile":null}},rotation:{type:"number",legal:[0,90,180,270],def:0},selectionMode:{type:"string",legal:["text","rect","cell","none"],def:"text",validate:function(a,b,d,c){return a.selection.validateMode(d,c)}},nochrome:{pub:!0,type:"boolean",def:!1,init:function(a){return a.glob.isMobileOrTablet?!0:!1}},scrollMode:{pub:!0,
type:"string",legal:["single","vertical","hswipe","vswipe"],def:"vertical",init:function(a){return a.glob.isMobileOrTablet?"hswipe":"vertical"}},showSlideNotes:{pub:!0,type:"boolean",def:!1},presentationMode:{pub:!0,type:"string",legal:["normal","slideshow"],def:"normal"}});OIT.extend(function(a){a.Event=function(b,c,d){a.Plugin.call(this,d);Object.defineProperties(this,{host:{value:b},dispatcher:{value:c}})};var b=a.subclass(a.Event,a.Plugin),d=function(a,b,c){if(a=a._int)for(var d=0;d<a.length;d++){var h=a[d];if(h.fn===b&&(void 0===c||h.context===c))return d}return-1},c=function(a,b){var c=a._pub;return c?c.indexOf(b):-1},g=function(b,c,h,f){void 0===h&&(h=c,c=void 0);if(-1===d(b,h,c)){var g=!b.hasListeners(),t={context:c,fn:h};!0===f&&(t.listenOnce=!0);b._int||b.prop("_int",
[],!0);b._int.push(t);g&&b.isSystemEvent()&&b.dispatcher.addElementListeners(b.name);b.onListen&&b.onListen.call(a,b,h,c)}},f=function(b,c){-1!=c&&(b.dispatching?(b._xint||(b._xint=[]),b._xint.push(c)):(b._int.splice(c,1),!b.hasListeners()&&b.isSystemEvent()&&b.dispatcher.removeElementListeners(b.name),b.onUnlisten&&b.onUnlisten.call(a,b)))},k=function(b,c){-1!=c&&(b.dispatching?(b._xpub||(b._xpub=[]),b._xpub.push(c)):(b._pub.splice(c,1),!b.hasListeners()&&b.isSystemEvent()&&b.dispatcher.removeElementListeners(b.name),
b.onRemove&&b.onRemove.call(a,b)))},m=function(){var b;this.detail&&(b=this.detail.apply(a,arguments));var c=this.systemEventName||this.name,d=document.createEvent("CustomEvent");d.initCustomEvent(c,!0,!0,b);return d},h=function(){var a=!0;this.dispatching=!0;var b=this._int;if(b)for(var c=b.length,d=0;d<c;d++){var h=b[d];!1===h.fn.apply(h.context,arguments)&&(a=!1);h.listenOnce&&f(this,d)}b=this._pub;if(a&&b){a=m.apply(this,arguments);c=b.length;for(d=0;d<c;d++)b[d].call(void 0,a);a=!a.defaultPrevented}a&&
this._def&&(a=this._def.fn.apply(this._def.context,arguments));this.dispatching=!1;if(this._xint){for(d=this._xint.length-1;0<=d;d--)f(this,this._xint[d]);delete this._xint}if(this._xpub){for(d=this._xpub.length-1;0<=d;d--)k(this,this._xpub[d]);delete this._xpub}return a};b.extend=function(a,b,c){c&&(!0===c.pub&&(this.prop("pub",!0),c.detail&&this.prop("detail",c.detail)),!0===c.systemEvent&&this.prop("systemEventName","_"+b),0<c.delay&&this.prop("delay",c.delay),this.prop("onListen",c.onListen),
this.prop("onUnlisten",c.onUnlisten),this.prop("onAdd",c.onAdd),this.prop("onRemove",c.onRemove),Object.defineProperty(this.dispatcher,b,{enumerable:!0,value:this}))};b.enable=function(){this.disabled=!1};b.disable=function(){this.disabled=!0};b.hasListeners=function(){return!!this._def||this._int&&0<this._int.length||this._pub&&0<this._pub.length};b.isSystemEvent=function(){return!!this.systemEventName};b.setDefaultListener=function(b,c){if(b){this._def&&this.setDefaultListener(null);var d=!this.hasListeners();
this._def={context:c,fn:b};d&&this.isSystemEvent()&&this.dispatcher.addElementListeners(this.name);this.onListen&&this.onListen.call(a,this,b,c)}else this._def&&(delete this._def,!this.hasListeners()&&this.isSystemEvent()&&this.dispatcher.removeElementListeners(this.name),this.onUnlisten&&this.onUnlisten.call(a,this))};b.listen=function(a,b){g(this,a,b,!1)};b.listenOnce=function(a,b){g(this,a,b,!0)};b.unlisten=function(a){f(this,d(this,a))};b.addPublicListener=function(b){if(this.pub&&"function"===
typeof b&&-1===c(this,b)){var d=!this.hasListeners();this._pub||this.prop("_pub",[],!0);this._pub.push(b);d&&this.isSystemEvent()&&this.dispatcher.addElementListeners(this.name);this.onAdd&&this.onAdd.call(a,this,b)}};b.removePublicListener=function(a){k(this,c(this,a))};b.dispatch=function(){this.logDispatch&&this.logDispatch.apply(this,arguments);if(this.hasListeners()&&!this.disabled){if(!this.delay)return h.apply(this,arguments);this._dispatchTimer&&a.util.clearTimeout(this._dispatchTimer);this._ddArgs=
arguments;this._dispatchTimer=a.util.setTimeout(p,this.delay,this)}return!0};var p=function(){h.apply(this,this._ddArgs);delete this._ddArgs};b.dispatchTo=function(a,b){var c=m.apply(this,b);a.call(void 0,c);return!c.defaultPrevented};b.reset=function(){this._int&&(this._int=[]);this._pub&&(this._pub=[]);delete this._def}});OIT.extend(function(a){var b=a.doc,d=function(b,c,d){return new a.Event(this._host,this,c)};a.EventDispatcher=function(c,g){a.PluginList.call(this,d);this.name=g;this._host=c;this._eventElements=[];var m=this;this.onSystemEvent=function(c){var d=m[c.type];if(d&&d.hasListeners()&&!d.disabled){var f;a:{f=c.currentTarget;for(f=b.unwrap(f);f;){var n=b.data(f,"dispatcherData");if(n){f=n;break a}f=f.parentNode}f=void 0}if(f)return f[1]=c,(d=d.dispatch.apply(d,f))||a.util.preventDefault(c),f[1]=null,d}return!0};
this.onTap=function(a){var b,c=a.srcEvent;b=a.center;a=b.x;var d=b.y,f=b.x,g=b.y;document.createEvent?(b=document.createEvent("MouseEvent"),b.initMouseEvent("click",!0,!0,window,null,a,d,f,g,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,0,c.currentTarget)):b=new MouseEvent("click",{screenX:a,screenY:d,clientX:f,clientY:g,ctrlKey:c.ctrlKey,shiftKey:c.shiftKey,altKey:c.altKey,metaKey:c.metaKey,button:0,buttons:c.buttons,relatedTarget:c.currentTarget,region:c.region});c.currentTarget.dispatchEvent(b)}};var c=
a.subclass(a.EventDispatcher,a.PluginList);c.enable=function(){this.disabled=!1};c.disable=function(){this.disabled=!0};c.addElementListeners=function(a){if(this[a])for(var c=0;c<this._eventElements.length;c++){var d=this._eventElements[c];d.addEventListener(a,this.onSystemEvent,!1);if("click"===a)b.wrap(d).ontap(this,this.onTap)}};c.removeElementListeners=function(a){if(this[a])for(var b=0;b<this._eventElements.length;b++)this._eventElements[b].removeEventListener(a,this.onSystemEvent)};c.addElement=
function(a){if((a=b.unwrap(a))&&a.addEventListener&&-1==this._eventElements.indexOf(a)){this._eventElements.push(a);for(var c=[b.wrap(a),null],d=1;d<arguments.length;d++)c.push(arguments[d]);b.data(a,"dispatcherData",c);for(var h in this._plugins)if(c=this[h],c.isSystemEvent()&&c.hasListeners()&&(a.addEventListener(h,this.onSystemEvent,!1),"click"===h))b.wrap(a).ontap(this,this.onTap)}};c.removeElement=function(a){a=b.unwrap(a);var c=this._eventElements.indexOf(a);if(-1!=c){this._eventElements.splice(c,
1);b.removeData(a,"dispatcherData");for(var d in this._plugins)c=this[d],c.isSystemEvent()&&c.hasListeners()&&a.removeEventListener(d,this.onSystemEvent)}};c.eventMessage=function(){if(!this._eventMessage){for(var a in this._plugins)this._eventMessage=this._eventMessage?this._eventMessage+","+a:"Must be one of ["+a;this._eventMessage&&(this._eventMessage+="]")}return this._eventMessage};var g=function(b,c){var d=a[b];if(d&&(d=d.on))return d[c]};a.on=function(a,b,c,d){(a=g(a,b))&&a.listen(c,d)};a.off=
function(a,b,c){(a=g(a,b))&&a.unlisten(c)};a.dispatch=function(a,b){var c=g(a,b);return c?2<arguments.length?c.dispatch.apply(c,Array.prototype.slice.call(arguments,2)):c.dispatch.apply(c):!0};a.enableEvent=function(a,b){var c=g(a,b);c&&c.enable()};a.disableEvent=function(a,b){var c=g(a,b);c&&c.disable()};a.globalEvents=new a.EventDispatcher(a,"globalEvents")});OIT.extend("globalEvents",{install:{},init:{}});OIT.extend(function(a){var b="mousedown mouseup click dblclick contextmenu mousemove mouseover mouseout touchstart touchend touchmove touchcancel".split(" ");a.mod=new a.PluginList(function(b,d,f){b=new a.Module(d);return a[d]=b});a.Module=function(b){a.Plugin.call(this,b)};var d=a.subclass(a.Module,a.Plugin);d.extend=function(c,d,f){this.def=f;a.globalEvents.install.listen(this,this.install);c=f.events;f=f.userEventDef;if(c||f){this.on||(this.on=new a.EventDispatcher(this,this.name));if(c)for(var k in c)d=
c[k],this.on.extend.call(this.on,"on",k,d),d&&d.pub&&(this.hasPublicEvents=!0);if(f){f.systemEvent=!0;for(k=0;k<b.length;k++)this.on.extend.call(this.on,"on",b[k],f);f.pub&&(this.hasPublicEvents=!0)}}};d.install=function(a){var b=this,d=this.def;delete this.def;d.install&&d.install(a,this);if(b.hasPublicEvents||d.exports&&0<d.exports.length){OIT[b.name]||(a.export(b.name,{}),b.publicName="OIT."+b.name);a={};b.hasPublicEvents&&(b.addEventListener||(a.addEventListener={value:function(a,c){var d=b.on[a];
d?d.addPublicListener(c):b.invalidArg("addEventListener","name",a,b.on.eventMessage())}}),b.removeEventListener||(a.removeEventListener={value:function(a,c){var d=b.on[a];d?d.removePublicListener(c):b.invalidArg("removeEventListener","name",a,b.on.eventMessage())}}));if(d.exports&&0<d.exports.length)for(var k=0;k<d.exports.length;k++){var m=d.exports[k],h=b[m];void 0!==h&&(a||(a={}),a[m]={value:h})}Object.defineProperties(OIT[b.name],a)}}});OIT.extend(function(a){a.de=new a.PluginList(function(b,c,g){return new a.DisplayEngine(c)});a.DisplayEngine=function(b){a.Plugin.call(this,b)};var b=a.subclass(a.DisplayEngine,a.Plugin);b.extend=function(b,c,g){this.def=g;a.globalEvents.install.listen(this,this.install)};b.install=function(a){var b=this.def;delete this.def;b.install&&b.install(a,this)};b.init=function(a){if(a.isPending()){var b=this;a.load(!0,!0,function(){b.load(a)})}else this.load(a)};b.load=function(a){};b.unload=function(){};
b.topPageIndex=function(){return a.pages.current()};b.bottomPageIndex=function(){return a.pages.current()};b.maxPageWidth=function(){return a.pages.maxWidth()};b.maxPageHeight=function(){return a.pages.maxHeight()};b.padding=function(){return{left:0,top:0,right:0,bottom:0}};b.margin=function(){return{left:0,top:0,right:0,bottom:0}};b.scrollOffset=function(){return a.glob.viewNode.scroll()};b.getSelectedText=function(){return a.doc.selectedText()};b.select=function(a){return!1};b.keydown=function(a){return!0};
b.showHidden=function(a){};b.moveto=function(a,b,g){return!1};b.pageRange=function(a,b){};b.pageRect=function(b,c,g){return a.pages.elementRect(a.pages.page(b),c)};b.rangeRect=function(a,b,g,f){};b.rangeFromRect=function(a,b,g,f,k,m,h){};b.extendRange=function(a,b,g,f){};b.moveAnchor=function(a,b,g,f){return!1};b.incrementSelection=function(a,b,g,f,k){return!1};b.layoutChanged=function(a){};b.update=function(a){}});OIT.extend(function(a){var b="zoom rotate showhidden pages fitpage highlights textselection rectselection cellselection customtextselection anchorednotes".split(" "),d=a.fmt=new a.PluginList(function(b,d,f){return new a.FormatType(d)});d.createDisplay=function(b){if(b=d.item(b))return a.de.item(b.de)};d.features=function(a){if(a=d.item(a))return a.features};a.FormatType=function(b){a.Plugin.call(this,b)};a.subclass(a.FormatType,a.Plugin).extend=function(a,d,f){this.de=f.de;a=this.features={};for(d=
0;d<b.length;d++){var k=b[d],m=f[k];void 0===m&&(m=!0);a[k]=m}}});OIT.extend("mod","css",{install:function(a,b){var d=a.math,c=function(a){return"string"===typeof a},g={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",
darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",
gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",
lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",
navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",
silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},f=1/6,k=1/3,m=2/3,h=function(a,b,e){0>e?e+=1:1<e&&(e-=1);e<f?a+=6*(b-a)*e:0.5>e?a=b:e<m&&(a+=6*(b-a)*(m-e));return 255*a|0},p=[{property:"webkit",css:"-webkit-"},{property:"Moz",
css:"-moz-"},{property:"ms",css:"-ms-"},{property:"O",css:"-o-"}],l=function(a,b,e){var d=document.documentElement;if(c(d.style[a]))return b;if(!1!==e){a=a.charAt(0).toUpperCase()+a.slice(1);for(e=0;e<p.length;e++)if(c(d.style[p[e].property+a]))return p[e].css+b}},n=function(a,b){for(var e,c=document.createElement("div"),d=0;d<b.length;d++)if(c.style[a]=b[d],c.style[a]===b[d]){e=b[d];break}return e};b.nameMap={transform:l("transform","transform"),"transform-origin":l("transformOrigin","transform-origin")};
b.cursor={grab:n("cursor",["grab","-webkit-grab","-moz-grab","move"]),grabbing:n("cursor",["grabbing","-webkit-grabbing","-moz-grabbing","move"])};var x=function(a,b){if(-1!=b)for(var e=a.chars;b<e.length;b++){var c=e[b];if(" "!==c&&"\n"!==c&&"\r"!==c&&"\t"!==c){"/"===c&&"*"===e[b+1]&&(e=a.string.indexOf("*/",b+2),b=-1==e?a.string.length:e+2);break}}return b},s=function(a,b,e){return-1!=b&&a.chars[b]!==e?-1:++b};b.parse=function(a){var b;if(a){b={};a={string:a,chars:a.split("")};for(var e=0;-1!=e&&
e<a.chars.length;){var c=a,d=e,e=b,h={},d=x(c,d);if(-1!=d){for(var n=c.chars,f=void 0,f=d;f<n.length;f++){var g=n[f];if(!("a"<=g&&"z">=g)&&!("A"<=g&&"Z">=g)&&!("0"<=g&&"9">=g)&&"-"!==g&&"_"!==g)break}f>d?(h.name=c.string.substring(d,f),d=f):d=-1}d=x(c,d);d=s(c,d,":");d=x(c,d);if(-1!=d){n=c.chars;f=void 0;for(f=d;f<n.length;f++){g=n[f];if("!"===g||";"===g)break;if('"'===g||"'"===g||"("===g){"("===g&&(g=")");for(var r=f+1;r<n.length;r++){var k=n[r];if(k===g){f=r;break}else if("\\"===k){k=n[++r];if("0"<=
k&&"9">=k||"a"<=k&&"f">=k||"A"<=k&&"F">=k){do k=n[++r];while("0"<=k&&"9">=k||"a"<=k&&"f">=k||"A"<=k&&"F">=k)}f=r;break}}}}f>d?(h.value=c.string.substring(d,f),d=f):d=-1}d=x(c,d);n=h;-1!=d&&"!important"===c.string.substring(d,d+10)&&(n.important=!0,d+=10);d=x(c,d);d<c.chars.length&&(d=s(c,d,";"));-1!=d&&(e[h.name]=h.value);e=d}}return b};b.compose=function(a){var b=[];if(a)for(var e in a)a.hasOwnProperty(e)&&b.push(e,":",a[e],";");return b.join("")};b.get=function(a,b){if(a&&c(a)&&c(b)){for(var e=
0;;){e=a.indexOf(b,e);if(-1==e||0==e)break;var d=a.charAt(e-1);if(";"==d||" "==d)break;e++}if(-1!=e){for(e+=b.length;" "===a.charAt(e);)e++;if(":"===a.charAt(e)){for(e++;" "===a.charAt(e);)e++;d=a.indexOf(";",e);-1===d&&(d=a.length);for(;d>e&&" "===a.charAt(d-1);)d--;return a.substring(e,d)}}}};b.colorToString=function(){var a=arguments;if(1==a.length){var h=a[0];if(c(h))h=b.stringToColor(h);else if(!h.r||!h.g||!h.b)h=void 0;if(h)return b.colorToString(h.r,h.g,h.b,h.a)}else if(3==a.length||4==a.length){var h=
d.round(d.clamp(a[0],0,255)),e=d.round(d.clamp(a[1],0,255)),n=d.round(d.clamp(a[2],0,255));if(4==a.length&&void 0!==a[3])return a=d.clamp(a[3],0,1),"rgba("+h+","+e+","+n+","+a+")";h=h.toString(16);e=e.toString(16);n=n.toString(16);2>h.length&&(h="0"+h);2>e.length&&(e="0"+e);2>n.length&&(n="0"+n);return"#"+h+e+n}};b.stringToColor=function(a){if(a){var c;if(0==a.indexOf("#")){if(c={r:parseInt(a.substring(1,3),16),g:parseInt(a.substring(3,5),16),b:parseInt(a.substring(5,7),16),a:1},isNaN(c.b)){var e=
a.substring(1,2),n=a.substring(2,3);a=a.substring(3,4);n+=n;a+=a;c.r=parseInt(e+e,16);c.g=parseInt(n,16);c.b=parseInt(a,16)}}else if(0==a.indexOf("rgba(")||0==a.indexOf("rgb(")){n=a.replace(/[^\d.,]/g,"").split(",");for(e=0;e<n.length;e++)n[e]=Number(n[e]);for(;3>n.length;)n.push(0);for(;4>n.length;)n.push(1);c={r:n[0],g:n[1],b:n[2],a:n[3]}}else if(0==a.indexOf("hsla(")||0==a.indexOf("hsl(")){c=a.replace(/[^\d.,]/g,"").split(",");for(e=0;e<c.length;e++)c[e]=Number(c[e]);for(;3>c.length;)c.push(0);
for(;4>c.length;)c.push(1);e=c[0];n=c[1];a=c[2];e/=360;n/=100;a/=100;if(0==n)n=a=e=255*a|0;else{var f=0.5>a?a*(1+n):a+n-a*n,l=2*a-f,n=h(l,f,e+k);a=h(l,f,e);e=h(l,f,e-k)}c={r:n,g:a,b:e,a:c[3]}}else if(e=g[a.toLowerCase()])return b.stringToColor(e);if(c)return c.r=d.clamp(c.r,0,255),c.g=d.clamp(c.g,0,255),c.b=d.clamp(c.b,0,255),c.a=d.clamp(c.a,0,1),c}};b.rgbStringFromString=function(a){if(0==a.indexOf("#"))return a;if(0==a.indexOf("rgba(")||0==a.indexOf("rgb("))if(a=b.stringToColor(a))return b.colorToString(a.r,
a.g,a.b)};b.opacityFromString=function(a){return 0==a.indexOf("rgba")&&(a=b.stringToColor(a))?a.a:1};b.blendColors=function(a,c){var e=b.stringToColor(a),d=b.stringToColor(c);if(!e||!d)return a;d.a=1-e.a;return b.colorToString(e.r*e.a+d.r*d.a,e.g*e.a+d.g*d.a,e.b*e.a+d.b*d.a)};b.validateLength=function(a){if(void 0!==a&&null!==a&&""!=a){var b=Number(a);if(isNaN(b)){if(a.match(/(\d|\.)+(em|ex|px|in|pt|pc|mm|cm|\%)/))return a}else return b+"px"}else return null}}});OIT.extend(function(a){OIT.local||a.export("local",{CANCEL:"Cancel",DISCARD_CHANGES:"Discard changes",DOCUMENT_ERROR:"Error occurred, document incomplete.",EMAIL_ATTACHMENTS:"Attachments",EMAIL_CALENDAREXCEPTIONS:"Calendar Exceptions",EMAIL_CC:"CC",EMAIL_BCC:"BCC",EMAIL_FROM:"From",EMAIL_TO:"To",EMAIL_DATE:"Sent",EMAIL_TOPIC:"Topic",EMAIL_PRIORITY:"Priority",EMAIL_IMPORTANCE:"Importance",EMAIL_OWNER:"Owner",EMAIL_STATUS:"Status",EMAIL_PERCENT:"Percent Complete",EMAIL_STARTDATE:"Start Date",EMAIL_ENDDATE:"End Date",
EMAIL_DUEDATE:"Due Date",EMAIL_CREATED:"Created",EMAIL_CATEGORY:"Categories",EMAIL_NAME:"Name",EMAIL_FULLNAME:"Full Name",EMAIL_FIRST:"First",EMAIL_LAST:"Last",EMAIL_MIDDLE:"Middle",EMAIL_SUFFIX:"Suffix",EMAIL_TITLE:"Title",EMAIL_FILEAS:"File as",EMAIL_DISPLAYAS:"Display as",EMAIL_COMPANY:"Company",EMAIL_JOBTITLE:"Job Title",EMAIL_BPHONE:"Business Phone",EMAIL_BADDRESS:"Business Address",EMAIL_FAX:"Business Fax",EMAIL_EMAIL:"Email Address",EMAIL_HPHONE:"Home Phone",EMAIL_HADDRESS:"Home Address",EMAIL_MOBILE:"Mobile",
EMAIL_IM:"IM",EMAIL_WEBPAGE:"Webpage",EMAIL_ENTRYTYPE:"Entry Type",EMAIL_STARTTIME:"Start Time",EMAIL_ENDTIME:"End Time",EMAIL_DURATION:"Duration",EMAIL_REQATTEND:"Required Attendees",EMAIL_OPTATTEND:"Optional Attendees",EMAIL_LOCATION:"Location",EMAIL_RECEIVED:"Received",EMAIL_RECURTYPE:"Recurrence Type",EMAIL_RECURRANGE:"Recurrence Range",EMAIL_SUBJECT:"Subject",LABEL_SEPARATOR:":",NO:"No",OK:"OK",PAGE_DOWN:"Next Page",PAGE_UP:"Previous Page",PLEASE_WAIT:"Please wait",PLEASE_WAIT_CONVERTING:"Document conversion in progress...",
PLEASE_WAIT_DOWNLOADING:"Loading document, please wait",PLEASE_WAIT_INITIALIZING:"Please wait while your<br>document is loaded...",PREPARING_TO_PRINT:"Preparing to print...",SAVE_CHANGES:"Save changes",SHOWDETAILS:"Show Details",HIDEDETAILS:"Hide Details",YES:"Yes"})});OIT.extend("mod","ajax",{install:function(a,b){var d=a.util,c=[],g=Date.now(),f=function(a,b){var c=a[b];if(c){var d=Array.prototype.slice.call(arguments,2);a.args&&(d=d.concat(a.args));c.apply(a.context,d)}},k=function(a){var b="unknown"!=typeof a.request.responseText?a.request.responseText:void 0,c=a.request.status;void 0===a.contentLength&&(a.contentLength=b.length);200===c?f(a,"success",a.url,a.contentLength,b):f(a,"error",a.url,c);f(a,"complete",a.url,a.contentLength,b,c)};b.start=function(a){var b=
a.url;if(window.XMLHttpRequest&&b){var l={request:new XMLHttpRequest,context:null},n;for(n in a)l[n]=a[n];!1===a.cache&&(b=-1!=b.indexOf("?")?b+"&":b+"?",b+="_="+ ++g);if(a=!1===a.async?!1:!0)l.request.onreadystatechange=function(){if(!l.aborted)switch(l.request.readyState){case 2:l.contentLength=Number(l.request.getResponseHeader("Content-Length"));f(l,"loading",l.url,l.contentLength,"");break;case 3:f(l,"loading",l.url,l.contentLength,"unknown"!=typeof l.request.responseText?l.request.responseText:
void 0);break;case 4:k(l),d.remove(c,l)}};l.request.open("GET",b,a);l.request.send();if(a)return c.push(l),l;k(l)}};var m=function(a){a.aborted=!0;a.request&&a.request.abort()};b.abort=function(a){a?(d.remove(c,a),m(a)):(d.each(c,m),c=[])}}});OIT.extend("mod","math",{install:function(a,b){b.round=function(a,b){return b&&1<b?Math.round(a*b)/b:Math.floor(0>a?a-0.5:a+0.5)};b.clamp=function(a,b,g){a<b?a=b:a>g&&(a=g);return a};b.distanceBetweenPoints=function(a,c,g,f){if(a==g&&c==f)return 0;a=g-a;c=f-c;return b.round(Math.sqrt(a*a+c*c))};b.angleBetweenPoints=function(a,b,g,f){return a==g&&b==f?0:Math.atan2(b-f,g-a)};b.normalizeAngle=function(a,b){if("deg"===b)a%=360,0>a&&(a+=360);else{var g=Math.PI,f=2*g;a%=f;a<-g?a+=f:a>g&&(a-=f)}return a};
b.centroid=function(a){if(a){if(1==a.length){var b=a[0];return{x:b.x,y:b.y}}if(2==a.length){var b=a[0],g=a[1];return{x:(b.x+g.x)/2,y:(b.y+g.y)/2}}if(2<a.length){for(var b={x:0,y:0},f=0,k=a.length-1,m=0;m<a.length;m++){var g=a[m],h=m<k?a[m+1]:a[0],p=g.x,g=g.y,l=h.x,h=h.y,n=p*h-l*g,f=f+n;b.x+=(p+l)*n;b.y+=(g+h)*n}f*=3;b.x/=f;b.y/=f;return b}}};b.rotatePoints=function(a,b,g){var f=Math.cos(g);g=Math.sin(g);for(var k=0;k<a.length;k++){var m=a[k].x-b.x,h=a[k].y-b.y;a[k].x=b.x+m*f+h*g;a[k].y=b.y+-m*g+h*
f}};b.radians=function(a){return a*Math.PI/180};b.degrees=function(a){return 180*a/Math.PI};b.approxEqual=function(a,b,g){void 0===g&&(g=1.01);return(a>b?Math.abs(a/b):Math.abs(b/a))<=g}}});OIT.extend("mod","util",{events:{fontload:{}},install:function(a,b){for(var d=a.glob,c=a.doc,g="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),f=["serif","sans-serif","monospace","cursive","fantasy"],k={},m=0,h,p=[],l=[],n=[],x=window.requestAnimationFrame,s=window.cancelAnimationFrame,w=0,t=["ms","moz","webkit","o"],e=0;e<t.length&&!x;++e)x=window[t[e]+"RequestAnimationFrame"],s=window[t[e]+"CancelAnimationFrame"]||window[t[e]+"CancelRequestAnimationFrame"];x||(x=function(a,b){var e=(new Date).getTime(),
c=Math.max(0,16-(e-w)),d=window.setTimeout(function(){a(e+c)},c);w=e+c;return d});s||(s=function(a){clearTimeout(a)});b.abortTimers=function(){for(var a=0;a<p.length;a++)window.clearInterval(p[a].id);p=[];for(a=0;a<l.length;a++)window.clearTimeout(l[a].id);l=[];for(a=0;a<n.length;a++)s.call(window,n[a].id);n=[]};var q=function(a,b,e,c){var d=0;c={fn:a[d++],remove:!!c};b&&(c.timeout=a[d++]);c.context=a[d++];e&&(c.args=[0],c.ts=!0);a.length>d&&(a=Array.prototype.slice.call(a,d),c.args=c.args?c.args.concat(a):
a);return c},y=function(e,c,d){try{e.remove&&b.remove(c,e),e.ts&&(e.args[0]=d),e.fn.apply(e.context,e.args)}catch(n){a.logDebugError&&a.logDebugError("Error in asynchronous timer function: "+n.message)}};b.setInterval=function(a,b,e){var c=q(arguments,!0,!1,!1);p.push(c);c.id=window.setInterval(function(){y(c,p)},c.timeout);return c.id};b.clearInterval=function(a){window.clearInterval(a);b.removeByProperty(p,"id",a)};b.setTimeout=function(a,b,e){var c=q(arguments,!0,!1,!0);l.push(c);c.id=window.setTimeout(function(){y(c,
l)},b);return c.id};b.clearTimeout=function(a){window.clearTimeout(a);b.removeByProperty(l,"id",a)};b.requestAnimationFrame=function(a,b){for(var e=0;e<n.length;e++){var c=n[e];if(c.fn===a&&c.context===b)return c.id}c=q(arguments,!1,!0,!0);n.push(c);c.id=x.call(window,function(a){y(c,n,a)});return c.id};b.cancelAnimationFrame=function(a){s.call(window,a);b.removeByProperty(n,"id",a)};b.getTextRoot=function(a){for(;a&&!c.isElement(a);)a=a.parentNode;var b;a&&(b=c.wrap(a).ancestorByClass(["oit-textfield",
"oit-email"]));return b?b:null};b.preventDefault=function(a){a.stopPropagation();a.preventDefault()};b.defaultSSColHeader=function(a){if(!("number"!=typeof a||0>a)){if(26>a)return g[a];var b=a%26,e=(a-b)/26-1;if(702>a)return g[e]+g[b];a=Math.floor(e);e=a%26;return g[(a-e)/26-1]+g[e]+g[b]}};b.isFunction=function(a){return"[object Function]"==Object.prototype.toString.call(a)?a:null};b.isDOMRange=function(a){return a&&void 0!==a.startContainer&&void 0!==a.startOffset&&void 0!==a.endContainer&&void 0!==
a.endOffset?!0:!1};b.isDOMSelection=function(a){return a&&void 0!==a.anchorNode&&void 0!==a.anchorOffset&&void 0!==a.focusNode&&void 0!==a.focusOffset?!0:!1};b.isRelativeURL=function(a){return!/^(?:[a-z]+:)?\/\//i.test(a)};b.concatURL=function(a,b){return a&&0!=a.length?!b||0==b.length?a:"/"==a.charAt(a.length-1)?"/"==b.charAt(0)?a+b.substr(1):a+b:"/"==b.charAt(0)?a+b:a+"/"+b:b};b.clone=function(a){var e;if(Array.isArray(a)){e=[];for(var c=0;c<a.length;c++)e[c]=b.clone(a[c])}else{if(b.isFunction(a))return null;
if(null==a)e=null;else switch(typeof a){case "object":e={};for(c in a)a.hasOwnProperty(c)&&!b.isFunction(a[c])&&(e[c]=b.clone(a[c]));break;case "string":e=new String(a);break;case "number":case "boolean":case "undefined":e=a}}return e};b.each=function(a,b,e){v(!1,!1,null,arguments)};b.eachArgs=function(a,b){v(!1,!1,a,b)};b.eachReverse=function(a,b,e){v(!1,!0,null,arguments)};b.eachSparse=function(a,b,e){v(!0,!1,null,arguments)};b.eachSparseArgs=function(a,b){v(!0,!1,a,b)};var v=function(a,b,e,c){var d=
0;e||(e=c[d++]);if(e&&(a||0<e.length)){var n=c[d++],h=c[d++],f="string"==typeof n;f||d--;c=c.length>d?Array.prototype.slice.call(c,d):void 0;f?d=u:(d=D,c||(c=[null]));if(a)for(var g in e)e.hasOwnProperty(g)&&d(e[g],n,h,c);else if(b?(g=e.length-1,b=a=-1):(g=0,a=e.length,b=1),e.item)for(;g!=a;g+=b)d(e.item(g),n,h,c);else for(;g!=a;g+=b)d(e[g],n,h,c)}},D=function(a,b,e,c){if(null!==a&&void 0!==a&&(null===e||void 0===e||a.filter(e)))c[0]=a,b.apply(null,c)},u=function(a,b,e,c){a&&(null===e||void 0===e||
a.filter(e))&&a[b].apply(a,c)};b.arraysEqual=function(a,b){if(a===b)return!0;if(null===a||void 0===a)return null===b||void 0===b;if(null===b||void 0===b||("[object Array]"!==Object.prototype.toString.call(a)||"[object Array]"!==Object.prototype.toString.call(b))||a.length!=b.length)return!1;for(var e=0;e<a.length;e++)if(a[e]!==b[e])return!1;return!0};b.remove=function(a,b){var e=a.indexOf(b);-1!=e&&a.splice(e,1)};b.removeByProperty=function(a,e,c){e=b.byPropertyIdx(a,e,c);-1!=e&&a.splice(e,1)};b.byProperty=
function(a,e,c){e=b.byPropertyIdx(a,e,c);if(-1!=e)return a[e]};b.byPropertyIdx=function(a,b,e){if(Array.isArray(a)&&"string"===typeof b)for(var c=0;c<a.length;c++){var d=a[c];if(d&&d[b]===e)return c}return-1};b.stringify=function(a){return b.isDOMRange(a)?"[DOM Range]":b.isDOMSelection(a)?"[DOM Selection]":JSON.stringify(a)};b.loadWebFont=function(a){var e=k[a];if(void 0===e){var n=d.rootNode;if(n){e=c.create("div","oit-fontpreloader");e.css("font-family",a);var f=c.create("span");e.append(f);f.html("AEIMNOTaeimnot130");
n.append(e);k[a]=e}m=0;h||(h=b.setTimeout(E,250))}};var E=function(){var a=!1,e=!1,c;for(c in k){var d=k[c];if(d&&!0!==d){for(var n=!0,g,q=0;q<f.length;q++){d.css("font-family",c+","+f[q]);var u=d.offsetWidth;if(0<q&&u!=g){n=!1;break}g=u}n?(d.destroy(),e=k[c]=!0):(d.css("font-family",c),a=!0)}}if(a)if(m++,20>m)h=b.setTimeout(E,250);else for(c in k)if((d=k[c])&&!0!==d)d.destroy(),k[c]=!1;e&&b.on.fontload.dispatch()};a.on("document","reset",function(){b.abortTimers();for(var a in k){var e=k[a];e&&!0!==
e&&e.destroy()}k=[];m=0;h=void 0;p=[];l=[];n=[]})}});OIT.extend("mod","view",{exports:"attach detach fitToContainer height info load unload width".split(" "),events:{resize:{delay:80},detach:{}},install:function(a,b){var d=a.glob,c=a.doc,g=a.opt,f=a.content,k=a.document,m=a.pages,h=a.util,p=a.dialog,l=a.ajax,n=a.css,x=OIT.local,s,w=0,t,e,q,y,v={},D,u=0,E=0,r=function(){D&&(D.hide(),D=null)};b.dispatchResize=function(){var a=d.viewNode;if(a&&(q&&z(),t!=a.clientWidth||e!=a.clientHeight))t=a.clientWidth,e=a.clientHeight,b.on.resize.dispatch()};var z=function(){if(q){var a=
q.computedStyle(),b=q.offsetWidth-parseInt(a.borderLeftWidth)-parseInt(a.borderRightWidth),a=q.offsetHeight-parseInt(a.borderTopWidth)-parseInt(a.borderBottomWidth);d.rootNode.css({width:b+"px",height:a+"px"})}};b.dispatchScroll=function(a){var b=d.viewNode;if(b&&(k.on.scrollupdate.dispatch(),b=b.scroll(),a||b.left!=E||b.top!=u)){a=b.left-E;var e=b.top-u;E=b.left;u=b.top;k.on.scroll.dispatch(a,b.left,e,b.top)}};var B=function(){J()},C=function(){},J=function(){g.memoryModel="none";for(var a=m.count(),
b=0;b<a;b++)(b=m.page(b))&&b.isPending()&&b.load(!1)},H=function(){g.nochrome?d.viewNode.addClass("oit-nochrome"):d.viewNode.removeClass("oit-nochrome")},M=function(){var a=d.rootNode;a&&(a.addClass("oit-view-root"),a=d.viewNode,a||(a=c.create("div","oit-view"),d.viewNode=a),s="oitview"+w++,a.id=s,H(),a.attr("tabindex","-1"),a.onscroll(b.dispatchScroll),b.fitToContainer());window.matchMedia&&(a=window.matchMedia("print"))&&a.addListener(function(a){a.matches&&J()});window.addEventListener("beforeprint",
B);window.addEventListener("afterprint",C);window.addEventListener("resize",b.dispatchResize)};a.globalEvents.init.listen(function(){var a=d.rootNode;if(a){var b=a.data("json"),e=a.data("icd"),c=a.data("page");if(b||e)y=a.parent();M();f.initializeContent(b,e,c);k.initializeDocument()}});b.attach=function(a){a&&(b.detach(),q=c.wrap(a),a=d.rootNode,a||(a=d.rootNode=c.create("div")),a.addClass("oit-view-embedded"),q.append(a),M())};b.detach=function(){b.unload();b.on.detach.dispatch();var a=d.rootNode;
if(a)try{a.destroy()}catch(e){}window.removeEventListener("beforeprint",B);window.removeEventListener("afterprint",C);window.removeEventListener("resize",b.dispatchResize);d.rootNode=d.viewNode=null;s=q=y=void 0};b.load=function(a){!q&&!y?b.logError("load","Call OIT.view.attach before OIT.view.load"):(b.unload(),d.dynamicContent=!0,l.start({url:a,loading:A,success:F,error:K}),D=p.createProgressDialog(x.PLEASE_WAIT))};var A=function(a,b,e){a=e?e.length:0;D&&D.update(80*a/b)},F=function(a,e,c){e=!0;
try{0==c.length?(b.logError("load","Document is empty or is still being exported"),e=!1):e=k.installDocument(a,c)}catch(d){b.logError("load",d.message),e=!1}e||r()},K=function(a){b.logError("load","Fatal error in OIT.view.load: unable to retrieve document from the server (error "+a+")");r()};b.unload=function(){k.unload();c.reset()};b.fitToContainer=function(){q&&(z(),b.dispatchResize())};b.width=function(a){a=n.validateLength(a);null!==a&&(q&&q.css("width",a),d.rootNode.css("width",a),b.dispatchResize());
return d.rootNode.offsetWidth};b.height=function(a){a=n.validateLength(a);null!==a&&(q&&q.css("height",a),d.rootNode.css("height",a),b.dispatchResize());return d.rootNode.offsetHeight};b.info=function(){var a=h.clone(v);a.libversion=d.libversion?h.clone(d.libversion):"Unknown";return a};d.onviewNode(function(a,b){b&&b.destroy();if(a){for(var e=d.rootNode,c=e.childByClass("oit-toolframe");c;){c=c.childByClass("oit-toolcontent");if(!c)break;e=c;c=e.childByClass("oit-toolframe")}e&&e.append(a)}});a.on("document",
"reset",function(){r();e=t=void 0;v={};E=u=0});a.on("content","data",function(a,b,e){a.info&&(v=a.info,v.fi||(v.fi=1999),v.fistring||(v.fistring="Unknown"),v.product||(v.product="Outside In Technology"),v.version||(v.version="Unknown"));b&&r()});g.onnochrome(H)}});OIT.extend("mod","dialog",{install:function(a,b){var d=a.glob,c=a.doc,g=a.util,f=a.pages,k=[],m=null,h=!1,p,l=!1;b.createProgressDialog=function(a,b){var c={dialog:null,text:null,ticks:null,spinner:null,percentDone:0,active:!1,suppressed:!1,message:a,showTicks:b,display:x,update:s,hide:t};k.push(c);performance&&performance.now?(c.startTime=performance.now(),c.interval=g.setInterval(n,200,c)):c.display();return c};var n=function(){var a=performance.now()-this.startTime,b=!1;0<this.percentDone?(a=100*
a/this.percentDone,b=1E3<=a):b=500<=a;b&&(g.clearInterval(this.interval),this.display())},x=function(){var e=k.indexOf(this);if(!this.active&&0==e&&!this.dialog)if(this.active=!0,a.dispatch("document","showmessage",this.message,!0,this.showTicks)){this.suppressed=!1;b.showModalOverlay(!0,200);if(e=d.rootNode){this.dialog=c.create("div","oit-dialog oit-progress-dialog");this.text=c.create("div","oit-dialog-text");this.ticks=c.create("div","oit-progress-dialog-ticks");for(var n=0;20>n;n++)this.ticks.append(c.create("div"));
this.spinner=c.create("div","oit-pending oit-progress-dialog-ticks");this.dialog.append(this.text,this.ticks,this.spinner);e.append(this.dialog)}!1===this.showTicks?(this.ticks.css("display",null),this.spinner.css("display","block")):(this.spinner.css("display",null),this.ticks.css("display","block"));this.tickCount=void 0;this.update(this.percentDone);this.text.html(this.message);this.dialog.css({opacity:0,display:"block"});this.dialog.abortAnimation();this.dialog.animate({opacity:1,time:200,startCSS:{display:"block"}})}else this.suppressed=
!0},s=function(b){"number"===typeof b&&(0>b?b=0:100<b&&(b=100),this.percentDone=b,this.active&&(a.dispatch("document","progress",b),this.dialog&&(b=Math.floor(21*b/100),20<b&&(b=20),b!=this.tickCount&&(this.tickCount=b,this.ticks.forChildElements(w,b)))))},w=function(a,b,c){b<c?a.addClass("filled"):a.removeClass("filled")},t=function(){this.interval&&(g.clearInterval(this.interval),this.interval=void 0);this.active&&a.dispatch("document","hidemessage");this.dialog&&(this.dialog.abortAnimation(),this.dialog.animate({opacity:0,
endCSS:{display:"none"},time:200}),b.showModalOverlay(!1,200));g.remove(k,this)};b.showModalOverlay=function(a,b){b=b||200;var n=l;if(a){if(!p){var h=d.rootNode;h&&(p=c.create("div","oit-screen"),h.append(p))}p&&!l&&(l=!0,p.abortAnimation(),p.animate({opacity:0.5,time:b,startCSS:{opacity:0,display:"block"}}))}else l&&(l=!1,p.abortAnimation(),p.animate({opacity:0,time:b,endCSS:{display:null}}));l!=n&&(n=f.activeOverlay())&&n.updateCSS()};b.modalOverlayVisible=function(){return l};b.showMessage=function(e){h&&
b.hideMessage();if(a.dispatch("document","showmessage",e,!1,!1)){if(!m){var n=d.rootNode;n&&(m=c.create("div","oit-background-message"),n.append(m))}m&&(h||(m.abortAnimation(),m.animate({opacity:0.8,time:200,startCSS:{opacity:0,display:"block"}})),m.html(e))}h=!0};b.hideMessage=function(){h&&(a.dispatch("document","hidemessage"),m&&(m.abortAnimation(),m.animate({opacity:0,time:200,endCSS:{display:null}})),h=!1)};b.messageVisible=function(){return h};a.on("document","reset",function(){for(;0<k.length;)k[k.length-
1].hide();m&&m.destroy();p&&p.destroy();m=null;h=!1;p=null;l=!1})}});OIT.extend("mod","rawtext",{events:{add:{}},install:function(a,b){var d=a.glob,c=a.content,g=a.pages,f=a.range,k=a.util,m=a.ajax,h=[],p,l,n=function(){if(void 0===p)for(var a=p=0;a<h.length;a++)h[a].text&&p++;return p};b.find=function(a,c,d,n){if(0<h.length){!1!==d&&(d=!0);for(n="up"===n;;){if(n){var k=c,u=d,l=-1;if(0<h.length){u||(k=k.toLowerCase());for(var r=x(a);void 0!=r;){var t=h[r];if(!t.text&&(s(t,!0),!t.text))break;var p=a-t.range.acc,w;if(t.range.acc+p+k.length>t.range.accend)if(r+1>=h.length){if(b.isPending())break}else{w=
h[r+1];if(!w.text&&(s(w,!0),!w.text))break;var m=t.text.length-k.length;u?w=t.text.substring(m)+w.text.substring(0,k.length-1):(t.lctext||(t.lctext=t.text.toLowerCase()),w.lctext||(w.lctext=w.text.toLowerCase()),w=t.lctext.substring(m)+w.lctext.substring(0,k.length-1));w=w.lastIndexOf(k);if(-1!=w){l=t.range.acc+m+w;if(l<=a)break;l=void 0}}u?w=t.text.lastIndexOf(k,p):(t.lctext||(t.lctext=t.text.toLowerCase()),w=t.lctext.lastIndexOf(k,p));if(-1!=w){l=t.range.acc+w;break}r--}}}else if(k=c,u=d,l=-1,h){u||
(k=k.toLowerCase());for(r=x(a);void 0!=r;){t=h[r];if(!t.text&&(s(t,!0),!t.text))break;p=a-t.range.acc;u?m=t.text.indexOf(k,p):(t.lctext||(t.lctext=t.text.toLowerCase()),m=t.lctext.indexOf(k,p));if(-1!=m){l=t.range.acc+m;break}if(r+1>=h.length)break;m=h[r+1];if(!m.text&&(s(m,!0),!m.text))break;u?m=t.text.substring(p)+m.text.substring(0,k.length):(t.lctext||(t.lctext=t.text.toLowerCase()),m.lctext||(m.lctext=m.text.toLowerCase()),m=t.lctext.substring(p)+m.lctext.substring(0,k.length));m=m.indexOf(k);
if(-1!=m){l=t.range.acc+p+m;break}r++}}a=l;if(-1===a)break;k=a+c.length;if(g.isDocumentText(a,k-1))return f.textRange(a,k);n?a--:a++}}};b.findBoundaryStart=function(a,b){var c;if(0<h.length)for(var d=x(a);void 0!=d;){var n=h[d];if(!n.text&&(s(n,!1),!n.text))break;for(var f=a-n.range.acc;0<f;)if(f--,-1!=b.indexOf(n.text[f])){f++;c=n.range.acc+f;break}if(void 0!==c)break;if(0===d)break;d--}void 0===c&&(c=a);return c};b.findBoundaryEnd=function(a,b){var c;if(0<h.length)for(var d=x(a);void 0!=d;){var n=
h[d];if(!n.text&&(s(n,!1),!n.text))break;for(var f=a-n.range.acc,g=n.text.length-1;f<g;)if(f++,-1!=b.indexOf(n.text[f])){c=n.range.acc+f;break}if(void 0!==c)break;if(d+1>=h.length)break;d++}void 0===c&&(c=a);return c};b.firstACC=function(){if(0<h.length)return h[0].range.acc};b.lastACC=function(){if(0<h.length)return h[h.length-1].range.accend};b.hasRawText=function(){if(0<h.length)return!0;if(!c.isPending())return!1};b.isPending=function(){return c.isPending()?!0:n()<h.length};b.getRawTextBlock=
function(a){if(0<=a&&a<h.length)return a=h[a],a.text||s(a,!0),a};var x=function(a){for(var b=0;b<h.length;b++){var c=h[b].range;if(a>=c.acc&&a<c.accend)return b}},s=function(a,b,c){if(!a.text&&a.src&&!a.loading){var h=k.concatURL(d.baseURL,a.src);n();a.loading=!0;m.start({url:h,async:b,complete:w,args:[a,c]})}},w=function(a,d,n,h,f,g){f.loading=!1;200==h?c.isICD(n)?c.processContentData(n):(f.text=n,t(f)):f.text="";p++;g&&g(f);b.on.add.dispatch(f.range.acc,f.range.accend)};b.replaceRawText=function(a){if(a&&
(l=l?l.concat(a):a,0<h.length))for(a=0;a<h.length;a++)t(h[a])};var t=function(a){if(l&&l.length&&a.text)for(var b,c=a.range.acc,d=a.range.acc+a.text.length,n=0;n<l.length;n++)if(b=l[n],b.acc>=c&&b.acc<d||b.accend>=c&&b.accend<d){var h=b.acc-c;b=b.accend-c;b>a.text.length&&(b=a.text.length);for(var f=b-h,g="";0<f--;)g+=" ";a.text=a.text.substr(0,h)+g+a.text.substr(b)}};a.on("document","reset",function(){l=p=void 0;h=[]});a.on("content","data",function(a,b,c){if(a.text)for(b=0;b<a.text.length;b++){c=
a.text[b];t(c);for(var d=0;d<h.length;d++)if(0==f.compare(c.range,h[d].range)){h[d].text=c.text;c=null;break}c&&h.push(c)}})}});OIT.extend("mod","range",{install:function(a,b){var d=a.doc,c=a.glob,g=a.document,f=a.math,k=a.pages,m=a.util,h=function(a){return"number"===typeof a},p=function(a){return"string"===typeof a},l=function(a,b){return a.acc-b.acc};b.isRangeObject=function(a){return a.constructor===OIT.TextRange||a.constructor===OIT.CellRange||a.constructor===OIT.RectRange};b.validateRange=function(a,c){var d;if(a&&a.type)switch(a.type){case "text":h(a.acc)&&h(a.accend)&&(d=a);break;case "cell":if(h(a.page)&&h(a.c1)&&
h(a.r1)&&h(a.c2)&&h(a.r2)){d=a;if(0>d.page)d=void 0;else if(d.page<k.count()){var g=k.page(d.page);g&&("worksheet"!==g.type&&"database"!=g.type)&&(d=void 0)}else if(d.offsets&&(!h(d.offsets.left)||!h(d.offsets.top)||!h(d.offsets.right)||!h(d.offsets.bottom)))d=void 0;if(d&&!0===c&&(g=k.page(a.page)))if(g=g.spreadsheetModel()){var l=g.colCount()-1,e=g.rowCount()-1,g=f.clamp(a.c1,0,l),l=f.clamp(a.c2,0,l),q=f.clamp(a.r1,0,e),e=f.clamp(a.r2,0,e);if(g!==a.c1||l!==a.c2||q!==a.r1||e!==a.r2)d=b.clone(a),
d.c1=g,d.c2=l,d.r1=q,d.r2=e}}break;case "rect":if(h(a.page)&&h(a.left)&&h(a.top)&&h(a.right)&&h(a.bottom)&&p(a.units)&&("px"===a.units||"tw"===a.units||"pct"===a.units))if(d=a,"pct"===a.units&&!h(a.embedId)?d=void 0:0>d.page?d=void 0:void 0===a.embedId&&d.page<k.count()&&(g=k.page(d.page))&&("page"!==g.type&&"drawing"!==g.type&&"slide"!==g.type&&"chart"!==g.type&&"bitmap"!==g.type&&"email"!==g.type&&"html"!==g.type)&&(d=void 0),d&&(void 0===a.embedId&&!0===c)&&(g=k.page(a.page)))if(e=g.pageRect()){var l=
f.clamp(a.left,e.left,e.right),q=f.clamp(a.top,e.top,e.bottom),m=f.clamp(a.bottom,q,e.bottom),v=a.right;"html"!==g.type&&(v=f.clamp(a.right,l,e.right));if(l!=a.left||v!=a.right||q!=a.top||m!=a.bottom)d=b.clone(a),d.left=l,d.right=v,d.top=q,d.bottom=m}}return d};b.textRange=function(){var a=arguments,c,d;switch(a.length){case 2:h(a[0])&&h(a[1])&&(c=a[0],d=a[1]);break;case 1:if(h(a[0]))c=a[0],d=a[0];else if(m.isDOMRange(a[0])||m.isDOMSelection(a[0])){if(a=b.fromDOM(a[0]))Array.isArray(a)?(c=a[0].acc,
d=a[a.length-1].accend):(c=a.acc,d=a.accend)}else if((a=b.validateRange(a[0]))&&"cell"===a.type){var f=k.page(a.page);if(f&&("worksheet"===f.type||"database"===f.type))if(f.load(!1,!1,null),f=f.spreadsheetModel())return f.mapToText(a)}}if(h(c)&&h(d))return new OIT.TextRange(c,d)};b.accFromNode=function(a,b){a=d.unwrap(a);b=b||0;var h;a:{if(1===a.nodeType&&a.childNodes&&(h=a.childNodes[b]))break a;h=void 0}h&&(a=h,b=0);var f;h=c.viewNode;for(var g=a;g;g=g.parentNode){var e=d.data(g,"acc");if(void 0!==
e){"none"!==e&&(f=d.wrap(g));break}if(g===h)break}if(h=f){f=parseInt(h.data("acc"));if(!h.equals(a)){h=h.createTreeWalker();for(g=h.firstACCNode();g;){g=h.currentNode;if(g===a)break;1===g.nodeType?(g=d.data(g,"acc"))&&(f=parseInt(g)):3===g.nodeType&&(f+=g.nodeValue.length);g=h.nextACCNode()}}return f+b}};b.fromDOM=function(a){var c;m.isDOMRange(a)?c=a:m.isDOMSelection(a)&&("number"===typeof a.rangeCount&&0<a.rangeCount)&&(c=a.getRangeAt(0));if(c){a=c.startContainer;var h=c.startOffset,f=c.endContainer,
g=c.endOffset;if(a===f){var e=b.accFromNode(a,h);if(h===g)return b.textRange(e,e);if(d.isText(a)){var k;return b.textRange(e,e+g-h)}}for(var l=c.commonAncestorContainer;l&&!d.isElement(l);)l=l.parentNode;l=d.wrap(l);c=b.accFromNode(l);for(var p=[],D,l=l.createTreeWalker(),e=l.firstACCNode(),u=!1,E=!1,r=!1,z,B;e;){var C=l.currentNode;if(C===a&&d.isText(a))u=!0;else if(C.parentNode===a&&(E=!0,void 0===z?z=0:z++,0==h||z==h))u=!0;E&&!u&&(d.isDescendantOf(C,a)||(u=!0));if(r&&!d.isDescendantOf(C,f))break;
1===C.nodeType?(e=d.data(C,"acc"))&&(c="none"===e?void 0:Number(e)):3===C.nodeType&&void 0!==c&&(u&&0<C.nodeValue.length&&(e=c,C===a&&(e+=h),k=c+C.nodeValue.length,C===f&&(k=c+g),D&&(D.accend!=c&&D.accend!=c-1)&&(D=null),D?D.accend=k:(D=b.textRange(e,k),p.push(D))),c+=C.nodeValue.length);if(C===f&&d.isText(f))break;else if(C.parentNode===f&&(r=!0,void 0===B?B=0:B++,0==g||B==g))break;e=l.nextACCNode()}p=b.consolidate(p);0==p.length?p=void 0:1==p.length&&(p=p[0]);return p}};b.cellRange=function(){var a,
c,d,f,l,e,q=arguments;switch(q.length){case 9:a=q[0];c=q[1];d=q[2];f=q[3];l=q[4];e={left:q[5],top:q[6],right:q[7],bottom:q[8]};break;case 5:a=q[0];c=q[1];d=q[2];f=q[3];l=q[4];break;case 4:c=q[0];d=q[1];f=q[2];l=q[3];break;case 3:a=q[0];c=q[1];d=q[2];f=q[1];l=q[2];break;case 2:c=q[0];d=q[1];f=q[0];l=q[1];break;case 1:if((q=b.validateRange(q[0]))&&"text"===q.type){var m=k.forRange(q);if(m&&("worksheet"===m.type||"database"===m.type))if(m.load(!1,!1,null),m=m.spreadsheetModel())return m.mapToCells(q)}}if(void 0===
a)a=k.current();else if(p(a)){if(m=k.byName(a))a=m.index}else if(h(a)){if(0>a||a>=k.count())a=void 0}else a=void 0;if(!h(a)||!h(c)||!h(d)||!h(f)||!h(l))g.invalidArg("cellRange");else return new OIT.CellRange(a,c,d,f,l,e)};b.rectRange=function(){var a,b,c,d,f,e,l="px",m=arguments;if(2<=m.length&&6>=m.length){var v=0;if(p(m[v])){var D=k.byName(m[v]);D&&(b=D.index,v++)}for(var D=0,u=v;u<m.length;u++)if(h(m[u]))D++;else break;switch(D){case 6:a=m[v++];case 5:b=m[v++];case 4:c=m[v++];d=m[v++];f=m[v++];
e=m[v++];break;case 3:b=m[v++];case 2:c=m[v++],d=m[v++],f=c,e=d}v<m.count&&p(m[v])&&(l=m[v++])}if(void 0===b)b=k.current();else if(h(b)){if(0>b||b>=k.count())b=void 0}else b=void 0;if(!h(b)||!h(c)||!h(d)||!h(f)||!h(e)||"px"!==l&&"tw"!==l&&"pct"!==l)g.invalidArg("rectRange");else return new OIT.RectRange(a,b,c,d,f,e,l)};b.convert=function(a,b){if("rect"===a.type&&a.units!==b)switch(b){case "px":if("tw"===a.units){var c=k.page(a.page);c&&c.dpi&&(a.left=f.round(a.left*c.dpi/1440,1E4),a.top=f.round(a.top*
c.dpi/1440,1E4),a.right=f.round(a.right*c.dpi/1440,1E4),a.bottom=f.round(a.bottom*c.dpi/1440,1E4),a.units="px")}else if("pct"===a.units&&void 0!==a.embedId&&(c=k.page(a.page)))if(c=c.embeddingRect(a.embedId)){var d=c.width/100,h=c.height/100;a.left=f.round(a.left*d,1E4);a.right=f.round(a.right*d,1E4);a.top=f.round(a.top*h,1E4);a.bottom=f.round(a.bottom*h,1E4);a.units="px"}break;case "tw":if("px"===a.units&&(c=k.page(a.page))&&c.dpi)a.left=f.round(1440*a.left/c.dpi,1E4),a.top=f.round(1440*a.top/c.dpi,
1E4),a.right=f.round(1440*a.right/c.dpi,1E4),a.bottom=f.round(1440*a.bottom/c.dpi,1E4),a.units="tw";break;case "pct":if("px"===a.units&&(c=k.page(a.page))){if(void 0!==a.embedId){if(c=c.embeddingRect(a.embedId))d=100/c.width,h=100/c.height}else h=c.pageRect(),d=100/h.width,h=100/h.height;void 0!==d&&(a.units="pct",a.left=f.round(a.left*d,1E4),a.right=f.round(a.right*d,1E4),a.top=f.round(a.top*h,1E4),a.bottom=f.round(a.bottom*h,1E4))}}};b.compare=function(a,c){if(!a)return!c?0:-1;if(!c)return 1;if(a.page<
c.page)return-1;if(a.page>c.page)return 1;if(a.type===c.type)switch(a.type){case "text":return a.acc<c.acc?-1:c.acc<a.acc?1:a.accend<c.accend?-1:c.accend<a.accend?1:0;case "cell":if(a.r1<c.r1)return-1;if(c.r1<a.r1)return 1;if(a.c1<c.c1)return-1;if(c.c1<a.c1)return 1;if(a.r2<c.r2)return-1;if(c.r2<a.r2)return 1;if(a.c2<c.c2)return-1;if(c.c2<a.c2)return 1;if(a.offsets)if(c.offsets){if(a.offsets.top<c.offsets.top)return-1;if(a.offsets.top>c.offsets.top)return 1;if(a.offsets.left<c.offsets.left)return-1;
if(a.offsets.left>c.offsets.left)return 1;if(a.offsets.bottom<c.offsets.bottom)return-1;if(a.offsets.bottom>c.offsets.bottom)return 1;if(a.offsets.right<c.offsets.right)return-1;if(a.offsets.right>c.offsets.right)return 1}else return 1;else if(c.offsets)return-1;return 0;case "rect":return a.units!=c.units&&(c=b.clone(c),b.convert(c,a.units)),a.top<c.top?-1:c.top<a.top?1:a.left<c.left?-1:c.left<a.left?1:a.bottom<c.bottom?-1:c.bottom<a.bottom?1:a.right<c.right?-1:c.right<a.right?1:0}};b.contains=function(a,
b){if(a.type===b.type)switch(a.type){case "text":return b.acc>=a.acc&&b.accend<=a.accend}return!1};b.clone=function(a){if(a)switch(a.type){case "text":return new OIT.TextRange(a.acc,a.accend);case "cell":var b=new OIT.CellRange(a.page,a.c1,a.r1,a.c2,a.r2);!0===a.selectingCols&&(b.selectingCols=!0);!0===a.selectingRows&&(b.selectingRows=!0);a.offsets&&(b.offsets={left:a.offsets.left,top:a.offsets.top,right:a.offsets.right,bottom:a.offsets.bottom});return b;case "rect":return new OIT.RectRange(a.embedId,
a.page,a.left,a.top,a.right,a.bottom,a.units)}};b.consolidate=function(a){if(a&&1<a.length){a.sort(l);for(var b=[],c,d=0;d<a.length;d++){var h=a[d];c&&3>h.acc-c.accend?h.accend>c.accend&&(c.accend=h.accend):(c=h,b.push(h))}a=b}return a};b.consolidateDOMRanges=function(a){if(1===a.length)return a[0];if(1<a.length){var b=a[0];a=a[a.length-1];var c=document.createRange();c.setStart(b.startContainer,b.startOffset);c.setEnd(a.endContainer,a.endOffset);return c}};b.isEmpty=function(a){if(a=b.validateRange(a))switch(a.type){case "text":return a.acc==
a.accend;case "cell":return!1;case "rect":return a.left==a.right||a.top==a.bottom}return!0}}});OIT.extend("mod","display",{events:{displayload:{},displayunload:{}},install:function(a,b){var d=a.glob,c=a.util,g=null,f=null,k=!1,m;b.loadDisplay=function(c){b.unloadDisplay();if(g=a.fmt.createDisplay(c.type))f=c.overlay,d.deType=c.type,d.deFeatures=a.fmt.features(c.type),d.drawing.resetOrigin(),g.init(c),b.on.displayload.dispatch(f.firstPage,f.lastPage)};b.unloadDisplay=function(){g&&(b.on.displayunload.dispatch(f.firstPage,f.lastPage),g.unload(),f=g=null,d.deType=null);d.item("deFeatures").reset()};
b.isSelectionModeSupported=function(a){var b=!1;switch(a){case "none":b=!0;break;case "text":d.deFeatures.textselection&&(b=!0);break;case "rect":d.deFeatures.rectselection&&(b=!0);break;case "cell":d.deFeatures.cellselection&&(b=!0)}return b};b.isHighlightModeSupported=function(a){var c=b.isSelectionModeSupported(a);if(!c&&"text"===a&&("worksheet"===d.deType||"database"===d.deType))c=!0;return c};b.topPageIndex=function(){if(g)return g.topPageIndex()};b.bottomPageIndex=function(){if(g)return g.bottomPageIndex()};
b.maxPageWidth=function(){if(g)return g.maxPageWidth()};b.maxPageHeight=function(){if(g)return g.maxPageHeight()};b.padding=function(){if(g)return g.padding()};b.margin=function(){if(g)return g.margin()};b.scrollOffset=function(){if(g)return g.scrollOffset()};b.keydown=function(a){return g?g.keydown(a):!0};b.showHidden=function(a){g&&g.showHidden(a)};b.moveto=function(a,b,c){return g?g.moveto(a,b,c||{}):!1};b.getSelectedText=function(){return g?g.getSelectedText():""};b.select=function(a){return g?
g.select(a):!1};b.pageRange=function(a,b){if(g&&f.containsPage(a))return g.pageRange(a,b)};b.pageRect=function(a,b){if(g&&f.containsPage(a))return g.pageRect(a,b)};b.rangeRect=function(a,b,c){if(g&&("text"===a.type||f.containsPage(a.page)))return g.rangeRect(a,b,c)};b.rangeFromRect=function(a,b,c,d,k,m,w,t){if(g&&f.containsPage(a))return g.rangeFromRect(a,b,c,d,k,m,w,t)};b.extendRange=function(a,b,c,d){if(g)return g.extendRange(a,b,c,d)};b.moveAnchor=function(a,b,c,d){return g?g.moveAnchor(a,b,c,
d):!1};b.incrementSelection=function(a,b,c,d,f){return g?g.incrementSelection(a,b,c,d,f):!1};b.suspendUpdate=function(){k||(k=!0)};b.resumeUpdate=function(){k&&(k=!1,b.update())};b.layoutChanged=function(a){g&&g.layoutChanged(a)};b.update=function(a,d){if(!k)if(!0===d)m&&c.clearTimeout(m),m=c.setTimeout(b.update,50,this,a,!1);else if(g)return g.update(a);return!1};a.on("document","reset",b.unloadDisplay);a.on("util","fontload",function(){b.update(!0)})}});OIT.extend("mod","selection",{events:{beginselection:{},selectionchanged:{}},install:function(a,b){var d=a.opt,c=a.glob,g=a.doc,f=a.css,k=a.range,m=a.util,h=a.display,p=a.highlights,l=a.pages,n=null,x=!0,s=null,w=!0,t=!1,e=!0,q,y,v,D,u,E,r,z,B,C,J=0,H,M,A,F=0,K,I=0,L=0,N,P,O,Q,W,G,S,R=!1;b.reset=function(){b.select(null);d.selectionMode=b.validateMode(d.selectionMode)};b.style=function(a,b){w=!1===b?!1:!0;if((null===a||"string"===typeof a)&&a!==s)s=a,n=f.parse(s),U(),T();return s};var U=function(a){if(!a&&
n){a="";n.color&&(a+="color:"+n.color+";");var b=n["background-color"];b&&(a+="background-color:"+b+";")}a&&0<a.length?(Q||(Q=g.create("style"),Q.type="text/css",g.byTagName("head")[0].append(Q)),Q.html(".oit-view ::selection { "+a+"}")):Q&&Q.html("")},T=function(){if(y){var a=y.selectionRect();a.resetStyle();n?(a.removeClass("oit-sel-rect"),a.css(n)):a.addClass("oit-sel-rect");a.update()}};b.textSelection=function(){if(v){if("text"===v.type){var a=k.clone(v);a.bSlideNote=v.bSlideNote;return a}if("cell"===
v.type)return k.textRange(v)}};b.cellSelection=function(){if(v&&"cell"===v.type)return k.clone(v)};b.rectSelection=function(){if(v&&"rect"===v.type)return k.clone(v)};b.selectionType=function(){return v?v.type:"none"};b.hide=function(){x=!1;U("background-color: rgba(255,255,255,0);");y&&y.showSelectionRect(!1)};b.select=function(c,e,d,f){var g=!1;x=!0;if(null===c)g=null!=v,X(),b.update();else if(c)if(m.isDOMSelection(c)||m.isDOMRange(c))g=b.select(k.textRange(c));else if((c=k.validateRange(c))&&0!=
k.compare(c,v)){var u=l.forRange(c,0,!0);u&&(g=!0,b.on.beginselection.dispatch(c),X(),y=u,v=k.clone(c),q=k.clone(c),!0==c.bSlideNote&&(v.bSlideNote=!0),T(),b.update())}if(g||e!==S)if(b.on.selectionchanged.dispatch(v,!0),S=e,a.dispatch("document","select",v,d||null,f||null,k.isEmpty(v),e)&&v&&void 0===e)c=h.rangeRect(v,"view"),"text"===v.type&&b.update(),c&&p.activateNearest(c.left,c.top);return g};b.startRectSelection=function(a,c){X();h.isSelectionModeSupported("text")||p.startSelection();var e=
l.mapToPage(a,c,null,!0);b.logRect&&b.logRect(e.page,e.x,e.y,!0);D={x:a,y:c};y=e.page;E=e.x;r=e.y;z=a;B=c;x=u=!0;v=h.rangeFromRect(y.index,E,r,E,r,y,"select");"cell"===v.type&&!t&&delete v.offsets;q=k.clone(v);b.on.beginselection.dispatch(v);T();b.update();b.on.selectionchanged.dispatch(v,!1)};b.extendRectSelection=function(a,c){if(q){if(u){var d=Math.abs(a-z),f=Math.abs(c-B);if(2<d||2<f)u=!1,h.isSelectionModeSupported("text")&&p.startSelection()}Z(a,c);d=l.mapToPage(a,c,y,!0);b.logRect&&b.logRect(d.page,
d.x,d.y);v=h.extendRange(q,d.x,d.y,d.page);e&&(v=k.validateRange(v,!0));b.update();b.on.selectionchanged.dispatch(v,!1)}};b.endRectSelection=function(c,e,h){ca();b.extendRectSelection(c,e);b.on.selectionchanged.dispatch(v,!0);c={x:c,y:e};S=void 0;a.dispatch("document","select",v,D,c,u)&&"rect"===d.selectionMode&&b.select(null);p.endSelection()};b.cancelRectSelection=function(a,c){ca();b.select(null)};b.startTouchTextSelection=function(a,c){x=!0;W&&b.abortTouchTextSelection()};b.updateTouchTextSelection=
function(){var a=window.getSelection();if(a.anchorNode&&(!G||G.anchorNode!=a.anchorNode||G.anchorOffset!=a.anchorOffset||G.focusNode!=a.focusNode||G.focusOffset!=a.focusOffset))G||(G={}),G.anchorNode=a.anchorNode,G.anchorOffset=a.anchorOffset,G.focusNode=a.focusNode,G.focusOffset=a.focusOffset,W=k.textRange(a)};b.abortTouchTextSelection=function(){W=null};b.startTextSelection=function(a,e,d){X();A=C=null;x=!0;D={x:a,y:e};u=!0;z=a;B=e;if(!c.deFeatures.customtextselection)return!1;a=l.mapToPage(a,e,
null,!0);!0==a.page.bNotesBar&&(R=!0);e=a.page.mapPointToText(a.x,a.y);if(!e||!e.overlaps)return!1;M=m.getTextRoot(e.node);var h;if("line"===d||"word"===d)h=a.page.findTextBoundary(e.node,e.offset,d);h?(K=d,H=h,C=H.startContainer,J=H.startOffset,A=H.endContainer,F=H.endOffset):(K=void 0,C=e.node,J=e.offset,A=e.node,F=e.offset);if(C&&A&&(b.update(),g.selectRange(C,J,A,F),d=window.getSelection(),d.anchorNode&&d.focusNode))if(d=k.textRange(d))b.on.beginselection.dispatch(d);else return A=C=null,!1;return!0};
b.extendTextSelection=function(a,b){if(!c.deFeatures.customtextselection)return!1;if(u){var e=Math.abs(a-z),d=Math.abs(b-B);if(2<e||2<d)u=!1,h.isSelectionModeSupported("text")&&p.startSelection()}Z(a,b);e=l.mapToPage(a,b,null,!0);d=e.page.mapPointToText(e.x,e.y,M);if(!d)return!1;if(d.node!=A||d.offset!=F){if(K){if(e=e.page.findTextBoundary(d.node,d.offset,K))d=e.compareBoundaryPoints(Range.START_TO_START,H),-1==d?(A=e.startContainer,F=e.startOffset,C=H.endContainer,J=H.endOffset):(C=H.startContainer,
J=H.startOffset,A=e.endContainer,F=e.endOffset)}else A=d.node,F=d.offset;C==A?J>F?g.selectRange(A,F,C,J):g.selectRange(C,J,A,F):(d=C.compareDocumentPosition(A),2==d?g.selectRange(A,F,C,J):g.selectRange(C,J,A,F))}return!0};b.endTextSelection=function(c,e,h){ca();if("text"==d.selectionMode){var f=!0,n;W?(n=W,W=null):(n=window.getSelection(),n=n.anchorNode&&n.focusNode?k.textRange(n):null);if(n){if(0!=k.compare(n,v)){var t;if(t=!0==R?l.notesBar():l.forRange(n))u=!1,B=z=r=E=void 0,y=t,v=n,!0==R&&(v.bSlideNote=
!0),q=k.clone(n),b.on.selectionchanged.dispatch(v,!0),f={x:c,y:e},S=void 0,f=a.dispatch("document","select",v,D,f,k.isEmpty(v))}}else X(),p.autoHighlight()&&g.clearSelection();f&&(void 0!==c&&void 0!=e)&&(f=!v||k.isEmpty(v),p.activateNearest(c,e,h,f));C=void 0;J=0;A=H=void 0;F=0;K=void 0}R=!1;p.endSelection()};b.incrementSelection=function(a,c,e){var d=!1;if(v&&(d=h.incrementSelection(q,v,a,c,e)))b.update(),b.on.selectionchanged.dispatch(v,!0);return d};b.moveAnchor=function(a,c,e){var d=!1;if(q&&
(d=h.moveAnchor(q,a,c,e)))v=k.clone(q),b.update(),b.on.selectionchanged.dispatch(v,!0);return d};b.update=function(){if(v)if("text"===v.type){g.clearSelection();b.logUpdate&&b.logUpdate(v);var a=l.findTextRange(v);a&&g.selectRange(k.consolidateDOMRanges(a))}else{if(y)if(a=h.rangeRect(v,"overlay",!0),b.logUpdate&&b.logUpdate(v,a),a){if(y.hasSelectionRect()){var c=y.selectionRect();c.move(a.left,a.top,a.width,a.height);c.show(x&&(!u||w)&&("rect"===v.type||"cell"===v.type))}}else y.showSelectionRect(!1)}else g.clearSelection();
h.select(v)&&h.update()};var X=function(){g.clearSelection();y&&y.showSelectionRect(!1);x=!0;u=!1;B=z=r=E=void 0;v=q=y=null;U();T()};b.validateMode=function(a,c){h.isSelectionModeSupported(a)||(a=void 0);a||(c?a=b.validateMode(c):h.isSelectionModeSupported("text")?a="text":h.isSelectionModeSupported("rect")?a="rect":h.isSelectionModeSupported("cell")&&(a="cell"));return a};var Z=function(a,b){if(a!=N||b!=P){N=a;P=b;var e=c.viewNode,h=0;if(!0==d.showSlideNotes){var f=l.notesBar();f&&(h=f.getHeight())}1>=
a?(I=a-1,-30<I&&(I=-30)):a>=e.clientWidth-1?(I=a-(e.clientWidth-1),30>I&&(I=30)):I=0;1>=b?(L=b-1,-30<L&&(L=-30)):b>=e.clientHeight+h-1?(L=b-(e.clientHeight+h-1),30>L&&(L=30)):L=0;I||L?O||(O=m.setInterval(fa,100)):ca()}},fa=function(){c.viewNode.dscroll(I,L);C?b.extendTextSelection(N,P):b.extendRectSelection(N,P)},ca=function(){O&&(m.clearInterval(O),O=void 0,L=I=0)};b.enableCellOffsets=function(a){t=!!a};b.bindSelectionToPage=function(a){e=!!a};X();d.onselectionMode(function(a){b.select(null);(a=
l.activeOverlay())&&a.updateCSS()});a.on("document","reset",b.reset);a.on("display","displayload",b.reset);a.on("view","detach",function(){s=n=null;Q&&(Q.destroy(),Q=null)});a.on("document","zoom",function(a,c,e){b.update()})}});OIT.extend("mod","user",{events:{beginscroll:{},endscroll:{},beginpinchzoom:{},endpinchzoom:{}},install:function(a,b){var d=a.opt,c=a.glob,g=a.doc,f=a.display,k=a.selection,m=a.util,h=a.math,p=a.document,l=a.highlights,n=a.pages,x=!1,s=!1,w=!1,t=!1,e,q,y=null,v,D,u,E=null,r,z,B,C,J,H,M=!1,A,F,K,I;a.on("document","load",function(){var a=c.rootNode;a.onmousedown(P);a.onmousewheel(Q);window.addEventListener("mouseup",O,!1);window.addEventListener("keydown",L,!1);c.isMobileOrTablet&&(a=c.viewNode,a.kinetic(!0),
a.ontap(ha),a.onpress(ia),a.onpressup($),a.onpanstart(da),a.onpanmove(ja),a.onpanend(aa),a.onpancancel(aa),a.onpinchstart(ka),a.onpinchmove(Y),a.onpinchend(ba),a.onpinchcancel(ba),a.onrotatestart(V),a.onrotatemove(na),a.onrotateend(ea),a.onrotatecancel(ea),la())});a.on("document","reset",function(){var a=c.rootNode;a&&(a.offmousedown(P),a.offmousewheel(Q));window.removeEventListener("mouseup",O);window.removeEventListener("keydown",L);if(c.isMobileOrTablet&&(a=c.viewNode))a.offtap(ha),a.offpress(ia),
a.offpressup($),a.offpanstart(da),a.offpanmove(ja),a.offpanend(aa),a.offpancancel(aa),a.offpinchstart(ka),a.offpinchmove(Y),a.offpinchend(ba),a.offpinchcancel(ba),a.offrotatestart(V),a.offrotatemove(na),a.offrotateend(ea),a.offrotatecancel(ea)});var L=function(a){b.logKeydown&&b.logKeydown(a);if(b.isViewEventTarget(a.target)||x&&a.target==document.body){var e=p.on.keydown.dispatch(a);if(e&&!c.editingComment&&(e=f.keydown(a))){var h=c.viewNode,g=l.active(),u=0,q=0;switch(a.keyCode){case 33:n.movetoPrev();
e=!1;break;case 34:n.movetoNext();e=!1;break;case 35:h.scroll(h.scrollWidth,h.scrollHeight);e=!1;break;case 36:h.scroll(0,0);e=!1;break;case 37:u=-1;break;case 38:q=-1;break;case 39:u=1;break;case 40:q=1;break;case 45:void 0!==g&&l.getOption(g,"enableUserComment")&&(l.showComment(g,{mode:"edit",removeOnCancel:!1}),e=!1);break;case 46:void 0!==g&&l.getOption(g,"enableUserDelete")&&(l.remove(),g=void 0,e=!1);break;case 48:a.ctrlKey&&(p.zoom(1),e=!1);break;case 187:a.ctrlKey&&(p.zoomIn(),e=!1);break;
case 189:a.ctrlKey&&(p.zoomOut(),e=!1)}if(u||q){var r;if(void 0!==g&&(h=l.range(g)))r=h.type;r||(r=d.selectionMode);if("cell"===r||"rect"===r)if(e=a.ctrlKey,void 0!==g){if(a.shiftKey){var t=h=0,S=0,A=0;r=d.rotation;switch(r){case 0:S=u;A=q;break;case 90:A=u;h=-q;break;case 180:h=-u;t=-q;break;case 270:t=-u,S=q}l.move(g,h,t,S,A,e)}else{r=d.rotation;if(0!=r)switch(h=u,t=q,r){case 90:u=-t;q=h;break;case 180:u=-h;q=-t;break;case 270:u=t,q=-h}l.move(g,u,q,u,q,e)}(h=l.range(g))&&n.moveto(h);e=!1}else e=
a.shiftKey?!k.incrementSelection(u,q,e):!k.moveAnchor(u,q,e)}}!1===e&&m.preventDefault(a);return e}},N=function(a){if((a.button||0)==J)b.releaseMouseCapture(),b.on.endscroll.dispatch();J=void 0},P=function(a){x=!1;b.logMouse&&b.logMouse(a);if(!c.editingComment){var e=c.viewNode,h=e.mousePos(a);if(b.isViewEventTarget(a.target)){var f=a.button||0,g=e.inRect(h.x,h.y);if(!0==d.showSlideNotes&&!g){var l=n.notesBar();if(l){var u=l.mousePos(a),g=l.inRect(u.x,u.y);!0==g&&(h=u,M=!0)}}if(1==f||0==f&&!g)b.on.beginscroll.dispatch(),
J=f,b.setMouseCapture(null,N);else{g=!0;e.focus();x=!0;if(0===f){e=d.selectionMode;if("rect"===e||"cell"===e)w=!0,b.setMouseCapture(Z),k.startRectSelection(h.x,h.y),g=!1;else if("text"==e){var q,e=1;if(void 0!==r){var p;if(a.pageX||a.pageY)q=a.pageX,p=a.pageY;else if(a.clientX||a.clientY)q=a.clientX,p=a.clientY;q=Math.abs(q-z.x);p=Math.abs(p-z.y);3>=q&&3>=p&&((new Date).getTime()-r<=d.doubleClickInterval&&(e=B+1),r=void 0)}q=e;var S;2===q?S="word":q=1;if(k.startTextSelection(h.x,h.y,S))if(t=!0,b.setMouseCapture(fa),
h=q,r=(new Date).getTime(),B=h,a.pageX||a.pageY)z={x:a.pageX,y:a.pageY};else if(a.clientX||a.clientY)z={x:a.clientX,y:a.clientY};g=!1}s=!0}!1===g&&m.preventDefault(a);return g}}}},O=function(a){var e;b.logMouse&&b.logMouse(a);if(q)e=q.call(y,a);else if(s){e=!0;if(!c.editingComment){var d;d=!0==M&&n.notesBar()?n.notesBar().mousePos(a):c.viewNode.mousePos(a);if(0===(a.button||0))w?(w=!1,b.releaseMouseCapture(),k.endRectSelection(d.x,d.y,a)):(t&&(t=!1,b.releaseMouseCapture()),M&&(M=!1),k.endTextSelection(d.x,
d.y,a)),e=!1}s=!1}!1===e&&m.preventDefault(a);return e},Q=function(a){if(!c.editingComment&&b.isViewEventTarget(a.target))if(a.ctrlKey){if(!d.browserZoom)return 0<a.wheelDelta?OIT.document.zoomIn():0>a.wheelDelta&&OIT.document.zoomOut(),m.preventDefault(a),!1}else b.on.beginscroll.dispatch(),void 0!==C&&m.clearTimeout(C),C=m.setTimeout(W,500)},W=function(){C=void 0;b.on.endscroll.dispatch()};b.setMouseCapture=function(a,c,d){b.releaseMouseCapture();"function"===typeof a&&(window.addEventListener("mousemove",
G,!1),e=a);"function"===typeof c&&(q=c);if(e||q)g.body.onmouseover(S),g.body.onmouseout(R);y=d};var G=function(a){e&&e.call(y,a)},S=function(a){if(H){var b=ca(a);if(b!==H.buttons&&H.buttons&1&&!(b&1)){var b=H,c;document.createEvent?(c=document.createEvent("MouseEvent"),c.initMouseEvent("mouseup",!0,!0,window,null,b.screenX,b.screenY,b.clientX,b.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,a.relatedTarget)):c=new MouseEvent("mouseup",{screenX:b.screenX,screenY:b.screenY,clientX:b.clientX,clientY:b.clientY,
ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,altKey:a.altKey,metaKey:a.metaKey,button:0,buttons:a.buttons,relatedTarget:a.relatedTarget,region:a.region});O(c)}H=void 0}},R=function(a){H={buttons:ca(a),screenX:a.screenX,screenY:a.screenY,clientX:a.clientX,clientY:a.clientY}};b.releaseMouseCapture=function(){e&&(window.removeEventListener("mousemove",e,!1),e=null);q=null;g.body.offmouseover(S);g.body.offmouseout(R)};b.setTouchCapture=function(a,c,e,d){b.releaseTouchCapture();"function"===typeof a&&(g.listen("touchmove",
U,!1),v=a);"function"===typeof c&&(g.listen("touchend",T,!1),D=c);"function"===typeof e&&(g.listen("touchcancel",X,!1),u=e);E=d};var U=function(a){v&&v.call(E,a)},T=function(a){D&&D.call(E,a)},X=function(a){u&&u.call(E,a)};b.releaseTouchCapture=function(){v&&(g.unlisten("touchmove",U,!1),v=null);E=u=D=null};var Z=function(a){if(w){var b=c.viewNode.mousePos(a);k.extendRectSelection(b.x,b.y);m.preventDefault(a);return!1}return!0},fa=function(a){if(t){var b;b=!0==M&&n.notesBar()?n.notesBar().mousePos(a):
c.viewNode.mousePos(a);k.extendTextSelection(b.x,b.y);m.preventDefault(a);return!1}return!0};b.isViewEventTarget=function(a){for(var b=c.viewNode;a;){if(b.equals(a))return!0;if("TEXTAREA"===a.tagName)break;if("oit-em_allheaders"===a.id)break;if(g.hasClass(a,"oit-emheadervalues")||g.hasClass(a,"oit-note-icons")||g.hasClass(a,"oit-ssoverlay")||g.hasClass(a,"oit-slidenotes"))return!0;if(g.hasClass(a,"oit-button")||g.hasClass(a,"oit-note")||g.hasClass(a,"oit-expander"))break;a=a.parentNode}return!1};
var ca=function(a){if(void 0!==a.buttons)return a.buttons;switch(a.button){case 0:return 1;case 1:return 4;case 2:return 2;case 3:return 8;case 4:return 16}},ha=function(a){var b=a.center;l.activateNearest(b.x,b.y,a.srcEvent)},ia=function(a){x=!1;if(!c.editingComment){a=a.center;c.viewNode.focus();x=!0;var b=d.selectionMode;"rect"===b||"cell"===b?(w=!0,k.startRectSelection(a.x,a.y)):"text"==b&&k.startTextSelection(a.x,a.y,"word")&&(t=!0)}},$=function(a){if(w||t)if(w){w=!1;var b=a.center;k.endRectSelection(b.x,
b.y,a.srcEvent)}else t&&(t=!1,b=a.center,k.endTextSelection(b.x,b.y,a.srcEvent))},da=function(a){if(!a.press)switch(a=c.viewNode,A=a.scroll(),d.scrollMode){case "hswipe":F={prev:10>=A.left,next:a.clientWidth>=a.scrollWidth-A.left-10};break;case "vswipe":F={prev:10>=A.top,next:a.clientHeight>=a.scrollHeight-A.top-10};break;default:F=void 0}},ja=function(a){a.press?w?(a=a.center,k.extendRectSelection(a.x,a.y)):t&&(a=a.center,k.extendTextSelection(a.x,a.y)):A&&(a=a.delta,c.viewNode.autoscroll(A.left-
a.x,A.top-a.y))},aa=function(a){a.press||(A=void 0)},ka=function(a){K=d.zoom;b.on.beginpinchzoom.dispatch()},Y=function(a){K&&p.zoom(K*a.scale,a.center,!0)},ba=function(a){K=void 0;b.on.endpinchzoom.dispatch()},V=function(a){I=d.rotation},na=function(a){if(void 0!==I){var b=I;a=h.normalizeAngle(h.degrees(a.rotation),"deg");60<a&&300>a&&(b=135>a?b+90:225>a?b+180:b+270);p.rotate(b)}},ea=function(a){I=void 0},oa=function(){c.viewNode.cancelKinetic();c.viewNode.scroll(0,0)},ma=function(a){if(F&&F.prev){a=
n.activePage();var b=n.prev();b&&b.overlay==a.overlay&&n.moveto(b.index,oa)}},ga=function(a){if(F&&F.next){a=n.activePage();var b=n.next();b&&b.overlay==a.overlay&&n.moveto(b.index,oa)}},la=function(){if(c.isMobileOrTablet){var a=c.viewNode,b=d.scrollMode,e="vswipe"===b;"hswipe"===b?(a.onswipeleft(ma),a.onswiperight(ga)):(a.offswipeleft(ma),a.offswiperight(ga));e?(a.onswipedown(ma),a.onswipeup(ga)):(a.offswipedown(ma),a.offswipeup(ga))}};d.onscrollMode(la)}});OIT.extend("mod","content",{events:{data:{},add:{},first:{},last:{}},install:function(a,b){var d=a.opt,c=a.glob,g=a.doc,f=a.ajax,k=a.dialog,m=a.util,h=OIT.local,p=!1,l=!0,n=[],x=[],s,w,t,e=[],q,y,v=!1,D=0,u=!1,E=function(){q&&(q.hide(),q=null)},r=function(a){a&&(e.push(a),p&&setTimeout(M,0),(a=n.shift())&&a.destroy())};b.isPending=function(){return 0<x.length||0<e.length};b.initializeContent=function(a,b,d){OIT.content&&(r(OIT.content),delete OIT.content);d?(c.singlePageIndex=Number(d),b&&c.dynamicContent&&
B(b)):b?(c.dynamicContent=!0,B(b)):a&&"none"!==a&&(c.dynamicContent=!0,C(a));p=!0;0<e.length&&setTimeout(M,0)};var z=function(a){if(!y&&a){if((void 0==d.outputBaseUrl||null==d.outputBaseUrl||""==d.outputBaseUrl)&&d.detectBaseUrl&&"/"!=a[0]&&0!=a.search(/http/i)){var b=c.URL.lastIndexOf("/");if(-1!=b){b=c.URL.substr(0,b+1);if(0==b.search(/http/i)){var e=document.createElement("a");e.href=b;b=e.pathname||e.pathName;"/"!=b[0]&&(b="/"+b)}0!=a.indexOf(b)&&(c.baseURL=b||null)}}y=c.baseURL}return y},B=function(a,
b){if(a){var e=z(a);e&&"/"!=a.charAt(0)&&(a=m.concatURL(e,a));0==c.URL.indexOf("file://")?(e=g.create("script"),e.attr("src",a),g.head.append(e),n.push(e)):(x.push({url:a,lastContent:b,cache:!0}),H())}},C=function(a){if(a&&"none"!==a){var b=z(a);b&&"/"!=a.charAt(0)&&(a=m.concatURL(b,a));x.push({url:a,cache:!0});H()}},J=function(a,c,e,f){s=void 0;404===f&&(e="");200===f||404==f?0==e.length||0==e.indexOf("%")?!0===x[0].lastContent?(x.shift(),H()):(e!==t&&(t=e,w=0),w>d.contentTimeout?(E(),k.showMessage(h.DOCUMENT_ERROR),
b.logFatalError(null,"Fatal error in view: Timed out waiting for document data from the server (error "+f+")"),x=[]):(l?q||(q=k.createProgressDialog(h.PLEASE_WAIT_INITIALIZING,!1)):k.showMessage(h.PLEASE_WAIT_CONVERTING),x[0].cache=!1,w+=1E3,m.setTimeout(H,1E3))):(x.shift(),b.processContentData(e),H(),E()):0!=f&&(E(),k.showMessage(h.DOCUMENT_ERROR),b.logFatalError(null,"Fatal error in view: unable to retrieve document data from the server (error "+f+")"),x=[])},H=function(){0<x.length?void 0===s&&
(w=0,t="",s=f.start({url:x[0].url,cache:x[0].cache,complete:J})):E()};b.isICD=function(a){return"if(window.OIT&&OIT.icd)OIT.icd("==a.substring(0,31)};b.processContentData=function(a){var c=a.indexOf("else OIT.content={");if(-1!=c){var c=c+18,d=a.lastIndexOf("}");-1!=d&&(a="{"+a.substring(c,d)+"}")}else b.isICD(a)&&(c=31,d=a.lastIndexOf(");"),-1!=d&&(a=a.substring(c,d)));try{var h=JSON.parse(a)}catch(f){return}e.push(h);M()};var M=function(){if(p&&!u&&0<e.length){for(var a=l,d=!1;0<e.length;){var h=
e.shift();if(h.guid)if(c.guid){if(h.guid!==c.guid){b.logFatalError(null,"Fatal error in view: Document data is corrupt");break}}else c.guid=h.guid;if(h.info&&h.info.version){var f=h.info.version.split("."),g=parseInt(f[0]),q=parseInt(f[1]),f=parseInt(f[2]);0<g&&(0<=q&&9>=q&&0<=f&&9>=f)&&(D=g+q/10+f/100)}b.on.data.dispatch(h,l,D);void 0===c.singlePageIndex?(h.lastContent&&!v&&(v=!0,(h.nextContent||h.nextData)&&B(h.lastContent,!0)),h.nextContent?B(h.nextContent):h.nextData?C(h.nextData):d=!0):d=!0;
l=!1}a&&b.on.first.dispatch();b.on.add.dispatch();d&&(k.hideMessage(),b.on.last.dispatch())}};a.on("document","reset",function(){E();p=!1;l=!0;n=[];x=[];t=w=s=void 0;e=[];y=void 0;v=!1;D=0;u=!1;c.singlePageIndex=void 0;b.on.add.reset()});a.on("user","beginscroll",function(){u=!0});a.on("user","endscroll",function(){u=!1;M()});a.export("icd",r)}});OIT.extend("mod","document",{exports:"cellRange cellSelection externalData externalValue find findAll getRawText getSelectedText highlight properties rectRange rectSelection removeExtraEmailHeaders rotate select selection selectionMode selectionStyle selectionType setOptions showHidden textRange textSelection updateViewSize zoom zoomIn zoomOut".split(" "),events:{load:{pub:!0,detail:function(){return{url:this.glob.URL}},onAdd:function(a,b){this.glob.documentLoaded&&this.util.setTimeout(function(){a.dispatchTo(b)},
0)}},reset:{},unload:{pub:!0},zoom:{pub:!0,detail:function(a,b,d){return{zoom:a,mode:b}}},rotate:{pub:!0,detail:function(a){return{angle:a}}},resize:{},idle:{pub:!0,onListen:function(){this.document.resetIdleTimer()},onUnlisten:function(){this.document.resetIdleTimer()},onAdd:function(){this.document.resetIdleTimer()},onRemove:function(){this.document.resetIdleTimer()}},error:{pub:!0,detail:function(a){return{message:a}}},select:{pub:!0,detail:function(a,b,d,c,g){a={selection:a,empty:c};b&&d&&(a.start=
b,a.end=d);void 0!==g&&(a.highlightid=g);return a}},scroll:{pub:!0,detail:function(a,b,d,c){b=this.glob.viewNode;d=this.pages;a=d.mapToPage(0,0);b=d.mapToPage(b.clientWidth,b.clientHeight);return a&&b?{viewUpperLeft:{pageIndex:a.page.index,x:a.x,y:a.y},viewLowerRight:{pageIndex:b.page.index,x:b.x,y:b.y}}:{viewUpperLeft:{pageIndex:0,x:0,y:0},viewLowerRight:{pageIndex:0,x:0,y:0}}}},scrollupdate:{delay:200},keydown:{pub:!0,detail:function(a){return{srcEvent:a}}},optionschanged:{pub:!0,detail:function(a){return a}},
showmessage:{pub:!0,detail:function(a,b,d){return{message:a||"",modal:b||!1,progress:d||!1}}},progress:{pub:!0,detail:function(a){return{percentDone:a||0}}},hidemessage:{pub:!0},done:{pub:!0}},install:function(a,b){var d=a.opt,c=a.glob,g=a.doc,f=a.display,k=a.util,m=a.math,h=a.rawtext,p=a.content,l=a.dialog,n=a.selection,x=a.range,s=a.highlights,w=a.pages,t=a.view,e=a.ajax,q=OIT.local,y=[0.1,0.25,0.5,0.75,1,1.25,1.5,2,3,5,10,20,40],v=y[0],D=y[y.length-1],u=["rows","columns","all","none"],E=!1,r,z,
B,C={},J={},H,M,A;b.properties=function(){if(c.documentLoaded)return k.clone(C)};b.externalValue=function(a){if(c.documentLoaded)return J[a]};b.externalData=function(){if(c.documentLoaded)return J};b.setOptions=function(a){if(a){var c=!1,e={},h;for(h in a)d.isPublic(h)&&(d[h]=a[h],e[h]=a[h],c=!0);a.emailHeaderFontSize&&d.item("emailHeaderStyle").setProperty("fontSize",a.emailHeaderFontSize);c&&b.on.optionschanged.dispatch(e)}};a.on("user","beginpinchzoom",function(a,b){E=!0});a.on("user","endpinchzoom",
function(){E=!1;I(!1)});var F=function(a){a<v?a=v:a>D&&(a=D);return a};b.zoom=function(a,c,e){if("number"===typeof a){var h=F(a);h!=a&&(e||b.invalidArg("zoom","zoom",a,"using fallback zoom factor "+h,!1),a=h);if(d.zoomMode||a!=d.zoom)d.zoom=a,d.zoomMode=null,I(!1,c)}else"string"===typeof a?a!=d.zoomMode&&(d.zoomMode=a,I(!1,c)):"undefined"!==typeof a&&!e&&b.invalidArg("zoom","zoom",a);return d.zoom};b.zoomIn=function(){for(var a=0;a<y.length;a++)if(y[a]>d.zoom){b.zoom(y[a]);break}return d.zoom};b.zoomOut=
function(){for(var a=y.length-1;0<=a;a--)if(y[a]<d.zoom){b.zoom(y[a]);break}return d.zoom};b.rotate=function(a){"number"===typeof a?d.rotation=m.normalizeAngle(a,"deg"):void 0!==a&&b.invalidArg("rotate","angle",a,"Angle must be an integer multiple of 90 degrees.");return d.rotation};b.showHidden=function(a){c.documentLoaded&&c.deFeatures.showhidden&&(void 0!==a&&-1==u.indexOf(a)?b.invalidArg("showHidden","mode",a,"Must be one of "+JSON.stringify(u)):f.showHidden(a))};b.find=function(a,e,d,h,f){c.documentLoaded&&
("up"!==h&&(h="down"),!1!==d&&(d=!0),"string"!==typeof a?b.invalidArg("find","searchTerm",a,"must be a string"):k.isFunction(e)?k.setTimeout(P,0,{searchTerm:a,callbackFn:e,caseSensitive:d,direction:h,startACC:f}):b.invalidArg("find","callbackFn",e,"must be a function"))};b.findAll=function(a,e,d){if(c.documentLoaded)if(!1!==d&&(d=!0),"string"!==typeof a)b.invalidArg("findAll","searchTerm",a,"must be a string");else if(k.isFunction(e)){var f=h.firstACC();k.setTimeout(O,0,{searchTerm:a,callbackFn:function(a){var b=
!0;a?e&&(b=e.call(null,a)):(e&&e.call(null),b=!1);!1!==b&&(b=!0);return b},startIterationFn:null,endIterationFn:null,caseSensitive:d,startACC:f})}else b.invalidArg("findAll","callbackFn",e,"must be a function")};b.getRawText=function(a){c.documentLoaded&&(k.isFunction(a)?k.setTimeout(Q,0,{callbackFn:a,textBlockIndex:0}):b.invalidArg("getRawText","callbackFunction",a,"must be a function"))};b.highlight=function(a,e,d,g,u){if(c.documentLoaded)if(!1===h.hasRawText())b.logError("highlight","Search functionality has been disabled for this document");
else if(s)if(!1===c.deFeatures.highlights)b.logError("highlight","Highlighting functionality is not available for this document type");else if(!1!==g&&(g=!0),"string"!==typeof a)b.invalidArg("highlight","searchTerm",a,"must be a string");else if("string"!==typeof e)b.invalidArg("highlight","style",e,"must be a string");else if(d&&!k.isFunction(d))b.invalidArg("highlight","callbackFn",d,"must be a function");else{var n=h.firstACC(),r=l.createProgressDialog(q.PLEASE_WAIT,!0);s.beginBatch();k.setTimeout(O,
0,{searchTerm:a,callbackFn:function(a){var b=!0;if(a){var c=s.add(e,a,u);d&&(b=d.call(null,a,c))}else d&&d.call(null),b=!1;!1!==b&&(b=!0);b||(s.endBatch(),r.hide());return b},startIterationFn:function(a){0<a&&(p.isPending()?r.update(10):r.update(a));f.suspendUpdate()},endIterationFn:f.resumeUpdate,caseSensitive:g,startACC:n})}else b.logError("highlight","Highlighting functionality has been disabled for this document")};b.select=function(a,e){if(c.documentLoaded){var d=!1;if(!1===h.hasRawText())b.logError("select",
"Javascript selection functionality has been disabled for this document");else if(null===a)d=n.select(null);else if(k.isDOMSelection(a)||k.isDOMRange(a))d=n.select(a);else{var f=x.validateRange(a);f?(!1!==e&&w.moveto(f),d=n.select(f)):b.invalidArg("select","range",a,"must be a valid text range, cell range, or rect range")}return d}};b.selectionType=function(){if(c.documentLoaded)return n.selectionType()};b.selectionMode=function(a){a&&(d.selectionMode=a);return d.selectionMode};b.selectionStyle=function(a){if(void 0!==
a&&null!==a&&"string"!==typeof a)b.invalidArg("selectionStyle","style",a,"Must be a valid CSS string");else return n.style(a)};b.selection=function(){if(c.documentLoaded)switch(n.selectionType()){case "text":return n.textSelection();case "cell":return n.cellSelection();case "rect":return n.rectSelection()}};b.textSelection=function(){if(c.documentLoaded)return n.textSelection()};b.cellSelection=function(){if(c.documentLoaded)return n.cellSelection()};b.rectSelection=function(){if(c.documentLoaded)return n.rectSelection()};
b.getSelectedText=function(){if(c.documentLoaded)return f.getSelectedText()};b.textRange=function(){return x.textRange.apply(this,arguments)};b.cellRange=function(){return x.cellRange.apply(this,arguments)};b.rectRange=function(){return x.rectRange.apply(this,arguments)};b.updateViewSize=function(){t.dispatchResize()};var K=function(){if(c.deFeatures.fitpage){var a=90==d.rotation||270==d.rotation,b,e=f.padding();b=f.margin();var h=e.left+e.right+b.left+b.right,e=e.top+e.bottom+b.top+b.bottom;a?(a=
f.maxPageHeight(),b=f.maxPageWidth()):(a=f.maxPageWidth(),b=f.maxPageHeight());var g=c.viewNode;return{w:F((g.clientWidth-h)/a),h:F((g.clientHeight-e)/b)}}},I=function(a,e){!1!==a&&(a=!0);if(c.documentLoaded){var h;if(d.zoomMode){h=1;var g=K();if(g){switch(d.zoomMode){case "page":h=Math.min(g.w,g.h);break;case "pagewidth":h=g.w;break;case "pageheight":h=g.h;break;case "mobile":"worksheet"!==c.deType&&"database"!==c.deType&&(h=g.w)}h=F(h)}d.zoom=h}else if(c.nochrome||c.isMobile)if(g=K())h=Math.min(g.w,
g.h),d.zoom<h&&(d.zoom=h);h=d.zoom;var g=H!=h||M!=d.zoomMode,k=A!=d.rotation;if(a||g||k)f.layoutChanged(e),c.drawing&&c.drawing.update(!0);if(a||g)H=h,M=d.zoomMode,b.on.zoom.dispatch(h,d.zoomMode,E);if(a||k)A=d.rotation,b.on.rotate.dispatch(d.rotation);t.dispatchScroll(a)}},L=function(){I(!0)};b.dispatchPageEvents=I;b.resetIdleTimer=function(){if(b.on.idle.hasListeners()){if(r)k.clearInterval(r);else{var a=b.resetIdleTimer;g.listen("mousemove",a,!0);g.listen("touchmove",a,!0);g.listen("keydown",a,
!0)}r=k.setInterval(b.on.idle.dispatch,200,b.on.idle)}else r&&(k.clearInterval(r),r=null,a=b.resetIdleTimer,g.unlisten("mousemove",a),g.unlisten("touchmove",a),g.unlisten("keydown",a))};a.on("content","first",function(){w.on.change.disable();var a=w.firstPage();a?a.load(!0,!0,N):b.logFatalError(null,"Fatal error in view: Document data is corrupt")});var N=function(){w.moveto(w.firstPage().index);c.documentLoaded=!0;c.documentLoading=!0;b.on.load.dispatch();c.documentLoading=!1;w.on.change.enable();
w.dispatchChange(void 0,!0);I(!0);c.documentComplete&&b.on.done.dispatch()};b.installDocument=function(a,e){var d=!0,h=g.create("div");h.html(e);(h=h.byClass("oit-view-root"))&&0<h.length&&(h=h[0]);var f,l,q;h&&(f=h.data("icd"),l=h.data("json"),q=h.data("page"));if(!f&&!l||"none"==l)d="This document can't be loaded into the web view.",t.invalidArg("load","url",a,"none"==l?d+" \nThe html file must be created in Ajax mode.":d+" \nThe html file does not appear to have been created by Web View Export."),
d=!1;else{if(k.isRelativeURL(a)){var h=document.URL,u=h.indexOf("//");if(-1===u)c.URL=a;else{var u=u+2,n=h.lastIndexOf("/"),h=-1!=n&&n>u?h.substr(0,n+1):h+"/";"/"===a[0]&&(u=h.indexOf("/",u)+1,h=h.substr(0,u));c.URL=k.concatURL(h,a)}}else c.URL=a;p.initializeContent(l,f,q);b.initializeDocument()}return d};b.unload=function(){var a=c.documentLoaded;c.documentLoaded=!1;c.documentComplete=!1;n.reset();s.clear();k.abortTimers();e.abort();b.on.reset.dispatch();a&&b.on.unload.dispatch();d.zoom=1;d.zoomMode=
null;E=!1;r&&(k.clearInterval(r),r=null);C={};J={};c.documentLoading=!1;c.drawing&&(c.drawing.destroy(),c.drawing=void 0);z&&(z.destroy(),z=void 0);B&&(B.destroy(),B=void 0);(a=c.viewNode)&&a.html("");c.URL=document.URL};b.initializeDocument=function(){c.viewNode&&(c.drawing=new a.Drawing(c.viewNode),B=new a.DynamicStyleSheet("screen"),0<w.count()&&b.updateViewSize())};b.screenCSS=function(a,b){if(B)if(null==b)B.deleteRule(a);else if("string"==typeof b)B.setRule(a+"{"+b+"}",a);else if("object"==typeof b){var c=
a+"{",e;for(e in b)c+=e+":"+b[e]+";";B.setRule(c+"}",a)}};b.printCSS=function(b,c){z||(z=new a.DynamicStyleSheet("print"));if(null==c)z.deleteRule(b);else if("string"==typeof c)z.setRule(b+"{"+c+"}",b);else if("object"==typeof c){var e=b+"{",d;for(d in c)e+=d+":"+c[d]+";";z.setRule(e+"}",b)}};var P=function(){void 0===this.startACC&&("up"===this.direction?p.isPending()||(this.startACC=h.lastACC()):this.startACC=h.firstACC());var b;b=void 0!=this.startACC?h.find(this.startACC,this.searchTerm,this.caseSensitive,
this.direction):null;!b&&(p.isPending()||h.isPending())?(a.on("content","add",this,P),a.on("rawtext","add",this,P)):(b?this.callbackFn.call(null,b):this.callbackFn.call(null),a.off("content","add",P),a.off("rawtext","add",P))},O=function(b,c,e,d,f,g){b=!0;c=!1;void 0===this.startACC&&(this.startACC=h.firstACC());this.startIterationFn&&(e=100*this.startACC/h.lastACC(),this.startIterationFn(e));for(d=0;100>d;d++)if(e=null,void 0!=this.startACC&&(e=h.find(this.startACC,this.searchTerm,this.caseSensitive)),
e){if(!1===this.callbackFn.call(null,e)){b=!1;c=!0;break}this.startACC=e.acc+1}else{!p.isPending()&&!h.isPending()&&(this.callbackFn.call(null),c=!0);b=!1;break}if(b)k.setTimeout(O,50,this);else if(c)a.off("content","add",O),a.off("rawtext","add",O);else if(p.isPending()||h.isPending())h.isPending()&&h.find(this.startACC,this.searchTerm,this.caseSensitive),a.on("content","add",this,O),a.on("rawtext","add",this,O);this.endIterationFn&&this.endIterationFn()},Q=function(){for(var b=!0,c=!1,e=0;10>e;e++){var d=
h.getRawTextBlock(this.textBlockIndex);if(d)if(d.text){if(!1===this.callbackFn.call(null,d.text,d.range.acc)){b=!1;c=!0;break}this.textBlockIndex++}else{b=!1;break}else{p.isPending()||(this.callbackFn.call(null),c=!0);b=!1;break}}b?k.setTimeout(Q,50,this):c?(a.off("content","add",Q),a.off("rawtext","add",Q)):(a.on("content","add",this,Q),a.on("rawtext","add",this,Q))};b.removeExtraEmailHeaders=function(){d.removeExtraEmailHeaders=!0};a.on("content","data",function(b,c,e){if(b.properties)for(var d in b.properties)C[d]=
b.properties[d];if(b.external)for(d in b.external)J[d]=b.external[d];if(b.options)for(var h in b.options)if(c=b.options[h],e=h.indexOf("."),0<e&&(d=h.substring(0,e),h=h.substring(e+1),"glob"==d||"opt"==d))e=a[d],e.hasOwnProperty(h)&&(e[h]=c)});a.on("content","add",function(){var a=f.pageRect(w.count()-1,"overlay");a&&(a=a.bottom-20*(w.count()-1),b.printCSS(".oit-view-root","height:"+a+"px;"))});a.on("content","last",function(){c.documentComplete=!0;c.documentLoaded&&b.on.done.dispatch()});a.on("view",
"resize",function(){c.editingComment?s.alignComment():I(!0)});a.on("pages","change",function(){(1==w.activeOverlay().length||"vertical"!=d.scrollMode)&&I(!0)});d.oncenterPages(L);d.onrotation(L)}});OIT.extend("mod","pages",{exports:"count current info moveto movetoNext movetoPrev pageName ranges".split(" "),events:{change:{pub:!0,detail:function(a){return this.pages.info(a.index)}},add:{pub:!0,detail:function(a){return{startPage:a}}},pageload:{},pageunload:{}},install:function(a,b){var d=a.opt,c=a.glob,g=a.doc,f=a.util,k=a.range,m=a.content,h=a.display,p=a.dialog,l=a.selection,n=a.highlights,x=a.math,s=OIT.local,w=[],t=[],e=null,q=null,y=null,v=0,D=1,u,E,r,z=0,B=0,C,J,H,M={},A={};b.firstPage=
function(){for(var a in t)return t[a]};b.current=function(){return!q?0:q.index};b.pageName=function(a){void 0===a&&(a=b.current());if(a=t[a])return a.name};b.count=function(){return t.length};b.each=function(a,b){f.eachArgs(t,arguments)};b.moveto=function(a,c){var e;f.isFunction(c)&&(e={callbackFn:c});return b.movetoEx(a,e)};var F=function(a){b.updateActivePage(a.pageIndex);a.callbackFn&&a.callbackFn.call(null,q.index)};b.movetoEx=function(a,e){e=e||{};c.viewNode.cancelKinetic();if("number"===typeof a)return e.pageIndex=
a,I(e);if("object"===typeof a){if(g.isElement(a)||g.isText(a)){e.gotoNode=a;var d=e,h=b.forNode(d.gotoNode);h?(d.pageIndex=P(h.index),d.pageIndex!=h.index&&(d.gotoNode=null),I(d)):(b.logError("moveto","The specified node was not found on any page in the document."),F(d));return q.index}if(d=k.validateRange(a))return e.range=k.clone(d),L(e);if("number"===typeof a.left&&"number"===typeof a.top&&"number"===typeof a.right&&"number"===typeof a.bottom)return e.rect=a,N(e)}b.logError("moveto","Invalid destination: "+
f.stringify(a));return q.index};var K=function(a,d){var f=a.overlay,g=f!==e;if(!d&&!g)return!1;if(g){n.deactivate();l.select(null);h.unloadDisplay();var k=e,u=c.viewNode;k&&(k.saveScroll=u.scroll(),k.hide());f.show()}a.isLoaded()&&(e=f,b.updateActivePage(a.index),h.loadDisplay(a));f.hasClass("oit-pagestream")?c.viewNode.addClass("oit-pagestream"):c.viewNode.removeClass("oit-pagestream");f.saveScroll?(u.scroll(f.saveScroll),delete f.saveScroll):g&&u.scroll(0,0);b.updateActivePage();return!0},I=function(a){var f=
a.pageIndex;if(t[f])if(a.force||a.gotoNode||!q||f!=q.index){var g=t[f];Q(f);if(g.isPending())g.load(!0,!0,function(){a.force=!0;I(a)}),"email"!==g.type&&g.overlay===e?h.moveto(g.index,null,{animate:!1}):e||K(g);else{f=K(g,a.force);if("vertical"!=d.scrollMode||f)a.animate=!1;b.updateActivePage(g.index);("email"===g.type||!h.moveto(q.index,F,a))&&F(a)}}else F(a);else 0<=f&&m.isPending()?(p.showMessage(s.PLEASE_WAIT_DOWNLOADING),m.on.add.listenOnce(function(){p.hideMessage();I(a)})):(b.logError("moveto",
"Invalid page index: "+f),void 0!==c.singlePageIndex&&(a.pageIndex=c.singlePageIndex),F(a));if(q)return q.index},L=function(a){if(c.documentLoading)f.setTimeout(L,0,null,a);else{var e=b.nearestForRange(a.range);if(e)if(e.isPending())K(e),e.load(!0,!0,function(){L(a)});else if(!q||e.overlay!==q.overlay||"vertical"!=d.scrollMode&&e!==q)I({pageIndex:e.index,callbackFn:function(){L(a)}});else{if(!h.moveto(a.range,F,a)){var g=h.rangeRect(a.range,"view");g&&void 0===a.range.bSlideNote?(a.rect=g,N(a)):(a.pageIndex=
e.index,I(a))}}else m.isPending()?(p.showMessage(s.PLEASE_WAIT_DOWNLOADING),m.on.add.listenOnce(function(){p.hideMessage();L(a)})):(b.logError("moveto","The specified range was not found in the document: "+f.stringify(a.range)),F(a))}return q.index},N=function(b){var e=b.rect,d=c.viewNode,h=d.scroll(),f=e.left+h.left,g=e.right+h.left,k=e.top+h.top,l=e.bottom+h.top,u=h.left,n=h.left+d.clientWidth,r=h.top,p=h.top+d.clientHeight,e=h.left,t=h.top;!0===b.moveToTop?t=k:k<r?(l-=d.clientHeight,0>l&&(l=0),
t=k-20,t<l&&(t=l)):l>p&&(t=l+20-d.clientHeight,t>k&&(t=k));f<u?(g=f-d.clientWidth,0>g&&(g=0),e=f-20,e<g&&(e=g)):g>n&&(e=g+20-d.clientWidth,e>f&&(e=f));e!=h.left||t!=h.top?(a.disableEvent("document","scrollupdate"),h=c.deType,h=!b.moveToTop&&"worksheet"!=h&&"database"!=h?150:0,d.abortAnimation(),d.animate({scrollLeft:e,scrollTop:t,time:h,endFn:function(){a.enableEvent("document","scrollupdate");a.dispatch("document","scrollupdate");F(b)}})):F(b);return q.index};b.movetoPrev=function(a){var c=b.prev();
c&&b.moveto(c.index,a);return q.index};b.movetoNext=function(a){var c=b.next();c&&b.moveto(c.index,a);return q.index};b.info=function(a){void 0===a&&(a=b.current());if(t[a])return t[a].info()};b.next=function(a){void 0===a&&(a=q.index);a+=1;if(t[a]){if("slideshow"!=d.presentationMode)return t[a];for(;a<t.length;a++){var b=t[a];if(b&&b.isEnabled())return b}}};b.prev=function(a){void 0===a&&(a=q.index);a-=1;if(t[a]){if("slideshow"!=d.presentationMode)return t[a];for(;0<=a;a--){var b=t[a];if(b&&b.isEnabled())return b}}};
var P=function(a){if("slideshow"!=d.presentationMode||"slide"!=t[a].type)return a;for(var b=a;b<t.length;b++)if(t[b]&&t[b].isEnabled())return b;for(b=a;0<b;b--)if(t[b]&&t[b].isEnabled())return b;return 0};b.loadNextPageFromServer=function(){var a,c=b.top(),d=b.bottom();0>D?(c-=3,d+=1):d+=3;0>c&&(c=0);d>=t.length&&(d=t.length-1);if(0>D){if(void 0===u||u>d)u=d;for(;u>=c;u--){var h=t[u];if(h&&h.overlay===e&&h.isPending()){h.load(!0,!1);a=u--;break}}}else{if(void 0===u||u<c)u=c;for(;u<=d;u++)if((h=t[u])&&
h.overlay===e&&h.isPending()){h.load(!0,!1);a=u++;break}}return a};b.updateActivePage=function(a){if(e){var f=q,g=c.viewNode.scroll().top;if(void 0!==a)f=b.page(a)||q;else if(1==e.length)f=e.firstPage;else if("vertical"==d.scrollMode&&void 0===c.singlePageIndex&&g!=v&&(a=b.mapToPage(10,20)))f=a.page;g!=v&&(D=g<v?-1:1,v=g);if(f!=q&&!0!=f.bNotesBar){q=f;e=q.overlay;g=h.topPageIndex();for(f=h.bottomPageIndex();g<=f;g++)Q(g);b.dispatchChange(q)}}};b.page=function(a){return t[a]};b.byName=function(a){for(var b in t)if(t[b].name===
a)return t[b]};b.forNode=function(a){return g.wrap(a).ancestorData("page")};b.nearestForRange=function(a){var c,e=b.pagesForRange(a);if(!e&&"text"===a.type)for(var d=0;d<t.length;d++){var f=t[d];if(f&&"drawing"===f.type&&a.accend>=f.acc&&a.acc<=f.accend){e=[f];break}}if(e)if(1==e.length)e[0].isEnabled()&&(c=e[0]);else for(var g=b.top(),k=b.bottom(),l,d=0;d<e.length;d++)if(f=e[d],f.isEnabled()){var u=f.index,q=0;u<g?q=g-u:u>k&&(q=u-k);if(!c||q<l)c=f,l=q;else if(0==q&&(u=h.rangeRect(a,c))&&0>u.bottom)c=
f,l=q}return c};b.forRange=function(a,b,c){b=b||0;!0!==c&&(c=!1);switch(a.type){case "text":for(;b<t.length;b++){var e=t[b];if(e&&a.accend>=e.acc&&a.acc<=e.accend){if(!0===c&&("worksheet"===e.type||"database"===e.type||"email"===e.type))e.isLoaded()||e.load(!1);if(e.containsRange(a))return e}}break;case "cell":case "rect":if(a.page>=b&&a.page<t.length)return t[a.page]}};b.pagesForRange=function(a,c){for(var e,d=0;d<t.length;){d=b.forRange(a,d,c);if(!d)break;e||(e=[]);e.push(d);d=d.index+1}return e};
b.top=function(){return h.topPageIndex()};b.bottom=function(){return h.bottomPageIndex()};b.mapToPage=function(a,h,f,g){var k;if(f)k=f.pageRect("view");else if(!0==d.showSlideNotes&&r&&r.inRect(a,h))f=r;else if(q){f=q;var l=!0;!0!==g&&"email"==f.type&&(l=!1,0==f.index&&(f=2<=t.length?t[1]:null));f&&(k=f.pageRect("view"));if("vertical"==d.scrollMode&&void 0===c.singlePageIndex&&1<e.length)for(;k;)if(h<k.top){g=b.prev(f.index)||f;if(0==f.index||!l&&0==g.index)break;if(g.overlay!=f.overlay)break;var u=
g.pageRect("view");if(h>u.bottom){k.top-h>h-u.bottom&&(f=g);break}f=g;k=u}else if(h>k.bottom){if(f.index==t.length-1)break;g=b.next(f.index)||f;if(g.overlay!=f.overlay)break;u=g.pageRect("view");if(h<u.top){u.top-h<h-k.bottom&&(f=g);break}f=g;k=u}else break}if(f){k&&(a-=k.left,h-=k.top);c.deFeatures.zoom&&(k=d.zoom,1!=k&&(a=x.round(a/k),h=x.round(h/k)));if(c.deFeatures.rotate&&(l=d.rotation,0!=l))switch(k=f.pageRect(),g=a,u=h,l){case 90:a=k.width-u;h=g;break;case 180:a=k.width-g;h=k.height-u;break;
case 270:a=u,h=k.height-g}return{page:f,x:a,y:h}}};b.elementRect=function(b,e){var d=new a.Rectangle(b.rect(c.viewNode),"view");d.origin=e;return d};b.findTextRange=function(a){if("text"===a.type){var b;if("vertical"!=d.scrollMode||void 0!==c.singlePageIndex)void 0!==q.acc&&(a.acc<=q.accend&&a.accend>=q.acc)&&(b=q.findTextRange(a));else for(var h in t){var f=t[h];if(f.overlay===e&&(f.isLoaded()&&f.isEnabled()&&void 0!==f.acc&&a.acc<=f.accend&&a.accend>=f.acc)&&(f=f.findTextRange(a)))if(b)for(var g=
0;g<f.length;g++)b.push(f[g]);else b=f}return b}};b.isDocumentText=function(a,c){return b.forRange(k.textRange(a,c),0,!0)?!0:!1};b.maxWidth=function(){if(e)return"vertical"!=d.scrollMode||void 0!==c.singlePageIndex?q.width:e.maxWidth};b.maxHeight=function(){if(e)return"vertical"!=d.scrollMode||void 0!==c.singlePageIndex?q.height:e.maxHeight};b.decomposeRange=function(a,b){var c;if(void 0!==a.page){var e=t[a.page];if(e){if("rect"===a.type)c=e.mapRectRangeToText(a);else if("cell"===a.type){var d=e.spreadsheetModel();
d&&(c=d.decomposeRange(a,b))}(e=e.mapRangeToEmbeds(a))&&(c=c?c.concat(e):e)}}return c};b.ranges=function(a){var c={};void 0===a&&(a=b.current());if(t[a]&&(a=t[a].textRanges())&&0<a.length)c.text=a;return c};b.notesBar=function(){return r};var O=function(){if(c.dynamicContent){switch(d.memoryModel){case "none":B=0;break;case "large":B=5242880;break;case "small":B=1048576;break;case "micro":B=524288;break;default:B=c.isMobile?1048576:5242880}b.applyMemoryLimit()}else B=0};b.applyMemoryLimit=function(a){void 0!==
a&&(z+=a,b.logMemory&&b.logMemory(z,B));if(0<B&&z>B){if(C){var c=C;a=b.top();for(var e=b.bottom();c;){var d=c.nextNewer;if(0<c.loadedSize&&!c.locked&&(c.index<a||c.index>e))if(z-=c.loadedSize,c.unload(),z<=B)break;c=d}}b.logMemory&&b.logMemory(z,B)}};var Q=function(a){if((a=t[a])&&a!=J)void 0===J?C=a:(a==C&&(C=a.nextNewer),a.nextNewer&&(a.nextNewer.nextOlder=a.nextOlder),a.nextOlder&&(a.nextOlder.nextNewer=a.nextNewer),J.nextNewer=a,a.nextOlder=J,a.nextNewer=void 0),J=a},W=function(){var d=b.firstPage(),
d=d&&d.isSpreadsheet();if(void 0===c.singlePageIndex&&(d||1<w.length)){E||(E=new a.TabBar,E.addPrevNext(b.movetoPrev,b.movetoNext));for(d=E.length();d<w.length;d++){var h=w[d],f=h.firstPage;if(!f)break;E.addTab(h.name,b.moveto,f.index)}E.show();e&&E.setActiveTab(e.index)}else E&&(E.destroy(),E=null)};b.dispatchChange=function(a,c){a||(a=q);if(a==y&&!c)return!0;y=a;E&&E.setActiveTab(a.overlay.index);if(r){var e=r.getPageNumber();-1!=e&&r.removeHighlightsFromPage(e);(e=a.byClass("oit-slidenote"))?(e=
e[0].html(),r.setContents(e),r.setPageNumber(a.index),r.addHighlightsToPage(a.index)):(r.setContents(""),r.setPageNumber(-1))}return b.on.change.dispatch(a)};b.overlayById=function(a){return f.byProperty(w,"id",a)};b.pageById=function(a){return f.byProperty(t,"id",a)};b.activeOverlay=function(){return e};b.activePage=function(){return q};var G=function(){W();v=void 0};d.onmemoryModel(O);d.onnochrome(G);d.onscrollMode(function(){v=void 0});d.onshowSlideNotes(function(b){if(void 0!==b)if(!r&&!0==b){if(q&&
"slide"==q.type&&(r=new a.NotesBar)){if(b=q.byClass("oit-slidenote"))b=b[0].html(),r.setContents(b),r.setPageNumber(q.index);r.show()}}else!0==b?r.show():r&&((b=l.textSelection())&&!0==b.bSlideNote&&l.select(null,null),r.hide())});a.on("document","reset",function(){for(var a in t){var b=t[a],c=b;z-=c.loadedSize;c.unload();b.destroy()}t=[];f.each(w,"destroy");w=[];y=q=e=null;v=0;D=1;E&&(E.destroy(),E=null);r&&(r.destroy(),r=null);H&&(H.destroy(),H=void 0,M={},A={});B=z=0;J=C=u=void 0});a.on("content",
"data",function(e,h,f){var g;if(f=e.style){H||(H=new a.DynamicStyleSheet);var k=[],u=[];for(h=0;h<f.length;h++){var l=f[h];if("string"===typeof l)u.push(l);else if(l.s&&l.p){var q=l.s,l=l.p;"@font-face"===q?M.hasOwnProperty(l)||(M[l]=!0,k.push(q,"{",l,"}")):A.hasOwnProperty(q)||(A[q]=!0,u.push(q,"{",l,"}"))}}0<k.length&&H.addCSSText(k.join(""));0<u.length&&H.addCSSText(u.join(""))}if(e.overlays)for(h=0;h<e.overlays.length;h++)f=e.overlays[h],b.overlayById(f.oid)||w.push(new a.Overlay(w.length,f));
if(e.pages){g=t.length;for(h=0;h<e.pages.length;h++){f=e.pages[h];k=null;"email"===f.type&&(c.singlePageIndex=void 0);if(void 0!==f.index){if(u=parseInt(f.index),void 0===c.singlePageIndex||c.singlePageIndex===u)t[u]||(t[u]=new a.Page(u,f.type,f.id)),k=t[u]}else k=new a.Page(t.length,f.type,f.id),t.push(k);k&&k.processData(f)}b.applyMemoryLimit()}W();(e=b.firstPage())&&"slide"==e.type&&!0==d.showSlideNotes?r||(r=new a.NotesBar):r&&(r.destroy(),r=null);void 0!==g&&t.length>g&&b.on.add.dispatch(g)});
a.on("content","add",b.updateActivePage);a.on("document","scrollupdate",b.updateActivePage);a.on("document","load",function(){O();G()});a.on("user","endscroll",b.updateActivePage)}});OIT.extend("mod","highlights",{exports:"activate active add addNote addStamp apply autoHighlight autoHighlightOptions clear comment current deactivate defineStamp first getJSON hide hideComment isHidden label last moveto movetoNext movetoPrev next prev properties property range redact remove serialize setOptions show showComment style type validateStyles".split(" "),events:{activate:{pub:!0,detail:function(a,b,d){return{highlightid:a?a.id:void 0,before:b,after:d}}},add:{pub:!0,detail:function(a){return{highlightid:a.id}}},
remove:{pub:!0,detail:function(a){return{highlightid:a.id}}},move:{pub:!0,detail:function(a){return{highlightid:a.id}}},comment:{pub:!0,detail:function(a){return{highlightid:a.id}}},mode:{pub:!0,detail:function(a){return{autohighlight:a,autooptions:this.highlights.autoHighlightOptions(),selectionmode:this.document.selectionMode()}}}},userEventDef:{pub:!0,detail:function(a,b,d){return{highlightid:d.id,srcEvent:b}}},install:function(a,b){var d=a.opt,c=a.glob,g=a.doc,f=a.util,k=a.range,m=a.display,h=
a.document,p=a.css,l=a.selection,n=a.pages,x={},s=function(a){var b=a.toLowerCase();x[a]={w:"border"+a+"Width",c:"border"+a+"Color",wp:"border-"+b+"-width",cp:"border-"+b+"-color",sp:"border-"+b+"-style"}};s("Top");s("Right");s("Bottom");s("Left");var w=!1,t=[],e=0,q,y,v,D,u=-1,E=-1,r,z,B,C=!1,J=!1,H=!1,M,A={comment:null,label:null,sticky:!1,style:null,stamp:null,properties:null,enableUserDelete:!0,enableUserComment:!0,enableUserResize:!0,enableUserMove:!0},F=!0,K=[],I,L={x:0,y:0},N=[];b.add=function(){var a=
arguments,b=1,c={};oa(0,a,c,"add");c.invalid||(b=ea(b,a,c,"add"));c.invalid||(f.isDOMRange(c.range)||f.isDOMSelection(c.range)?c.type="hl-text":c.type="hl-"+c.range.type,ma(0,a,c,"add"));c.invalid||(b=ga(b,a,c,"properties","add"),b=la(b,a,c,"comment","add"));c.invalid||pa(b,a,c,"add");if(!c.invalid)return da(c)};b.addNote=function(){var a=arguments,c=1,e={type:"note"};oa(0,a,e,"addNote");e.invalid||(c=ea(c,a,e,"addNote"));e.invalid||("cell"!==e.range.type&&"rect"!==e.range.type&&(b.invalidArg("addNote",
"range",e.range,"Anchored notes may only be added to rect or cell ranges"),e.invalid=!0),ma(0,a,e,"addNote"));e.invalid||(c=ga(c,a,e,"properties","addNote"),c=la(c,a,e,"comment","addNote"));e.invalid||pa(c,a,e,"addNote");if(!e.invalid)return da(e)};b.redact=function(){var a,b=arguments,c={type:"redaction"};a=ea(0,b,c,"redact");c.invalid||(a=ga(a,b,c,"properties","redact"),a=la(a,b,c,"label","redact"));c.invalid||pa(a,b,c,"redact");if(!c.invalid){if("compound"===d.redactionMode||"hybrid"===d.redactionMode&&
"cell"===c.range.type)c.compound=!0;a:{a=c;b=!1;a.range.embedId?b=!1:"hybrid"===d.redactionMode?b="rect"===a.range.type:"simple"===d.redactionMode&&(b="rect"===a.range.type||"cell"===a.range.type);if(b){var e=n.decomposeRange(a.range);if(e){var b=[],c=a.range,h=n.page(c.page),f=m.rangeRect(c,h),g=a.activate;a.activate=!1;for(var k=0;k<e.length;k++)a.range=e[k],b.push(ja(a));if("drawing"===h.type||"slide"===h.type||"chart"===h.type){e=0===b.length;if(!e)for(k=0;k<b.length;k++){var l=t[b[k]].range;
if("rect"!==l.type){e=!0;break}else if(l=m.rangeRect(l,h),!l||!l.equals(f)){e=!0;break}}e&&(a.range=c,b.unshift(ja(a)))}if(0<b.length){g&&Y(b[0]);1==b.length&&(b=b[0]);a=b;break a}}}a=da(a)}return a}};b.apply=function(a,e){if(!Array.isArray(a)){try{a=JSON.parse(a)}catch(d){b.invalidArg("apply","highlights",a,"Error parsing JSON string: "+d.message);return}a.range&&"object"==typeof a.range&&(a=[a])}if(Array.isArray(a))if(c.documentLoaded){e=f.isFunction(e);for(var h=0;h<a.length;h++){var g=a[h];if("sdef"==
g.type)b.defineStamp(g.stamp,g.url);else{var l=na();if(null==e||e(l,g.properties))if(k.validateRange(g.range))if(l=[],"stamp"==g.type){var u={name:g.stamp};g.opacity&&(u.opacity=g.opacity);g.sizing&&(u.sizing=g.sizing);l.push(u);l.push(g.range);g.hasOwnProperty("properties")&&l.push(g.properties);g.hasOwnProperty("comment")&&l.push(g.comment);b.addStamp.apply(void 0,l)}else da(g);else b.invalidArg("apply","highlight["+h+"]",g)}}}else q=q?a.concat(q):a};b.remove=function(a,b){var c=V(a,r,"remove");
c&&P(c,b)};var P=function(a,c){var d=a.id;void 0===c&&(c=!0);b.on.remove.dispatch(a);var h,f=!1,g=!1;d==r?(Y(void 0,!1,!1,c),r=void 0,void 0!=a.prevId?(h=a.prevId,g=!0):void 0!=a.nextId&&(h=a.nextId,f=!0)):c=!1;b.hideComment(d);b.unmap(a);a.destroy();t[d]=null;d<e&&(e=d);void 0!==h&&Y(h,f,g,c,!1,!1)};b.removeFromRange=function(a){Array.isArray(a)?f.each(a,b.removeFromRange):"text"===a.type&&b.each(O,null,a)};var O=function(a,c){var e=a.range;"text"===e.type&&e.accend>=c.acc&&e.acc<=c.accend&&b.remove(a.id,
!1)};b.clear=function(a){a=f.isFunction(a);b.each(P,a,!1);a||(r=void 0,t=[],e=0,N=[])};s=function(){var a=d.highlightLabelFontFamily,c=d.highlightLabelFontSize,e="";a&&(e+="font-family:"+a+";");c&&(e+="font-size:"+c+";");h.screenCSS(".oit-highlight-label",e);b.each("showLabel",null,d.showHighlightLabels)};b.setOptions=function(a,b){b&&ba(a,r,"setOptions",null,[b])};b.getOption=function(a,b){return ba(a,r,"getOption",null,[b])};b.style=function(a,c){var e=V(a,r,"style");if(e){if(!c)return e.style();
var d=ha(c,"hl-text"!=e.type);if(d)return e.style(d);b.invalidArg("style","style",c)}};b.comment=function(a,c,e){if(a=V(a,r,"comment")){var d=a.comment();void 0!==c&&c!==d&&(!e&&a.id===b.active()&&!a.isNote()?(b.hideComment(),d=a.comment(c),b.showComment()):d=a.comment(c),b.on.comment.dispatch(a));return d}};var Q=function(a){if("scale"==a||"stretch"==a||"image"==a)return a},W=function(a){if(a&&!isNaN(a)&&(a=Number(a),0<=a&&1>=a))return a},G=function(a){if(a&&!isNaN(a.x)&&!isNaN(a.y))return{x:Math.round(a.x),
y:Math.round(a.y)}},S=function(a){a.img=new Image;a.img.src=a.url;a.img.onload=function(){a.height=this.height;a.width=this.width;a.defaultSize&&(this.style.width=a.defaultSize.x,this.style.height=a.defaultSize.y);delete a.img}};b.stamp=function(a){if(D)return D[a]};b.label=function(a,b){return ba(a,r,"label",null,[b])};b.defineStamp=function(a,b,c){D||(D={});b?(c=c||{},b={url:b},c.sizing&&(b.sizing=Q(c.sizing)),c.opacity&&(b.opacity=W(c.opacity)),c.defaultSize&&(b.defaultSize=G(c.defaultSize)),D[a]=
b,S(D[a])):delete D[a]};var R=function(a){if(a){var b;if(a instanceof String||"string"==typeof a)b={name:a};else{b={};for(var c in a)b[c]=a[c]}if(b.name&&D&&D[b.name])return b.type="stamp",b.stamp=D[b.name],b}};b.addStamp=function(){var a=arguments,c=R(a[0]);if(c){c.sizing=Q(c.sizing)||c.stamp.sizing||"scale";c.opacity=W(c.opacity)||c.stamp.opacity||1;c.defaultSize=G(c.defaultSize)||c.stamp.defaultSize;var e;e=ea(1,a,c,"addStamp");var d=c.range;d&&"rect"!=d.type&&"cell"!=d.type?(b.invalidArg("addStamp",
"range",d),c.invalid=!0):"rect"===d.type&&k.isEmpty(d)?c.range=fa(d.left,d.top,"rect",c):"cell"===d.type&&(d.c1==d.c2&&d.r1==d.r2)&&(c.range=fa(d.c1,d.r1,"cell",c));c.invalid||(e=ga(e,a,c,"properties","addStamp"),e=la(e,a,c,"comment","addStamp"));pa(e,a,c,"addStamp");if(!c.invalid)return da(c)}else b.invalidArg("addStamp","stamp",a[0],"Must be the name of a defined stamp")};b.getJSON=function(a){if(a=V(a,r,"getJSON"))return JSON.stringify(a.serialize())};b.serialize=function(a){var c=[],e,d;f.isFunction(a)?
e=a:Array.isArray(a)?d=a:"number"===typeof a&&(d=[a]);b.each(U,e,c,{},d);return JSON.stringify(c,null,!1)};var U=function(a,b,c,e){if(!e||-1!=e.indexOf(a.id))a=a.serialize(),a.stamp&&!c[a.stamp]&&(b.push({type:"sdef",stamp:a.stamp,url:D[a.stamp].url}),c[a.stamp]=!0),b.push(a)};b.properties=function(a,b){return ba(a,r,"properties",null,[b])};b.property=function(a,b,c){return ba(a,r,"property",null,[b,c])};b.current=function(){return r};b.active=function(){if(!C&&!J)return r};b.moveto=function(a){(a=
V(a,r,"moveto"))&&Y(a.id,!1,!1,!0,!0,!0);return r};b.movetoNext=function(a){if(void 0===r)void 0!==y&&b.moveto(y);else{var c=r;if(C&&t[c].filter(a)&&ca(c))return b.moveto(c);for(;;){c=t[c].nextId;if(void 0===c)break;var e=t[c];if(e.filter(a)&&(e=n.nearestForRange(e.range)))return e.isLoaded()?Y(c):n.moveto(e.index,function(){b.movetoNext(a)}),c}}return r};b.movetoPrev=function(a){if(void 0===r)void 0!==v&&b.moveto(v);else{var c=r;if(J&&t[c].filter(a)&&ca(c))return b.moveto(c);for(;;){c=t[c].prevId;
if(void 0===c)break;var e=t[c];if(e.filter(a)&&(e=n.nearestForRange(e.range)))return e.isLoaded()?Y(c):n.moveto(e.index,function(){b.movetoPrev(a)}),c}}return r};b.type=function(a){if(a=V(a,r,"type"))switch(a.type){case "note":case "redaction":case "stamp":return a.type;default:return"highlight"}};b.range=function(a){if(a=V(a,r,"range"))return a.range};b.show=function(a){void 0===a||f.isFunction(a)?b.each("show",a):ba(a,r,"show")};b.hide=function(a){void 0===a||f.isFunction(a)?b.each("hide",a):ba(a,
r,"hide");b.alignHighlight()};b.isHidden=function(a){return ba(a,r,"isHidden")};b.showComment=function(a,c){Array.isArray(a)&&(a=a[0]);var e=V(a,r,"showComment");if(e){c=c||{};c.mode||(c.mode="view");var d=b.active();if(void 0!==d&&(d=t[d],d.isNote()&&d.isEditing()))return;if(e.isNote())switch(c.mode){case "view":e.show();e.endEditText(!0);break;case "edit":e.beginEditText(!1);break;case "new":e.beginEditText(!0)}else e.dialog(c.mode)}};b.hideComment=function(a){(a=V(a,r,"hideComment"))&&(a.isNote()?
a.collapse():a.hideDialog())};var T=function(a){(a=V(a))&&a.loadPage()};b.first=function(){T(y);return y};b.last=function(){T(v);return v};b.next=function(a){if(a=V(a,r,"next"))return T(a.nextId),a.nextId};b.prev=function(a){if(a=V(a,r,"prev"))return T(a.prevId),a.prevId};b.activate=function(a){(a=V(a,r,"activate"))&&Y(a.id)};b.deactivate=function(){Y(void 0,!1,!1,!0)};var X=function(a){if(a)for(var c in A)void 0!==a[c]&&(A[c]=a[c]);l.enableCellOffsets("note"===H||"stamp"===H);Z();b.on.mode.dispatch(H)};
b.autoHighlightOptions=function(a){void 0!==a&&X(a);a={};for(var b in A)a[b]=A[b];return a};b.autoHighlight=function(a,e){if(!1===a){l.select(null);if(M){var d=c.deFeatures;switch(M){case "text":d.textselection||(M=null);break;case "rect":d.rectselection||(M=null);break;case "cell":d.cellselection||(M=null);break;default:M=null}M&&(h.selectionMode(M),M=null)}H=!1;X()}else if("selection"===a||"note"===a||"redaction"===a||"stamp"===a){e=e||{};A.comment=null;A.sticky=!1;A.properties=null;l.select(null);
if("stamp"===a){if(!R(e.stamp))return b.invalidArg("autoHighlight","options.stamp",e.stamp),H=!1}else if(("selection"===a||"note"===a)&&!ha(e.style,!0))return b.invalidArg("autoHighlight","options.style",e.style),H=!1;M||(M=h.selectionMode());if("note"===a||"redaction"===a||"stamp"===a)d=c.deFeatures,d.rectselection?h.selectionMode("rect"):d.cellselection&&h.selectionMode("cell");H=a;X(e)}return H};b.beginBatch=function(){w=!0};b.endBatch=function(){w&&(w=!1,aa(u,E))};var Z=function(){if("selection"===
H||"note"===H)l.style(A.style,!1);else if("redaction"===H){var a;d.redactionFillColor&&"compound"===d.redactionMode&&"rect"===h.selectionMode()?a=d.redactionFillColor:(a=p.stringToColor(d.redactionColor),0.7<a.a&&(a.a=0.7),a=p.colorToString(a.r,a.g,a.b,a.a));l.style("background-color:"+a+";",!1)}else if("stamp"===H)if(D&&(a=D[A.stamp]),a){var b="background:url("+a.url+") no-repeat";"number"===typeof a.opacity&&1!=a.opacity&&(b+=";opacity:"+a.opacity);"scale"==a.sizing?b+=";background-size:contain":
"stretch"==a.sizing&&(b+=";background-size:100% 100%");l.style(b)}else l.style(null);else l.style(null)},fa=function(a,b,c,e){var d,h;e&&(e.defaultSize&&(d=e.defaultSize.x,h=e.defaultSize.y),d||(d=e.width),h||(h=e.height));d||(d=200);h||(h=200);a=n.mapToPage(a,b);e&&(a.x-=Math.floor(d/2),a.y-=Math.floor(h/2));return m.rangeFromRect(a.page.index,a.x,a.y,a.x+d,a.y+h,a.page,"move")},ca=function(a){return"slideshow"!=d.presentationMode?!0:(a=k.validateRange(t[a].range))&&n.nearestForRange(a)?!0:!1};b.startSelection=
function(){B=b.active();Y(void 0,!1,!1,!1)};b.endSelection=function(){B=void 0};a.on("document","select",function(a,e,d,h,f){var g=!0;if(a&&H){var k=a,u="note"===H,q="stamp"===H;if(u&&!c.deFeatures.anchorednotes||(u||q)&&"text"===k.type&&!h)return!0;a=u||!0===A.comment;if(h)if((u||q)&&d&&void 0===B){var n;q&&((e=R(A.stamp))?n=e.stamp:k=null);k&&(e=c.deFeatures,k=e.rectselection?fa(d.x,d.y,"rect",n):e.cellselection?fa(d.x,d.y,"cell",n):null);k||l.select(null)}else l.select(null),k=null;else u&&(e&&
d)&&"rect"===k.type&&(n=k.bottom-k.top,100>k.right-k.left&&(e.x<d.x?k.right=k.left+100:k.left=k.right-100),80>n&&(e.y<d.y?k.bottom=k.top+80:k.top=k.bottom-80));if(k&&void 0===f){var r;"text"===k.type&&(k=document.getSelection());"redaction"===H?r=b.redact(k,A.properties,A.label):q?R(A.stamp)&&("rect"===k.type||"cell"===k.type)?r=b.addStamp(A.stamp,k,A.properties):l.select(null):u?"rect"===k.type||"cell"===k.type?r=b.addNote(A.style,k,A.properties):l.select(null):r=b.add(A.style,k,A.properties);if(void 0!==
r){d=Array.isArray(r)?r:[r];f="string"===typeof A.comment?A.comment:void 0;for(g=0;g<d.length;g++)r=t[d[g]],r.setOptions(A),f&&r.comment(f);l.select(null);b.activate(d[0]);a&&b.showComment(d,{mode:"new"});g=!1;A.sticky||b.autoHighlight(!1)}}}return g});b.alignComment=function(){b.each("alignDialog")};a.on("display","displayload",function(a,c){u=a.index;E=c.index;b.each("addToPage",null,u);E>u&&aa(u+1,E)});a.on("display","displayunload",function(a,c){b.each("destroyDialog");E=u=-1});a.on("pages","pageload",
function(a){-1!=E&&a.index>E&&(E=n.activeOverlay().lastPage.index);0<t.length&&(a.index>=u&&a.index<=E)&&b.each("addToPage",null,a.index)});a.on("pages","pageunload",function(a){a.index>=u&&a.index<=E&&(b.each("removeFromPage",null,a.index),a.highlightLayer=void 0)});b.onEmailTabActivate=function(){b.each("addToPage",null,0);b.positionAll()};b.alignHighlight=function(){void 0!=r&&(!C&&!J)&&Y(r,!1,!1,!1,!1,!0)};b.move=function(a,b,c,e,d,h){b=b||0;e=e||0;c=c||0;d=d||0;h=h||!1;if((a=V(a))&&(b||e||c||
d)&&a.getOption("enableUserMove")){var f=k.clone(a.range);if("rect"===f.type){var g=h?1:10;h=m.pageRange(f.page,f.type);f.left+=b*g;f.top+=c*g;f.right+=e*g;f.bottom+=d*g;var g=f.right-f.left,l=f.bottom-f.top;b&&(0>f.left?(f.left=0,e&&(f.right=g)):f.left>=f.right&&(f.left=f.right-1));e&&(f.right<=f.left?f.right=f.left+1:f.right>h.right&&(f.right=h.right,b&&(f.left=f.right-g,0>f.left&&(f.left=0))));c&&(0>f.top?(f.top=0,d&&(f.bottom=f.top+l)):f.top>=f.bottom&&(f.top=f.bottom-1));d&&(f.bottom<=f.top?
f.bottom=f.top+1:f.bottom>h.bottom&&(f.bottom=h.bottom,c&&(f.top=f.bottom-l,0>f.top&&(f.top=0))))}else"cell"===f.type&&(h=m.pageRange(f.page,f.type),f.c1+=b,f.r1+=c,f.c2+=e,f.r2+=d,g=f.c2-f.c1,l=f.r2-f.r1,b&&(f.c1<h.c1?(f.c1=h.c1,e&&(f.c2=f.c1+g)):f.c1>f.c2&&(f.c1=f.c2)),e&&(f.c2<f.c1?f.c2=f.c1:f.c2>h.c2&&(f.c2=h.c2,b&&(f.c1=f.c2-g,f.c1<h.c1&&(f.c1=h.c1)))),c&&(f.r1<h.r1?(f.r1=h.r1,d&&(f.r2=f.r1+l)):f.r1>f.r2&&(f.r1=f.r2)),d&&(f.r2<f.r1?f.r2=f.r1:f.r2>h.r2&&(f.r2=h.r2,c&&(f.r1=f.r2-l,f.r1<h.r1&&(f.r1=
h.r1)))));a.setRange(f)}};var ha=function(a,b){if(!F)return a;var c;if("string"==typeof a){c=[];var e=p.get(a,"color");e&&c.push("color:",e,";");(e=p.get(a,"background-color"))&&c.push("background-color:",e,";");if(b){if(b&&-1!=a.indexOf("border")){e=g.create("div");e.attr("style",a);e.css("display","none");g.body.append(e);var d=e.computedStyle(e),h=ia(d,"Top"),f=ia(d,"Left"),k=ia(d,"Bottom"),l=ia(d,"Right");h.w&&h.w==k.w&&h.w==f.w&&h.w==l.w&&h.c==k.c&&h.c==f.c&&h.c==l.c?c.push("border:",h.w," solid ",
h.c,";"):($(d,h,c),$(d,f,c),$(d,k,c),$(d,l,c));e.destroy()}}else(e=p.get(a,"text-decoration"))&&c.push("text-decoration:",e,";");c=0==c.length?void 0:c.join("")}return c},ia=function(a,b){b=x[b];return{e:b,w:a[b.w],c:a[b.c]}},$=function(a,b,c){b.w&&c.push(b.e.wp,",",b.w,";",b.e.sp,":solid;",b.e.cp,":",b.c,";")};b.map=function(a){if("text"===a.range.type){var b=N[a.range.acc];void 0!==b?b instanceof Array?b.push(a.id):N[a.range.acc]=[b,a.id]:N[a.range.acc]=a.id}};b.unmap=function(a){if("text"===a.range.type){var b=
N[a.range.acc];void 0!==b&&(b instanceof Array?1==b.length&&b[0]==a.id?delete N[a.range.acc]:f.remove(b,a.id):b===a.id&&delete N[a.range.acc])}};var da=function(a){if(f.isDOMRange(a.range)||f.isDOMSelection(a.range)){var b=k.fromDOM(a.range);if(!b)return;if(!Array.isArray(b))return a.range=b,da(a);a.compound=b;for(var c=b[0].acc,e=b[0].accend,d=1;d<b.length;d++){var h=b[d];h.acc<c&&(c=h.acc);h.accend>e&&(e=h.accend)}a.range=k.textRange(c,e)}if("text"===a.range.type){if((e=n.pagesForRange(a.range))&&
2<=e.length){for(var b=a.range,c=[],g,l,d=0;d<e.length;d++)h=e[d],h.overlay!=l?(g=k.textRange(h.acc,h.accend),c.push(g),l=h.overlay):(h.acc<g.acc&&(g.acc=h.acc),h.accend>g.accend&&(g.accend=h.accend));if(1<c.length){g=[];for(d=0;d<c.length;d++)a.range=c[d],a.range.acc<b.acc&&(a.range.acc=b.acc),a.range.accend>b.accend&&(a.range.accend=b.accend),g.push(ja(a));return g}}}else if("rect"===a.range.type&&(h=n.page(a.range.page),h.isEmailHeader()))return;return ja(a)},ja=function(c){var e;if("text"===c.range.type){var d=
c.properties,h=c.comment,f=c.label;null===d&&(d=void 0);null===h&&(h=void 0);null===f&&(f=void 0);var g=N[c.range.acc];if(void 0!==g)if(g instanceof Array)for(var k=0;k<g.length;k++){var l=t[g[k]];if(l.matches(c.style,c.range,d,h,f)){e=l;break}}else l=t[g],l.matches(c.style,c.range,d,h,f)&&(e=l)}else e=void 0;if(!e){d="rect"===c.range.type||"cell"===c.range.type;h=na();switch(c.type){case "redaction":e=new a.Redaction(h,c);break;case "note":d&&(e=new a.Note(h,c));break;case "stamp":d&&(e=new a.Stamp(h,
c));break;default:e=new a.Highlight(h,c)}if(!e)return;t[h]=e;w||e.addToDocument();b.link(e)}b.on.add.dispatch(e);!0===c.activate?Y(e.id):L&&(b.activateNearest(L.x,L.y,null,!1),L=null);return e.id},aa=function(a,b){if(!(0==t.length||w)){for(var c=a;c<=b;c++){var e=n.page(c);e&&e.isLoaded()&&K.push({page:e,highlightIndex:0})}I||(I=f.setInterval(ka,20))}},ka=function(){m.suspendUpdate();for(var a=0;100>a;){var b=K.shift();if(!b){f.clearInterval(I);I=void 0;break}if(b.page.isLoaded()){var c=b.highlightIndex+
100;c>t.length&&(c=t.length);for(a+=c-b.highlightIndex;b.highlightIndex<c;b.highlightIndex++){var e=t[b.highlightIndex];e&&b.page.containsRange(e.range)&&e.addToPage(b.page.index)}if(b.highlightIndex<t.length){K.unshift(b);break}}}m.resumeUpdate()};b.activateNearest=function(a,b,c,e){var d=r,h=J,f=C;!1!==e&&(e=!0);if(void 0===y)L&&(L.x=a,L.y=b);else{var g=n.mapToPage(a,b,null,!0);if(g){var k=g.page;a=g.x;b=g.y;for(var d=void 0,f=h=!1,l,u,q,g=0;g<t.length;g++){var p=t[g];if(p&&!p.isHidden()&&p.isOnPage(k.index)){var m=
p.distanceFromPoint(k.index,a,b);if(void 0!==m)if(0===m)l||(l=[]),l.push(p);else if(!l&&(void 0===u||Math.abs(m)<Math.abs(u)))u=m,q=p}}if(l){k=void 0!==r?r:z;if(0<l.length&&void 0!==k)for(g=0;g<l.length;g++)if(l[g].id==k){++g>=l.length&&(g=0);d=l[g].id;break}void 0===d&&(d=l[0].id)}else if(q)d=q.id,f=0>u,h=0<u;else{for(var D,d=y;void 0!==d;d=t[d].nextId)if((l=n.forRange(t[d].range))&&l.index>=k.index){D=l;break}D||(d=v,D=n.forRange(t[d].range));D.index<k.index?h=!0:f=!0}}}if(d!=r||h!=J||f!=C)!1===
e&&!f&&!h?f=!0:!c&&(!f&&!h)&&(f=!0),Y(d,f,h);return r};var Y=function(a,e,d,h,f,g){var k=V(a);a=k?k.id:void 0;!0!==e&&(e=!1);!0!==d&&(d=!1);!1!==f&&(f=!0);(k=a!=r||e!=C||d!=J)&&(g=!1);if(k||g){if(!g){if(k=t[r])k.hideDialog(),k.deactivate();void 0!==r&&(z=r);r=a;void 0!==z&&(t[z]&&t[z].isEmptyRedaction())&&(b.remove(z,!0),z=void 0);C=e;J=d}if(void 0!==r&&!e&&!d&&t[r]){k=t[r];if(f){n.moveto(k.range,function(){Y(a,e,d,h,!1,!0)});return}k.isNote()?l.select(null):"cell"===k.range.type&&(l.select(k.range,
k.id),l.hide());c.viewNode.focus();k.activate(g);k.comment()&&!k.isNote()&&b.showComment(k.id,{mode:"view"})}!1!==h&&(k=V(r),b.on.activate.dispatch(k,C,J))}},ba=function(a,b,c,e,d){e=e||c;if(a=V(a,b,c))return"string"==typeof e?a[e].apply(a,d):e.apply(null,d)},V=function(a,c,e){void 0===a&&(a=c);if("number"===typeof a&&t[a])return t[a];e&&b.invalidArg(e,"id",a)};b.link=function(a,c){var e=a.id;b.unlink(a);var d=a.generateKey(c);if(d)if(void 0===y)v=y=e;else for(var h=y;;){var f=t[h],g=f.key,k=!1;d.page<
g.page?k=!0:d.page==g.page&&(d.y<g.y?k=!0:d.y==g.y&&d.x<g.x&&(k=!0));if(k){h===y?y=e:(a.prevId=f.prevId,t[a.prevId].nextId=e);a.nextId=h;f.prevId=e;break}if(h===v){a.prevId=h;v=f.nextId=e;break}h=f.nextId}};b.unlink=function(a){if(void 0!==a.prevId||void 0!==a.nextId||y==a.id){var b=void 0!==a.prevId?t[a.prevId]:null,c=void 0!==a.nextId?t[a.nextId]:null;b?b.nextId=a.nextId:y=a.nextId;a.nextId=void 0;c?c.prevId=a.prevId:v=a.prevId;a.prevId=void 0}};b.positionAll=function(a){b.each("positionAll",a);
b.alignHighlight()};b.validateStyles=function(a){a!==unknown&&(F=!1!==a);return F};var na=function(){for(;e<t.length&&t[e];)e++;e>=t.length&&(e=t.length,t.push(null));return e};b.each=function(a,b){f.eachArgs(t,arguments)};var ea=function(a,c,e,d){a<c.length&&(c=c[a],f.isDOMRange(c)||f.isDOMSelection(c)?e.range=c:e.range=k.validateRange(c),e.range&&a++);e.range||("text"===h.selectionType()&&(e.range=document.getSelection(),e.range&&e.range.isCollapsed&&(e.range=void 0)),e.range||(e.range=h.selection()),
e.range?e.activate=!0:(b.invalidArg(d,"range",null,"A range was not specified and nothing is currently selected"),e.invalid=!0));return a},oa=function(a,c,e,d){if(1>c.length||"string"!==typeof c[0])b.invalidArg(d,"style",null,"A highlight style must be specified"),e.invalid=!0},ma=function(a,c,e,d){var h;a<c.length&&"string"===typeof c[a]&&(h=c[a]);e.style=ha(h,"hl-text"!=e.type);e.style?a++:(b.invalidArg(d,"style",h),e.invalid=!0);return a},ga=function(a,b,c,e,d){a<b.length&&(b=b[a],b instanceof
Object||"object"==typeof b?(c[e]=b,a++):(null===b||void 0===b)&&a++);return a},la=function(a,b,c,e,d){a<b.length&&(b=b[a],b instanceof String||"string"==typeof b?(c[e]=b,a++):(null===b||void 0===b)&&a++);return a},pa=function(a,c,e,d){for(;a<c.length&&void 0===c[a];)a++;a<c.length&&(b.invalidArg(d,null,null,"Unexpected argument(s)"),e.invalid=!0);return a},qa=function(){b.each("updateStyle","isRedaction");Z()};d.onredactionColor(qa);d.onredactionFillColor(qa);d.onnochrome(function(){b.positionAll()});
d.onshowHighlightLabels(function(a){b.each("showLabel",null,a)});d.onhighlightLabelFontFamily(s);d.onhighlightLabelFontSize(s);d.onhighlightActivationBoxColor(function(a){if(null===a)h.screenCSS(".oit-highlight-active .oit-activation","display:none;"),h.screenCSS(".oit-highlight-embed","display:none;"),h.screenCSS(".oit-highlight-active .oit-resize div","display:none;"),h.screenCSS(".oit-text-handle div:nth-child(2)","display:none;"),h.screenCSS(".oit-text-handle div:first-child","display:none;"),
h.screenCSS(".oit-text-handle",null);else if(a=p.stringToColor(a)){var b="rgb("+a.r+","+a.g+","+a.b+")",c="border:2px solid "+b+";opacity:"+a.a+";";h.screenCSS(".oit-highlight-active .oit-activation",c);c="border:1px solid "+b+";opacity:"+a.a+";";h.screenCSS(".oit-highlight-embed",c);c="background-color:"+b+";";h.screenCSS(".oit-highlight-active .oit-resize div",c);h.screenCSS(".oit-text-handle div:nth-child(2)",c);h.screenCSS(".oit-text-handle div:first-child","border-bottom: 7px solid "+b+";");
c="opacity:"+a.a+";";h.screenCSS(".oit-text-handle",c)}});b.on.click.setDefaultListener(function(a,b,c){Y(c.id)});a.on("document","scroll",function(){b.alignComment()});a.on("document","reset",function(){b.clear();v=y=void 0;e=0;z=r=void 0;J=C=!1});a.on("document","load",function(){if(q){var a=q;q=null;b.apply(a)}});a.on("document","zoom",function(a,c,e){b.positionAll()});a.on("content","data",function(a,c,e){a.highlights&&b.apply(a.highlights);if(a.stamps)for(var d in a.stamps)D[d]=a.stamps[d]})}});OIT.extend("mod","hyperlinks",{userEventDef:{pub:!0,detail:function(a,b,d){a={srcEvent:b,url:d.url};d.range&&(a.range=this.range.clone(d.range));d.alt&&(a.alt=d.alt);a.external=0!=a.url.indexOf("#");return a}},install:function(a,b){var d=a.doc,c=a.pages,g=a.util,f=a.content,k=a.dialog,m,h,p={},l=0,n=!1,x=null,s=null,w,t=function(a,c){c||(c=m);if(c)for(var e=0;e<c.length;e++){var h=c[e],f=h.range;if(f)if("text"===f.type){var k=a.findRange(f.acc,f.accend);k&&g.each(k,"addDataToRange",null,f,h,a)}else if("rect"==
f.type&&f.page===a.index){if(!a.linkMap){var k=a.childByClass("oit-svg"),l=k.byClass("oit-svg-text");l&&0<l.length&&(a.linkMap=d.create("div","oit-area-hyperlinks"),a.linkMap.attr("style",l[0].attr("style")),k.append(a.linkMap))}a.linkMap&&(f="left:"+f.left+"px;top:"+f.top+"px;width:"+(f.right-f.left)+"px;height:"+(f.bottom-f.top)+"px;",k=d.create("div"),k.attr("style",f),a.linkMap.append(k),b.on.addElement(k,h),f={anchorNode:k,page:a},h.anchors||(h.anchors=[]),h.anchors.push(f))}}},e=function(a,
b){b||(b=h);if(b)for(var c=0;c<b.length;c++){var e=b[c],d=e.range;if(d&&"text"===d.type){var f=a.findRange(d.acc,d.accend);f&&g.each(f,"addDataToRange",null,d,e,a)}}},q=function(a,b,e){a=0;b&&(a=b.button||0);if(0!=a||!e.targetId)return!0;x=null;(b=p[e.targetId])?(e=d.byId(e.targetId)||b.range||b.page,void 0!==e&&c.movetoEx(e,{force:!0,moveToTop:!0}),n&&(k.hideMessage(),n=!1)):f.isPending()?(n||(k.showMessage(OIT.local.PLEASE_WAIT_INITIALIZING),n=!0),x=e,f.on.add.listenOnce(function(){x&&q(null,null,
x)})):n&&(k.hideMessage(),n=!1);return!1};b.on.click.setDefaultListener(q);a.on("content","data",function(a,b,f){if(a.hyperlinks){m=m?m.concat(a.hyperlinks):a.hyperlinks;for(b=0;b<a.hyperlinks.length;b++){f=a.hyperlinks[b];f.type="hyperlink";f.id="oit-hl-"+ ++l;var g=f.url;if(0==g.indexOf("#")){var k=f,g=g.substring(1);k.targetId=g+"."+d.expando;f.url="#"+f.targetId}}b=c.count();for(f=0;f<b;f++)(k=c.page(f))&&k.isLoaded()&&t(k,a.hyperlinks)}if(a.bookmarks){h=h?h.concat(a.bookmarks):a.bookmarks;for(b=
0;b<a.bookmarks.length;b++)f=a.bookmarks[b],k=f.name,f.type="bookmark",f.id=k+"."+d.expando,p[f.id]||(p[f.id]=f);b=c.count();for(f=0;f<b;f++)(k=c.page(f))&&k.isLoaded()&&e(k,a.bookmarks)}});var y=function(){if(s){for(var a,b=0;b<s.length;b++){var c=s[b];c.isLoaded()&&(c.isHidden()?(a||(a=[]),a.push(c)):(t(c),e(c)))}s=a}s||(g.clearInterval(w),w=void 0)};a.on("pages","pageload",function(a,b){s||(s=[]);-1==s.indexOf(a)&&(s.push(a),1==s.length&&(w=g.setInterval(y,100)))});a.on("pages","pageunload",function(a){if(m)for(var c=
0;c<m.length;c++){var e=m[c];if(e.anchors)for(var d=e.anchors.length-1;0<=d;d--){var h=e.anchors[d];if(h.page===a){b.on.removeElement(h.anchorNode);1==e.anchors.length?e.anchors=void 0:e.anchors.splice(d,1);break}}}delete a.linkMap});a.on("document","reset",function(){h=m=void 0;p={};l=0})}});OIT.extend("mod","attachments",{exports:["describe","setOptions"],userEventDef:{pub:!0,detail:function(a,b,d){(a=this.attachments.describe(d))?a.attachment=d:a={};a.srcEvent=b;return a}},install:function(a,b){var d=[],c;b.item=function(a){return d[a]};b.describe=function(b){var c;0==arguments.length?c=a.util.clone(d):isNaN(b)||0<=b&&b<d.length&&(c=a.util.clone(d[b]));return c};b.setOptions=function(b){b&&(c||(c=new a.DynamicStyleSheet),b.hasOwnProperty("cursor")&&c.setRule(".oit-attachedFile {cursor:"+
b.cursor+"}","cursor"),b.hasOwnProperty("color")&&c.setRule(".oit-attachedFile {color:"+b.color+"}","color"))};a.on("document","reset",function(){d=[];c&&(c.destroy(),c=void 0)});a.on("content","data",function(a,b,c){if(a.attachments)for(b=0;b<a.attachments.length;b++)d.push(a.attachments[b])})}});OIT.extend("mod","archive",{userEventDef:{pub:!0,detail:function(a,b,d){return{nodeid:d,name:a.text(),srcEvent:b}}}});OIT.extend("mod","toolbars",{exports:["add","hide","remove","setSize","show"],events:{add:{pub:!0,detail:function(a,b){return{id:a,edge:b}}},remove:{pub:!0,detail:function(a,b){return{id:a,edge:b}}},show:{pub:!0,detail:function(a,b,d,c){return{id:a,edge:b,width:d,height:c}}},hide:{pub:!0,detail:function(a,b){return{id:a,edge:b}}},resize:{pub:!0,detail:function(a,b,d,c){return{id:a,edge:b,width:d,height:c}}}},install:function(a,b){var d=a.doc,c=a.glob,g=a.util,f=a.view,k=a.css,m=["left","top","right",
"bottom"],h=[],p,l=function(){g.eachSparse(h,"refresh");f.dispatchResize()};a.on("view","resize",l);b.add=function(f,g,l){var n;if(-1===m.indexOf(f))b.invalidArg("add","edge",f,"Must be one of "+JSON.stringify(MEMORY_MODELS));else if(d.isElement(g)){var e,q=!1,y=!1,v;l&&(l.size&&((e="auto"===l.size?l.size:k.validateLength(l.size))||b.invalidArg("add","options.size",l.size,"Must be a valid CSS length or 'auto'")),!0===l.visible&&(q=!0),!0===l.overlay&&(y=!0),l.border&&(v=l.border));var D;p?(D=h[p],
n=++p):n=p=1;l=c.viewNode;var u=l.scroll();g=new a.ToolBar(n,f,d.wrap(g),v,y,D);h[n]=g;e&&g.setSize(e);l.scroll(u);b.on.add.dispatch(n,f);q&&b.show(n)}else b.invalidArg("add","elem",g,"Must be a valid DOM Element");return n};b.addInternal=function(a,b){h[a]=b};b.removeInternal=function(a){var b=h[a];b&&(b.remove(),delete h[a])};b.remove=function(a){g.eachSparse(h,n,a);l()};var n=function(a){var b=a.id;a.remove();for(h[b]=void 0;!h[p];)if(0>=--p){p=void 0;break}return!0};b.setSize=function(a,c){a=
Number(a);var d=h[a];(!d||d.isInternal())&&b.invalidArg("setSize","id",a,"Must be a valid toolbar id returned by OIT.toolbars.add");var f="auto"===c?c:k.validateLength(c);f?d&&(d.setSize(f),l()):b.invalidArg("setSize","size",c,"Must be a valid CSS length or 'auto'")};b.show=function(a,b){g.eachSparse(h,"show",a,b||{});l()};b.hide=function(a){g.eachSparse(h,"hide",a);l()}}});OIT.extend("mod","stylemap",{install:function(a,b){var d=a.css,c=a.util,g=null,f={},k=0;b.applyStyle=function(b,d,f,g){if(f&&"text"===d.type&&d.accend>d.acc){!0==d.bSlideNote&&(b=a.pages.notesBar());var k=b.findRange(d.acc,d.accend);if(k&&0<k.length)return c.each(k,"addDataToRange",null,d,{type:"style",id:g,props:f},b),k}};b.removeStyle=function(a,b){c.each(a,"removeData",null,"style",b)};b.styleName=function(b){b=d.compose(b);var c=f[b];c||(c="oit-ss"+ ++k,f[b]=c,g||(g=new a.DynamicStyleSheet),g.addCSSText("."+
c+", ."+c+" a {"+b+"}"));return c};a.on("document","reset",function(){g&&(g.destroy(),g=null);f={};k=0})}});OIT.extend("fmt",["page","drawing","slide","chart"],{de:"page",showhidden:!1,cellselection:!1});OIT.extend("fmt","bitmap",{de:"page",showhidden:!1,textselection:!1,cellselection:!1,customtextselection:!1});OIT.extend("fmt",["email","html"],{de:"page",rotate:!1,showhidden:!1,pages:!1,fitpage:!1,cellselection:!1});
OIT.extend("de","page",{install:function(a,b){var d=a.opt,c=a.glob,g=a.doc,f=a.document,k=a.pages,m=a.css,h=a.highlights,p=a.range,l,n=1,x=null,s,w,t,e,q,y=20;b.load=function(e){l=e.overlay;n=1;x=null;s=e.type;w=void 0;if(!c.isMobile&&void 0===c.singlePageIndex)a.on("document","idle",C);v();a.on("pages","add",b,D);a.on("pages","pageload",b,v);a.on("pages","change",b,J);a.on("document","scrollupdate",b,J);if("email"===s||"html"===s)a.on("view","resize",b,H),H();B(e.index);J()};b.unload=function(){a.off("pages",
"add",D);a.off("pages","change",J);a.off("document","scrollupdate",J);a.off("view","resize",H);c.isMobile||a.off("document","idle",C);w&&(w.destroy(),w=void 0);null!=x&&(x.destroy(),x=null);l=null;n=1;x=null;t=w=q=e=s=void 0};b.topPageIndex=function(){var a=k.current();if("email"===s)a=0;else if("vertical"==d.scrollMode&&void 0===c.singlePageIndex)for(var b=a-1;0<b;b--){var e=k.page(b);if(e&&e.isEnabled()){if(e.overlay!=l)break;if(10>e.pageRect("view").bottom)break;a=b}}return a};b.bottomPageIndex=
function(){var a=k.current();if("email"===s)a=1;else if("vertical"==d.scrollMode&&void 0===c.singlePageIndex)for(var b=k.count(),e=a+1;e<b;e++){var f=k.page(e);if(f&&f.isEnabled()){if(f.overlay!=l)break;if(f.pageRect("view").top>c.viewNode.clientHeight-10)break;a=e}}return a};b.margin=function(){return{left:y,top:y,right:y,bottom:y}};var v=function(){if("email"===s&&!x){var b=g.byId("oit-emailheader");null!=b&&(x=new a.EmailHeader(b))}};b.layoutChanged=function(a){if(l){var b=c.viewNode,e=d.zoom;
a||(a={x:0,y:0});var f=b.scroll(),h=null,g=null,k=null;1!=e&&(h=["scale(",e,",",e,")"].join(""),g="left top",k=[100/e,"%"].join(""));l.css({transform:h,"transform-origin":g,"min-width":k});u();h=e/n;b.scroll((a.x+f.left)*h-a.x,(a.y+f.top)*h-a.y);n=e;J()}};var D=function(){u(!0)},u=function(b){if(l){var e=d.rotation,f={yOffset:0,maxWidth:0,height:0},g=k.top(),q=[],u=d.centerPages,n=y/d.zoom;if("email"===s||"html"===s)u=!1;if(u){q.push(".oit-page,.oit-bitmap,.oit-drawing,.oit-slide,.oit-chart{");q.push("margin: ",
n,"px 0;");if(!d.nochrome)switch(e){case 90:q.push("box-shadow:-2px 2px 20px 1px #111 !important;");break;case 180:q.push("box-shadow:-2px -2px 20px 1px #111 !important;");break;case 270:q.push("box-shadow:2px -2px 20px 1px #111 !important;")}q.push("}")}l.each(E,null,q,e,u,n,f);0==f.maxWidth?l.css("width",null):(f.maxWidth+=y+y,l.css("width",f.maxWidth+"px"));0==f.height?l.css("height",null):(f.height+=y,l.css("height",f.height+"px"));q=q.join("");w||(w=new a.DynamicStyleSheet);w.setCSSText(q);!t&&
(!b&&"vertical"==d.scrollMode&&void 0===c.singlePageIndex)&&(b=d.disableAnimation,d.disableAnimation=!0,k.moveto(g),d.disableAnimation=b);h.positionAll()}},E=function(a,b,e,f,h,g){var k=0,l=0,q,u=c.viewNode.clientWidth;a.resetCache();switch(e){case 0:f&&(k=(u/d.zoom-a.offsetWidth)/2,k<h&&(k=h));break;case 90:f&&(l=(u/d.zoom-a.offsetHeight)/2,l<h&&(l=h));k=-g.yOffset-a.offsetWidth;g.yOffset=g.yOffset-a.offsetHeight+a.offsetWidth;a.offsetHeight>g.maxWidth&&(g.maxWidth=a.offsetHeight);g.height+=a.offsetWidth+
y;q="rotate(270deg) ";break;case 180:f&&(k=-((u/d.zoom-a.offsetWidth)/2),k>-h&&(k=-h));k-=a.offsetWidth;l=-a.offsetHeight;q="rotate(180deg) ";break;case 270:f&&(l=-((u/d.zoom-a.offsetHeight)/2),l>-h&&(l=-h)),l-=a.offsetHeight,k=g.yOffset,g.yOffset=g.yOffset-a.offsetHeight+a.offsetWidth,a.offsetHeight>g.maxWidth&&(g.maxWidth=a.offsetHeight),g.height+=a.offsetWidth+y,q="rotate(90deg) "}if(0!=k||0!=l||q){a=a.id.replace(/\./g,"\\.");b.push("#");b.push(a);b.push(" {");if(0!=k||0!=l||q){b.push(m.nameMap.transform);
b.push(":");q&&b.push(q);if(0!=k||0!=l)b.push("translate("),b.push(k),b.push("px,"),b.push(l),b.push("px)");b.push(";")}b.push("}")}};b.moveto=function(b,e,d){var f=!1;d=d||{};if(p.isRangeObject(b))x&&(f=x.moveto(b,e,d));else if("number"===typeof b){f=c.viewNode;b=k.page(b);B(b.index);var h;(h=d.gotoNode)&&h!==b?h=k.elementRect(h,"overlay"):(h=b.pageRect("overlay"),h.top-=y);b=f.scroll().top;h=b+(h.top-b);0>h&&(h=0);h!=b?(a.disableEvent("document","scrollupdate"),f.abortAnimation(),b=!1!==d.animate?
150:0,t=!0,f.animate({scrollTop:h,time:b,endFn:r,args:[e,d]})):e&&e(d);f=!0}return f};var r=function(b,c,e){t=!1;a.enableEvent("document","scrollupdate");a.dispatch("document","scrollupdate");c&&c(e)},z=function(a){q&&a.hiddenFromSlideshow?a.hide():a.show()},B=function(a){var b=!1;"vertical"===d.scrollMode&&void 0===c.singlePageIndex?c.viewNode.removeClass("oit-single"):c.viewNode.addClass("oit-single");if("vertical"==d.scrollMode&&void 0===c.singlePageIndex||"email"===s||"html"===s)void 0!==e&&(l.showPages(),
e=void 0,b=!0,q=!1),a="slideshow"==d.presentationMode,a!=q&&(q=a,b=!0,l.each(z));else if(a=a||k.current(),a!=e){var g=k.page(a);if(g){var u;void 0===e?l.hidePages(g.index):(u=k.page(e),g.addClass("oit-noshadow"));g.show({insertLast:!0,animate:!0,endFn:function(){g.removeClass("oit-noshadow");u&&u.hide()}});e=a;b=!0}}b&&(f.dispatchPageEvents(!0),h.positionAll())};b.pageRange=function(a,b){if("rect"===b){var c=k.page(a);if(c)return c=c.pageRect(),p.rectRange(a,0,0,c.width,c.height)}};b.rangeRect=function(b,
c,e){var d;if("text"===b.type){var f=k.forRange(b);f&&(d=f.textBoundingRect(b))}else"rect"===b.type&&(d=new a.Rectangle(b),void 0!==b.embedId&&((e=k.page(b.page))&&(f=e.embeddingRect(b.embedId)),f?d.offset(f.left,f.top):d=void 0));d&&(d.origin=c);return d};b.rangeFromRect=function(b,c,e,d,f,h,g,l){if(b=k.page(b))return c=new a.Rectangle(c,e,d,f,h),c.origin=b,e=void 0!==l?b.embeddingRect(l):b.pageRect(),"html"!==b.type&&("move"===g?c.constrain(e):"select"!==g&&c.intersect(e)),void 0!==l?(c.offset(-e.left,
-e.top),g=c.toRange(b),g.embedId=l,p.convert(g,"pct")):g=c.toRange(b),g};b.extendRange=function(a,c,e,d){var f=b.rangeRect(a,d);return b.rangeFromRect(a.page,f.left,f.top,c,e,d,"extend")};var C=function(){void 0===k.loadNextPageFromServer()&&a.off("document","idle",C);return!1},J=function(){if(!c.isMobile&&void 0===c.singlePageIndex)a.on("document","idle",C);c.viewNode.scroll();for(var b=k.top(),e=k.bottom();b<=e;b++){var d=k.page(b);d&&d.isPending()&&d.load(!0,!1)}},H=function(){k.each(M);x&&x.applyViewSize()},
M=function(a){if(a.hasClass("oit-html")||a.hasClass("oit-email")){a.css("width",c.viewNode.clientWidth+"px");var b=a.byTag("svg");if(b)for(var e=0;e<b.length;e++){var d=b[e];d.attr("width",c.viewNode.clientWidth);d=g.unwrap(d).firstElementChild;if(null!=d&&"rect"==d.nodeName){var f=getComputedStyle(d,null);null!=f&&null!=f.fill&&parseInt(d.attributes.getNamedItem("height").value)==a.height&&d.setAttribute("width",c.viewNode.clientWidth)}}}};d.onemailHeaderStyle(function(){if(x)x.onStyleChanged()});
d.onremoveExtraEmailHeaders(function(){x&&x.removeExtraEmailHeaders()});d.onscrollMode(function(){l&&(B(),c.viewNode.scroll(0,0),k.updateActivePage())});d.onpresentationMode(function(){l&&B()});d.onnochrome(function(a){l&&(y=a?0:20,B())})}});OIT.extend("fmt",["worksheet","database"],{de:"ss",rotate:!1,textselection:!1,rectselection:!1,customtextselection:!1});
OIT.extend("de","ss",{install:function(a,b){var d=a.glob,c=a.util,g=a.range,f=a.selection,k=a.math,m,h,p,l,n=!1;b.load=function(c){m=c;l=p=h=null;if(h=c.spreadsheetModel())p=new a.SpreadsheetView(h,m),(c=h.showHidden())&&b.showHidden(c)};b.unload=function(){l&&c.clearTimeout(l);p&&p.unload();l=p=h=null};b.maxPageWidth=function(){if(p)return p.maxPageWidth()};b.maxPageHeight=function(){if(p)return p.maxPageHeight()};b.padding=function(){if(p)return p.padding()};b.scrollOffset=function(){if(p)return p.scrollOffset()};
b.getSelectedText=function(){return!h?"":h.getSelectedText()};b.select=function(a){return h?h.select(a):!1};b.keydown=function(a){var b=!0;if(p)switch(a.keyCode){case 33:d.viewNode.dscroll(0,-(p.visibleHeight()+1));if(a=f.cellSelection())b=p.visibleRange(),b=b.r2-b.r1+1,a.c2=a.c1,a.r1-=b,0>a.r1&&(a.r1=0),a.r2=a.r1,f.select(a);b=!1;break;case 34:d.viewNode.dscroll(0,p.visibleHeight()+1);if(a=f.cellSelection())b=p.visibleRange(),b=b.r2-b.r1+1,a.c2=a.c1,a.r1+=b,b=h.rowCount()-1,a.r1>b&&(a.r1=b),a.r2=
a.r1,f.select(a);b=!1;break;case 35:n=!n;b=!1;break;case 36:p.scrollToRange(0,0,0,0);a=g.cellRange(m.index,0,0);f.select(a);b=n=!1;break;case 27:p.hidePopup(!0);b=n=!1;break;case 37:case 38:case 39:case 40:break;default:n=!1}return b};b.moveto=function(a,b,c){return p?p.moveto(a,b,c):!1};b.showHidden=function(a){void 0===a&&(a="all");a=h.showHidden(a);var b,c;"columns"===a?b=!0:"rows"===a?c=!0:"all"===a?c=b=!0:"none"===a&&(c=b=!1);p&&p.showHidden(b,c)};b.pageRange=function(a,b){if("cell"===b&&a==
m.index)return g.cellRange(a,0,0,h.colCount()-1,h.rowCount()-1)};b.pageRect=function(a,b){if(p)return p.pageRect(a,b)};b.rangeRect=function(a,b,c){if(p)return p.rangeRect(a,b,c)};b.rangeFromRect=function(a,b,c,d,f,h,g,k){if(p)return p.rangeFromRect(a,b,c,d,f,h,g,k)};b.extendRange=function(a,b,c,d){if(p)return p.extendRange(a,b,c,d)};var x=function(a,b){var c=k.clamp(a+b,0,h.colCount()-1);if(0!=b&&h.colHidden(c)){var d=h.colCount()-1;do if(c+=b,0>c){for(c=0;c<=d&&h.colHidden(c);c++);break}else if(c>
d){for(c=d;0<=c&&h.colHidden(c);c--);break}while(h.colHidden(c))}return c},s=function(a,b){var c=k.clamp(a+b,0,h.rowCount()-1);if(0!=b&&h.rowHidden(c)){var d=h.rowCount()-1;do if(c+=b,0>c){for(c=0;c<=d&&h.rowHidden(c);c++);break}else if(c>d){for(c=d;0<=c&&h.rowHidden(c);c--);break}while(h.rowHidden(c))}return c};b.moveAnchor=function(a,b,c,d){d=!1;n&&(0>b?b=-h.colCount():0<b&&(b=h.colCount()),0>c?c=-h.rowCount():0<c&&(c=h.rowCount()),n=!1);b=x(a.c1,b);c=s(a.r1,c);a.c1!=b&&(a.c1=b,d=!0);a.c2!=b&&(a.c2=
b,d=!0);a.r1!=c&&(a.r1=c,d=!0);a.r2!=c&&(a.r2=c,d=!0);d&&p.scrollToRange(a.c1,a.r1,a.c1,a.r1);return d};b.incrementSelection=function(a,b,c,d,f){f=!1;n&&(0>c?c=-h.colCount():0<c&&(c=h.colCount()),0>d?d=-h.rowCount():0<d&&(d=h.rowCount()),n=!1);b.c2==a.c1?(c=x(b.c1,c),c!=b.c1&&(c<=b.c2?b.c1=c:(b.c1=b.c2,b.c2=c),f=!0)):(c=x(b.c2,c),c!=b.c2&&(c>=b.c1?b.c2=c:(b.c2=b.c1,b.c1=c),f=!0));b.r2==a.r1?(d=s(b.r1,d),d!=b.r1&&(d<=b.r2?b.r1=d:(b.r1=b.r2,b.r2=d),f=!0)):(d=s(b.r2,d),d!=b.r2&&(d>=b.r1?b.r2=d:(b.r2=
b.r1,b.r1=d),f=!0));f&&(d=b.c2==a.c1?b.c1:b.c2,a=b.r2==a.r1?b.r1:b.r2,p.scrollToRange(d,a,d,a));return f};b.layoutChanged=function(a){p&&p.layoutChanged(a)};b.update=function(a){p&&p.update(a)}}});OIT.extend("fmt",["archive","emailarchive"],{de:"arc",zoom:!1,rotate:!1,showhidden:!1,fitpage:!1,highlights:!1,rectselection:!1,cellselection:!1,anchorednotes:!1});
OIT.extend("de","arc",{install:function(a,b){var d=a.glob,c=a.doc,g=a.archive,f=a.util,k,m,h,p=function(a){a.preventDefault();x(this.parentNode.parentNode.parentNode,this)},l=function(a){x(this.parentNode.parentNode.parentNode,this)},n=function(){var a=m.scroll().left;a!=h&&(h=a,0==h?k.removeStyle("margin-left"):k.css("margin-left",-h+"px"))};b.load=function(a){k=a.childByClass("oit-tree-head");m=a.childByClass("oit-tree-nodes");h=0;var b=c.byClass("oit-open-close");b&&(f.each(b,"onclick",null,p),
f.each(b,"ontap",null,l));if(b=c.byClass("oit-tree-nname"))for(a=0;a<b.length;a++){var e=b[a],d=e.attr("data-nodeid");null!=d&&""!==d&&(d=Number(d),isNaN(d)||g.on.addElement(e,d))}if(b=k.byClass("oit-col-header"))for(a=0;a<b.length;a++)b[a].ctrl=new s(b[a],k),b[a].ctrl.colClass="f"+a;a=k;var u;a:{try{for(var t=document.styleSheets,b=0;b<t.length;b++){var r=t[b].cssRules||t[b].rules;if(0<r.length&&"div.f0"==r[0].selectorText){u=b;break a}}}catch(z){}u=null}a.ssIndex=u;m.onscroll(n)};var x=function(a,
b){var c=a.nextElementSibling;"none"!=c.style.display?(c.style.display="none",b&&b.addClass("closed")):(c.style.display="block",b&&b.removeClass("closed"))},s=function(b,d){a.Element.call(this,"div","oit-col-dragger");this.append(c.create("div"));this.headerbar=d;var f=b.nextSiblingElem();f?k.insert(this,f):k.append(this);this.header=b;this.ondragstart(w);this.ondragmove(t);this.ondragend(e);this.ondragcancel(e)};a.subclass(s,a.Element);var w=function(a){this.orgwidth=this.header.clientWidth;this.overlay||
(a=d.viewNode,this.overlay=c.create("div","oit-tree-overlay"),this.overlay.css({height:a.clientHeight-this.headerbar.clientHeight+"px",top:this.headerbar.clientHeight+2+"px",left:this.header.offsetLeft-3+"px"}),this.overlay.innerWidth=this.orgwidth+6,this.header.parent().append(this.overlay))},t=function(a){a=this.orgwidth+a.delta.x-3;1>a&&(a=1);this.header.innerWidth=a;this.overlay.innerWidth=a+9},e=function(a){this.overlay.destroy();delete this.overlay;this.header.css("width",null);a=this.orgwidth+
a.delta.x-3;1>a&&(a=1);a+="px";if(null!=this.headerbar.ssIndex)for(var b=document.styleSheets[this.headerbar.ssIndex].cssRules,c="div."+this.colClass,e=0;e<b.length;e++){if(b[e].selectorText==c){b[e].style.width=a;break}}else{b=this.headerbar.parent().byClass(this.colClass);for(e=0;e<b.length;e++)b[e].css("width",a)}}}});OIT.extend(function(a){var b=a.opt,d=a.pages,c=a.math,g=a.range,f=a.display,k=function(a){return"number"===typeof a};a.Rectangle=function(){var a=arguments;if(1===a.length)a=a[0],void 0!==a.units?("px"!==a.units&&(a=g.clone(a),g.convert(a,"px")),this.l=a.left,this.t=a.top,this.r=a.right,this.b=a.bottom,this.o=d.page(a.page)):a.o&&(this.l=a.l,this.t=a.t,this.r=a.r,this.b=a.b,this.o=a.o);else if(2===a.length){var b=a[0];this.l=b.left;this.t=b.top;this.r=b.right;this.b=b.bottom;this.o=a[1]}else this.l=
a[0],this.t=a[1],this.r=a[2],this.b=a[3],this.o=a[4];a=this.o&&("view"===this.o||"overlay"===this.o||"string"===typeof this.o.type);if(!k(this.l)||!k(this.t)||!k(this.r)||!k(this.b)||!a)throw"Invalid Rectangle";this.l=c.round(this.l,1E4);this.t=c.round(this.t,1E4);this.r=c.round(this.r,1E4);this.b=c.round(this.b,1E4);this.l>this.r&&(a=this.l,this.l=this.r,this.r=a);this.t>this.b&&(a=this.t,this.t=this.b,this.b=a);this.w=this.r-this.l;this.h=this.b-this.t};var m=a.subclass(a.Rectangle);Object.defineProperties(m,
{left:{enumerable:!0,get:function(){return this.l},set:function(a){this.l=c.round(a,1E4);this.r=this.l+this.w}},top:{enumerable:!0,get:function(){return this.t},set:function(a){this.t=c.round(a,1E4);this.b=this.t+this.h}},right:{enumerable:!0,get:function(){return this.r},set:function(a){this.r=c.round(a,1E4);this.l=this.r-this.w}},bottom:{enumerable:!0,get:function(){return this.b},set:function(a){this.b=c.round(a,1E4);this.t=this.b-this.h}},width:{enumerable:!0,get:function(){return this.w},set:function(a){0>
a&&(a=0);this.w=c.round(a,1E4);this.r=this.l+this.w}},height:{enumerable:!0,get:function(){return this.h},set:function(a){0>a&&(a=0);this.h=c.round(a,1E4);this.b=this.t+this.h}},origin:{enumerable:!0,get:function(){return this.o},set:function(a){this.convert(a)}}});var h=function(a,b,d){return"number"===typeof d&&(d=c.round(d,1E4),d!==a[b])?(a[b]=d,!0):!1};m.move=function(a,b,c,d){var f=!1,f=h(this,"l",a),f=f|h(this,"t",b),f=f|h(this,"r",c);if(f|=h(this,"b",d))this.w=this.r-this.l,this.h=this.b-this.t;
return f};m.movesize=function(a,b,c,d){var f=!1,f=h(this,"l",a),f=f|h(this,"t",b),f=f|h(this,"w",c);if(f|=h(this,"h",d))this.r=this.l+this.w,this.b=this.t+this.h;return f};m.offset=function(a,b){void 0!==a&&(this.left+=a);void 0!==b&&(this.top+=b)};m.size=function(a,b){void 0!==a&&(this.width=a);void 0!==b&&(this.height=b)};var p=function(a,b){return a===b?!0:0.999<(a>b?b/a:a/b)};m.equals=function(a){return p(this.l,a.left)&&p(this.t,a.top)&&p(this.r,a.right)&&p(this.b,a.bottom)};m.overlaps=function(a){return this.l<
a.right&&this.r>a.left&&this.t<a.bottom&&this.b>a.top};m.contains=function(a){return a.left>=this.l&&a.right<=this.r&&a.top>=this.t&&a.bottom<=this.b};m.union=function(a,b,d,f){if(1==arguments.length){var h=arguments[0];this.union(h.left,h.top,h.right,h.bottom)}else a=c.round(a,1E4),b=c.round(b,1E4),d=c.round(d,1E4),f=c.round(f,1E4),a<this.l&&(this.l=a),b<this.t&&(this.t=b),d>this.r&&(this.r=d),f>this.b&&(this.b=f),this.w=this.r-this.l,this.h=this.b-this.t};m.intersect=function(a,b,d,f){if(1==arguments.length){var h=
arguments[0];this.intersect(h.left,h.top,h.right,h.bottom)}else a=c.round(a,1E4),b=c.round(b,1E4),d=c.round(d,1E4),f=c.round(f,1E4),a>this.l&&(this.l=a),b>this.t&&(this.t=b),d<this.r&&(this.r=d),f<this.b&&(this.b=f),this.w=this.r-this.l,this.h=this.b-this.t};m.constrain=function(a,b,d,f){if(1==arguments.length){var h=arguments[0];this.constrain(h.left,h.top,h.right,h.bottom)}else{a=c.round(a,1E4);b=c.round(b,1E4);d=c.round(d,1E4);f=c.round(f,1E4);var h=d-a,g=f-b;this.width>=h?(this.l=a,this.r=d,this.w=
h):this.left<a?this.left=a:this.right>d&&(this.right=d);this.height>=g?(this.t=b,this.b=f,this.h=g):this.t<b?this.top=b:this.b>f&&(this.bottom=f)}};m.clone=function(){return new a.Rectangle(this.left,this.top,this.right,this.bottom,this.origin)};m.toRange=function(a){var b=this;this.o!==a&&(b=this.clone(),b.origin=a);return g.rectRange(a.index,b.left,b.top,b.right,b.bottom)};m.distanceFrom=function(a,b,d,f){a=c.round(a,1E4);b=c.round(b,1E4);switch(d){case "left":a-=this.l;break;case "center":a-=(this.l+
this.r)/2;break;case "right":a-=this.r;break;case "none":a=0;break;default:a=a<this.l?a-this.l:a>this.r?a-this.r:0}switch(f){case "top":b-=this.t;break;case "middle":b-=(this.t+this.b)/2;break;case "bottom":b-=this.b;break;case "none":b=0;break;default:b=b<this.t?b-this.t:b>this.b?b-this.b:0}if(0===a&&0===b)return 0;f=c.round(Math.sqrt(a*a+b*b),10);if(0>b||0==b&&0>a)f=-f;return f};m.convert=function(a){var c=this.o;if(a!==c){if("view"===a||"overlay"===a)if("view"===c){var d=f.padding(),c=f.scrollOffset();
this.left=this.left-d.left+c.left;this.top=this.top-d.top+c.top}else if("overlay"===c)d=f.padding(),c=f.scrollOffset(),this.left=this.left+d.left-c.left,this.top=this.top+d.top-c.top;else{d=c;if(d.features().rotate&&(c=b.rotation,0!=c))switch(c){case 90:this.move(this.t,d.width-this.r,this.b,d.width-this.l);break;case 180:this.move(d.width-this.r,d.height-this.b,d.width-this.l,d.height-this.t);break;case 270:this.move(d.height-this.b,this.l,d.height-this.t,this.r)}d.features().zoom&&(c=b.zoom,1!=
c&&this.move(this.l*c,this.t*c,this.r*c,this.b*c));(c=d.pagePos(a))&&this.offset(c.left,c.top)}else if("view"===c||"overlay"===c){if(d=a,(c=d.pagePos(c))&&this.offset(-c.left,-c.top),d.features().zoom&&(c=b.zoom,1!=c&&this.move(this.l/c,this.t/c,this.r/c,this.b/c)),d.features().rotate&&(c=b.rotation,0!=c))switch(c){case 90:this.move(d.width-this.b,this.l,d.width-this.t,this.r);break;case 180:this.move(d.width-this.r,d.height-this.b,d.width-this.l,d.height-this.t);break;case 270:this.move(this.t,d.height-
this.r,this.b,d.height-this.l)}}else d=c.pageRect(),c=a.pageRect(),this.offset(c.left-d.left,c.top-d.top);this.o=a}return this}});OIT.extend(function(a){var b=a.util;a.RectangleSet=function(a){this._rects=[];this.add(a)};var d=a.subclass(a.RectangleSet);Object.defineProperties(d,{length:{enumerable:!0,get:function(){return this._rects.length}},left:{enumerable:!0,get:function(){return boundingRectangle().left}},top:{enumerable:!0,get:function(){return boundingRectangle().top}},right:{enumerable:!0,get:function(){return boundingRectangle().right}},bottom:{enumerable:!0,get:function(){return boundingRectangle().bottom}},width:{enumerable:!0,
get:function(){return boundingRectangle().width}},height:{enumerable:!0,get:function(){return boundingRectangle().height}}});d.item=function(a){return this._rects[a]};d.add=function(a){if(a){if(Array.isArray(a))for(var b=0;b<a.length;b++)this._rects.push(a[b]);else this._rects.push(a);this._boundingRect=null}return this};d.convert=function(a){b.each(this._rects,"convert",null,a);this._boundingRect=null;return this};d.boundingRect=function(){if(!this._boundingRect){for(var b=this._rects,d=b[0],f=d.left,
k=d.top,m=d.right,h=d.bottom,p=1;p<b.length;p++)d=b[p],d.left<f&&(f=d.left),d.top<k&&(k=d.top),d.right>m&&(m=d.right),d.bottom>h&&(h=d.bottom);this._boundingRect=new a.Rectangle(f,k,m,h,b[0].origin)}return this._boundingRect};d.interiorRect=function(a,b){for(var d=this._rects,k=null,m=0,h=0;h<d.length;h++){var p=d[h];if(p.width>=a.width&&p.height>=a.height){k=p;break}else if(!k||p.width>k.width||p.height>k.height){var l=p.width/a.width,n=p.height/a.height,x=Math.min(l,n);b&&(l=p.height/a.width,n=
p.width/a.height,l=Math.min(l,n),x=Math.max(x,l));if(!k||x>m)k=p,m=x}}if(k)return k.clone()}});OIT.extend(function(a){var b=a.doc;a.DynamicStyleSheet=function(c){a.Element.call(this,"style");c&&this.attr("media",c);this.append(b.createText(""));b.head.append(this);this.rulecount=0;this.indexLookup={};Object.defineProperty(this,"sheet",{get:function(){return this.dom.sheet}})};var d=a.subclass(a.DynamicStyleSheet,a.Element);d.addCSSText=function(a){this.html(this.html()+a)};d.setCSSText=function(a){this.html(a)};d.setRule=function(a,b){if(b&&this.indexLookup.hasOwnProperty(b))return this.updateRuleByIndex(a,
this.indexLookup[b]);try{return this.sheet.insertRule(a,this.rulecount),b&&(this.indexLookup[b]=this.rulecount),this.rulecount++}catch(d){this.logError("setRule","Error inserting style rule: "+d.message)}};d.updateRuleByIndex=function(a,b){if(!isNaN(b)){try{this.sheet.deleteRule(b),this.sheet.insertRule(a,b)}catch(d){this.logError("updateRuleByIndex","Error updating style rule: "+d.message)}return b}};d.updateRule=function(a,b){this.indexLookup.hasOwnProperty(b)?this.updateRuleByIndex(a,this.indexLookup[b]):
this.updateRuleByIndex(a,b)};d.removeFromNames=function(a){for(var b in this.indexLookup)this.indexLookup[b]==a?delete this.indexLookup[b]:this.indexLookup[b]>a&&(this.indexLookup[b]-=1)};d.deleteRule=function(a){a=this.indexLookup.hasOwnProperty(a)?this.indexLookup[a]:a;!isNaN(a)&&a<this.rulecount&&(this.sheet.deleteRule(a),this.removeFromNames(a),this.rulecount--)};d.hasRule=function(a){return this.indexLookup.hasOwnProperty(a)}});OIT.extend(function(a){var b=a.opt,d=a.util,c=function(a,b){a/=b/2;if(1>a)return 0.5*a*a;a--;return-0.5*(a*(a-2)-1)},g={ease:c,"ease-in-out":c,"ease-in":function(a,b){a/=b;return a*a*a},"ease-out":function(a,b){a/=b;a--;return a*a*a+1},linear:function(a,b){return a/b}},f="opacity offsetLeft offsetTop innerWidth innerHeight scrollLeft scrollTop".split(" "),k={scrollLeft:!1,scrollTop:!1},m=[],h=function(a){d.eachReverse(m,"step",null,a);0<m.length&&d.requestAnimationFrame(h)},p=function(a){var b=a.elem;
b&&(b.data("_animation")===a&&b.removeData("_animation"),b.removeClass("oit-animating"));d.remove(m,a)};a.on("document","reset",function(){d.each(m,"finish");m=[];for(var a in k)k.hasOwnProperty(a)&&(k[a]=!1)});var l=function(a,b,c){b=b[a];void 0!==b&&(c[a]=b)},n=function(a,b,c){b=b[a];d.isFunction(b)&&(c[a]=b)},x=function(a,b){var c=a[b];c&&(a.args?c.apply(a.context,a.args):c.call(a.context,a.elem))},s=function(a,b){var c=a[b];c&&a.elem.css(c)};a.Animation=function(a,p){this.elem=a;this.time=void 0!==
p.time?p.time:120;n("startFn",p,this);n("stepFn",p,this);n("endFn",p,this);l("context",p,this);p.args&&(this.args=Array.prototype.slice.call(p.args,0),this.args.unshift(a));l("startCSS",p,this);l("endCSS",p,this);this.transFn=g[p.transition]||c;for(var e=b.disableAnimation||0>=this.time,q=0;q<f.length;q++){var s=f[q],v=p[s];if(void 0!==v){var D=a[s];this.props||(this.props={});this.props[s]={start:D,end:v};e|=k[s]}}e||!this.props?this.finish():(m.push(this),a.data("_animation",this),a.addClass("oit-animating"),
d.requestAnimationFrame(h))};a=a.subclass(a.Animation);a.isEmpty=function(){return 0>=this.time||!this.props};a.step=function(a){var b=!1;this.elem&&void 0===this.startTime&&(s(this,"startCSS"),x(this,"startFn"),this.startTime=a,this.steps=0);if(this.elem&&(this.steps++,a-=this.startTime,a=a>=this.time?1:this.transFn(a,this.time),1>a)){var b=this.props,c;for(c in b){var d=b[c];this.elem[c]=d.start+(d.end-d.start)*a}x(this,"stepFn");b=!0}b||this.finish();return b};a.finish=function(){var a=this.elem;
if(a){var b=this.props;if(this.steps&&4>this.steps)for(var c in b)k.hasOwnProperty(c)&&(k[c]=!0);p(this);void 0===this.startTime&&(s(this,"startCSS"),x(this,"startFn"));for(c in b)a[c]=b[c].end;s(this,"endCSS");x(this,"endFn");this.deleteAll()}};a.abort=function(){this.elem&&(p(this),this.deleteAll())}});OIT.extend(function(a){var b=a.glob,d=a.doc,c=a.util,g=a.css,f=a.dialog,k=a.math,m=OIT.local,h=[];a.DialogBox=function(c){a.Element.call(this,"div","oit-dialog");c=c||{};this._resizable=this._moveable=this._modal=this._visible=!1;h.push(this);this.css("opacity",0);this._form=d.create("form",this);this.move(c.x,c.y,c.width,c.height);void 0!==c.className&&this.addClass(c.className);void 0!==c.moveable&&this.moveable(c.moveable);void 0!==c.resizable&&this.resizable(c.resizable);void 0!==c.modal&&this.modal(c.modal);
void 0!==c.resultFn&&(this._resultFn=c.resultFn);void 0!==c.destroyFn&&(this._destroyFn=c.destroyFn);void 0!==c.title&&this.title(c.title);void 0!==c.textColor&&this.css("color",c.textColor);void 0!==c.backgroundColor&&this._form.css("background-color",c.backgroundColor);c.cancel&&(s(this,m.CANCEL,this.cancel),this.onkeydown(w));c.ok&&s(this,m.OK,this.ok);c.no&&s(this,m.NO,this.no);c.yes&&s(this,m.YES,this.yes);b.rootNode.append(this)};var p=a.subclass(a.DialogBox,a.Element),l=function(a){a=this.pos();
this._dragX=a.left;this._dragY=a.top;this._header.css("cursor",g.cursor.grabbing)},n=function(a){this.move(this._dragX+a.delta.x,this._dragY+a.delta.y);this._header.css("cursor",g.cursor.grabbing)},x=function(a){this._header.css("cursor",g.cursor.grab)},s=function(b,c,e){b._footer||(b._footer=d.create("footer",b),b._footerVisible=!0);c=new a.Button(c);b._footer.append(c);c.onclick(b,e);c.ontap(b,e)},w=function(a){return 27==a.keyCode?(c.preventDefault(a),!1):!0},t=function(a){var b=0;a._header&&(a._header.css("cursor",
a._moveable?g.cursor.grab:null),b=a._header.offsetHeight);if(a._footer&&a._footerVisible)a._footer.css("display",null),a._form.css({height:null,position:"absolute",top:b+"px",left:"0px",right:"0px",bottom:a._footer.offsetHeight+"px"});else{a._footer&&a._footer.css("display","none");var c=null;0<b&&(c=a.clientHeight-b+"px");a._form.css({position:null,left:null,right:null,top:null,bottom:null,height:c})}};p.destroy=function(){this.cancel();this.show(!1,{animate:!1});this._destroyFn&&this._destroyFn(this);
c.remove(h,this);a.Element.prototype.destroy.call(this)};p.exit=function(){this.cancel();this.show(!1,{endFn:this.destroy,context:this})};p.moveable=function(a){if(!0===a||!1===a)this._moveable=a,t(this);return this._moveable};p.resizable=function(a,b,c){if((!0===a||!1===a)&&a!=this._resizable){this._resizable=a;var e,d;this._resizable?(this.addClass("oit-dialog-resizable"),void 0!==b&&(e=b+"px"),void 0!==c&&(d=c+"px")):this.removeClass("oit-dialog-resizable");this.css({"min-width":e,"min-height":d})}return this._resizable};
p.modal=function(a){if((!0===a||!1===a)&&a!==this._modal)this._modal=a,f.showModalOverlay(this._modal);return this._modal};p.title=function(a){if(a){var b;this._header||(this._header=d.create("header"),this.insert(this._header,this.firstChildElem()),this._header.ondragstart(this,l),this._header.ondragmove(this,n),this._header.ondragend(this,x),this._header.ondragcancel(this,x));b=this._header;this._title||(this._title=d.create(),b.append(this._title));this._title.html(a);this._title.css("display",
null);b.addClass("oit-dialog-header-shaded");t(this)}else null===a&&(this._title&&(this._title.destroy(),delete this._title),this._header&&(this._header.destroy(),delete this._header),t(this));return this._title?this._title.text():void 0};p.resetForm=function(){this._form.html("")};p.addLabel=function(a,b){var c=d.create("label",this._form);c.html(a);b&&b.style&&c.css(b.style);return c};p.addTextArea=function(b,c){b&&(this.addLabel(b),d.create("br",this._form));var e=new a.TextArea;this._form.append(e);
c&&(c.style&&e.css(c.style),c.placeholder&&e.attr("placeholder",c.placeholder));return e};p.show=function(a,b){!1!==a&&(a=!0);a&&(this._result=void 0);this.finishAnimation();if(this._visible==a)b&&(b.startFn&&b.startFn.call(b.context,this),b.endFn&&b.endFn.call(b.context,this));else{b=b||{};var c=0;!1!==b.animate&&(c=200);a?(this.startFn=b.startFn,this.startContext=b.context,this.animate({opacity:1,time:c,startCSS:{opacity:0,display:"block"},startFn:e,endFn:b.endFn,context:this}),this._visible=!0,
this._modal&&f.showModalOverlay(!0,c)):(this.animate({opacity:0,time:c,startFn:b.startFn,endCSS:{display:null},endFn:b.endFn,context:b.context}),this._visible=!1,this._modal&&f.showModalOverlay(!1,c))}return this._visible};var e=function(){t(this);this.startFn&&this.call(this.startContext,this);delete this.startFn;delete this.startContext};p.showFooter=function(a){if((!0===a||!1===a)&&a!==this._footerVisible)this._footerVisible=!1!==a,t(this);return this._footerVisible};p.move=function(a,c,e,d,f){var h=
b.viewNode,g=h.size(),h=h.pos();void 0===e&&(e=this.offsetWidth);var l=g.width-10-10;e>l&&(e=l);void 0===d&&(d=this.offsetHeight);l=g.height-10-10;d>l&&(d=l);void 0!==a&&(l=h.left+g.width-10-e,a>l&&(a=l),a=k.round(a));void 0!==c&&(g=h.top+g.height-10-d,c>g&&(c=g),c=k.round(c));this._visible&&a!==this.offsetLeft||c!==this.offsetTop||e!==this.innerWidth||d!=this.innerHeight?(g=f&&!0===f.animate?200:0,f&&(this.moveOptions=f),this.css("overflow","hidden"),this.animate({offsetLeft:a,offsetTop:c,innerWidth:e,
innerHeight:d,time:g,endCSS:{overflow:null},endFn:q,context:this})):f&&f.endFn&&f.endFn.call(f.context,this)};var q=function(){t(this);var a=this.moveOptions;a&&a.endFn&&a.endFn.call(a.context,this);delete this.moveOptions};p.autoSize=function(a,b,c,e,d){(c=this.hasClass("oit-animating"))&&this.removeClass("oit-animating");var f=["width","height","display","opacity"];e=this.css(f);this.removeStyle(f);this.css("display","block");this.css("opacity","1");var f=this.offsetWidth,h=this.offsetHeight;this.css(e);
c&&this.addClass("oit-animating");this.move(a,b,f,h,d)};p.maxsize=function(a,b){var c={};void 0!=a&&(c["max-width"]=0===a?null:a+"px");void 0!=b&&(c["max-height"]=0===b?null:b+"px");this.css(c)};var y=function(a,b){a._visible||a.css("display","block");var c=a[b];a._visible||a.css("display",null);return c};p.width=function(){return y(this,"offsetWidth")};p.height=function(){return y(this,"offsetHeight")};var v=function(a,b){void 0===a._result&&(a._result=b,a._resultFn&&a._resultFn(a,b))};p.cancel=
function(){v(this,!1)};p.ok=function(){v(this,!0)};p.no=function(){v(this,0)};p.yes=function(){v(this,1)};p.result=function(){return this._result};a.on("document","reset",function(){for(;0<h.length;)h.shift().destroy()})});OIT.extend(function(a){a.export("TextRange",function(a,d){if(a>d){var c=a;a=d;d=c}this.type="text";this.acc=a;this.accend=d})});OIT.extend(function(a){a.export("CellRange",function(b,d,c,g,f,k,m,h,p){if(d>g){var l=d;d=g;g=l}c>f&&(l=c,c=f,f=l);this.type="cell";this.page=b;this.section=a.pages.page(b).section;this.c1=d;this.r1=c;this.c2=g;this.r2=f;void 0!==k&&(this.offsets="number"===typeof k?{left:k,top:m,right:h,bottom:p}:{left:k.left,top:k.top,right:k.right,bottom:k.bottom})})});OIT.extend(function(a){a.export("RectRange",function(b,d,c,g,f,k,m){if(c>f){var h=c;c=f;f=h}g>k&&(h=g,g=k,k=h);this.type="rect";void 0!==b&&(this.embedId=b);this.page=d;this.section=a.pages.page(d).section;this.left=c;this.top=g;this.right=f;this.bottom=k;this.units=m})});OIT.extend(function(a){var b=a.doc;a.DrawingObject=function(c,d,k){a.Element.call(this,"div",d);this._layer=c;this._visible=!0;k?k.append(this):c.append(this);b.attach(this);this.changed()};var d=a.subclass(a.DrawingObject,a.Element);d.createChild=function(b){return new a.DrawingChildObject(this,b)};d.layer=function(){return this._layer};d.moveToTop=function(){this.parent().append(this)};d.addClass=function(b){this.hasClass(b)||(a.Element.prototype.addClass.apply(this,arguments),delete this._borderOffset,
this.changed());return this};d.removeClass=function(b){this.hasClass(b)&&(a.Element.prototype.removeClass.apply(this,arguments),delete this._borderOffset,this.changed());return this};d.defaultSize=function(){if(!this._defaultSize){var a=["transform","display","width","height"],b=this.css(a);this.removeStyle(a);this._defaultSize={width:this.offsetWidth,height:this.offsetHeight};this.css(b)}return this._defaultSize};d.setDefaultSize=function(a){this._defaultSize=a};d.resetDefaultSize=function(){this._defaultSize&&
(this._defaultSize=null)};d.setTitle=function(a){this.attr("title",a)};d.show=function(a){!1!==a&&(a=!0);a!==this._visible&&((this._visible=a)?(this.css("display",null),this.changed()):this.css("display","none"));return this};d.hide=function(){return this.show(!1)};d.visible=function(){return this._visible&&this._layer.visible()};d.layoutObject=function(){if(!this._animating&&this.visible()){var a=this.position();if(a){var b={};b.left=a.left;this._borderOffset&&(b.left-=this._borderOffset.left);b.left+=
"px";b.top=a.top;this._borderOffset&&(b.top-=this._borderOffset.top);b.top+="px";b.width=a.width+"px";b.height=a.height+"px";this.css(b);this._borderOffset||(this._borderOffset={left:this.clientLeft,top:this.clientTop},this._borderOffset.left&&this.css("left",a.left-this._borderOffset.left+"px"),this._borderOffset.top&&this.css("top",a.top-this._borderOffset.top+"px"))}}return this};d.changed=function(){this._dirty||(this._dirty=!0,this._parentObject?this._parentObject.childChanged(this):this._layer.changed(this));
return this};d.childChanged=function(a){this._dirty||(this._parentObject?this._parentObject.childChanged(this):this._layer.changed(this));return this};d.update=function(a){this._dirty&&(a=!0,this._dirty=!1);a&&this.layoutObject();this.queryChildElements(c,a);return this};var c=function(a,b,c){a.update&&a.update(c)}});OIT.extend(function(a){a.DrawingChildObject=function(b,c){c=c||{};a.DrawingObject.call(this,b.layer(),c.classList,b);this._parentObject=b;c.title&&this.setTitle(c.title);var g=c.margin||0;this._margin={left:g,top:g,right:g,bottom:g};void 0!==c.hpos&&(this._hpos=c.hpos);void 0!==c.vpos&&(this._vpos=c.vpos);!0===c.inheritMoveable&&(this.inheritMoveable=!0)};var b=a.subclass(a.DrawingChildObject,a.DrawingObject);b.resize=function(a,b){if(void 0!==a||void 0!==b){if(!this._size||this._size.width!==a||
this._size.height!==b)this._size={width:a,height:b},this.changed()}else this._size&&(delete this._size,this.changed());return this};b.setMargin=function(a,b,g,f){var k=!1;void 0!==a&&a!==this._margin.left&&(this._margin.left=a,k=!0);void 0!==b&&b!==this._margin.top&&(this._margin.top=b,k=!0);void 0!==g&&g!==this._margin.right&&(this._margin.right=g,k=!0);void 0!==f&&f!==this._margin.bottom&&(this._margin.bottom=f,k=!0);k&&(this._pos&&(this._pos=void 0),this.changed());return this};b.position=function(){if(this._parentObject){var b=
this._parentObject.position()||this._parentObject.defaultSize();if(this._pos&&b.width!=this._parentWidth||b.height!=this._parentHeight)this._pos=void 0;if(void 0===this._pos){this._parentWidth=b.width;this._parentHeight=b.height;var c,g,f,k;if("fill"===this._hpos)c=this._margin.left,f=b.width-this._margin.left-this._margin.right;else if(void 0!==this._hpos)if(f=this._size&&0<this._size.width?this._size.width:this.defaultSize().width,"number"===typeof this._hpos)c=0<=this._hpos?this._margin.left+this._hpos:
b.width-this._margin.right-f+this._hpos;else switch(this._hpos){case "left":c=this._margin.left;break;case "center":c=(b.width-f)/2;break;case "right":c=b.width-this._margin.right-f}if("fill"===this._vpos)g=this._margin.top,k=b.height-this._margin.top-this._margin.bottom;else if(void 0!==this._vpos)if(k=this._size&&0<this._size.height?this._size.height:this.defaultSize().height,"number"===typeof this._vpos)g=0<=this._vpos?this._margin.top+this._vpos:b.height-this._margin.bottom-k+this._vpos;else switch(this._vpos){case "top":g=
this._margin.top;break;case "middle":g=(b.height-k)/2;break;case "bottom":g=b.height-this._margin.bottom-k}void 0!==c||void 0!==g||void 0!==f||void 0!==k?(void 0===c&&(c=0),void 0===g&&(g=0),void 0===f&&(f=this.defaultSize().width),void 0===k&&(k=this.defaultSize().height),this._pos=new a.Rectangle(c,g,c+f,g+k,"overlay")):this._pos=null}}return this._pos}});OIT.extend(function(a){var b=a.math;a.DrawingObjectLabel=function(b){a.DrawingChildObject.call(this,b,{hpos:"center",vpos:"middle",classList:"oit-highlight-label",inheritMoveable:!0})};var d=a.subclass(a.DrawingObjectLabel,a.DrawingChildObject);d.destroy=function(){this._parentObject&&this._parentObject.attr("title",null);a.DrawingChildObject.prototype.destroy.call(this)};d.setText=function(a){this._labelText=a=a||"";this.html(a);this.setTitle(a);this.resetDefaultSize();this.changed()};d.setColor=
function(a,b){this.css("color",a)};d.setBoundingRect=function(a){a?this._parentRect=a.clone():delete this._parentRect;this.show()};d.position=function(){if(this._parentObject){var c=this._parentRect||this._parentObject.position();this.css("transform",null);this.showLabelText=!0;this.html(this._labelText);var d="",f=this.defaultSize(),k=f.width+4,m=f.height+4,h=!1;if(k>c.width||m>c.height){if(k>m&&c.width<c.height||k<m&&c.width>c.height)f={width:f.height,height:f.width},k=f.width+4,m=f.height+4,d=
"rotate(270deg)",h=!0;if(k>c.width||m>c.height){var p=b.round(Math.min(c.width/k,c.height/m),1E3);0.4>p?(d="",this.html(""),this.showLabelText=!1):(d+="scale("+p+","+p+")",k=f.width*p+4,m=f.height*p+4)}}this.css("transform",d);if(this.showLabelText)return d=c.left+(c.width-k)/2,c=c.top+(c.height-m)/2,h&&(c+=m),k=d+k,m=c+m,this.show(),new a.Rectangle(d,c,k,m,"overlay");this.hide()}}});OIT.extend(function(a){var b=a.doc,d=a.util;a.RectActivation=function(b){a.DrawingChildObject.call(this,b,{hpos:"fill",vpos:"fill",classList:"oit-activation",inheritMoveable:!0})};var c=a.subclass(a.RectActivation,a.DrawingChildObject);c.setResizable=function(a){if(a){this._resizable||(this.addClass("oit-resize"),g(this,"oit-resize-n",!1,!0,!1,!1),g(this,"oit-resize-s",!1,!1,!1,!0),g(this,"oit-resize-e",!1,!1,!0,!1),g(this,"oit-resize-w",!0,!1,!1,!1),g(this,"oit-resize-ne",!1,!0,!0,!1),g(this,"oit-resize-nw",
!0,!0,!1,!1),g(this,"oit-resize-se",!1,!1,!0,!0),g(this,"oit-resize-sw",!0,!1,!1,!0));var b=a.margin||0;0>b&&this.setMargin(b,b,b,b);this._resizable=a}else this._resizable&&(this._resizeHandles&&(d.each(this._resizeHandles,"destroy"),delete this._resizeHandles),delete this._resizable,this.removeClass("oit-resize"))};var g=function(a,c,d,f,g,w){c=b.create("div",c);c.on("dragstart",a,k,d,f,g,w);c.on("dragmove",a,m);c.on("dragend",a,h);c.on("dragcancel",a,h);a.append(c);a._resizeHandles||(a._resizeHandles=
[]);a._resizeHandles.push(c)},f=function(a,b,c){b=b._parentObject;b.dispatchCustom(a,{drawingRect:b,newRect:c.curRect,moved:c.resized})},k=function(a,b,c,d,h){a=this._parentObject.position();this.resizeInfo=b={left:b,top:c,right:d,bottom:h,startRect:a.clone(),curRect:a.clone(),resized:!1};f("resizestart",this,b)},m=function(a){var b=this.resizeInfo;this.calculateResize(b,a);b.resized=!0;f("resizemove",this,b);if(!this._resizable.bindToObject){a=this._parentObject.position();var c=this._resizable&&
this._resizable.margin?this._resizable.margin:0;this.setMargin(c+b.curRect.left-a.left,c+b.curRect.top-a.top,c+a.right-b.curRect.right,c+a.bottom-b.curRect.bottom)}},h=function(a){a=this.resizeInfo;if(!this._resizable.bindToObject){var b=this._resizable&&this._resizable.margin?this._resizable.margin:0;this.setMargin(b,b,b,b)}f("resizeend",this,a);delete this.resizeInfo};c.calculateResize=function(a,b){var c=b.delta.x,d=b.delta.y,f=a.startRect.left,h=a.startRect.top,g=a.startRect.right,e=a.startRect.bottom;
a.left?(f+=c,g-f<this._resizable.minWidth&&(f=g-this._resizable.minWidth)):a.right&&(g+=c,g-f<this._resizable.minWidth&&(g=f+this._resizable.minWidth));a.top?(h+=d,e-h<this._resizable.minHeight&&(h=e-this._resizable.minHeight)):a.bottom&&(e+=d,e-h<this._resizable.minHeight&&(e=h+this._resizable.minHeight));return f!=a.curRect.left||h!=a.curRect.top||g!=a.curRect.right||e!=a.curRect.bottom?(a.curRect.move(f,h,g,e),!0):!1}});OIT.extend(function(a){var b=a.doc,d=a.glob,c=a.util,g=a.pages,f=a.range,k;a.TextActivation=function(b){a.DrawingChildObject.call(this,b,{hpos:"fill",vpos:"fill",classList:"oit-activation"});this._range=f.clone(b._range);this._startHandle=h(this,p);this._endHandle=h(this,l)};var m=a.subclass(a.TextActivation,a.DrawingChildObject),h=function(c,e){var d=new a.DrawingChildObject(c,{hpos:0,vpos:0,classList:"oit-text-handle"});d.append(b.create("div")).append(b.create("div")).ondragstart(c,e).ondragmove(c,
x).ondragend(c,s).ondragcancel(c,s);return d};m.showHandles=function(a){a=!1!==a?null:"none";this._startHandle.css("display",a);this._endHandle.css("display",a)};var p=function(a){var b=this._range;n(this,this._startHandle,a,b.accend,b.acc)},l=function(a){var b=this._range;n(this,this._endHandle,a,b.acc,b.accend)},n=function(a,b,c,f,h){a._anchor=f;a._focus=h;b=b.pos(d.viewNode);c=c.center;a._adjust={x:16-(c.x-b.left),y:-(c.y-b.top)}},x=function(a){var b=a.center;if(b&&(a=this._parentObject,b=g.mapToPage(b.x+
this._adjust.x,b.y+this._adjust.y,null,!0))){if(void 0===this._textAnchorRoot){var d=b.page.findACC(a._range.acc);this._textAnchorRoot=d?c.getTextRoot(d[0]):null}if(d=b.page.mapPointToText(b.x,b.y,this._textAnchorRoot))d=d.acc,d!=this._focus&&(this._focus=d,this._focus>=this._anchor?(this._range.acc=this._anchor,this._range.accend=this._focus):(this._range.acc=this._focus,this._range.accend=this._anchor),this.changed(),a.setRange(this._range),a.dispatchCustom("textmove",{range:this._range,page:b.page}))}},
s=function(a){a=this._parentObject;a.setRange(this._range);a.dispatchCustom("textmoveend",{range:this._range});delete this._anchor;delete this._focus;delete this._adjust};m.layoutObject=function(){if(this.visible()){var b=this._parentObject;a.DrawingChildObject.prototype.layoutObject.call(this);k||(k=this._startHandle.defaultSize());var c=this._parentObject.position(),d;c?(this.show(),d=w(this._startHandle,c,b.startHandleRect()),c=w(this._endHandle,c,b.endHandleRect()),!d&&!c&&(d=g.pagesForRange(b._range),
this.show(d&&-1!=d.indexOf(b._page)))):this.hide()}};var w=function(a,b,c){c?(a.setMargin(c.left-b.left-k.width/2,c.bottom-b.top-1),a.resize(k.width,k.height),a.show()):a.hide();return c}});OIT.extend(function(a){var b=a.util;a.DrawingShape=function(b,c,d){a.DrawingObject.call(this,c,d);this._pos=new a.Rectangle(0,0,0,0,"overlay")};var d=a.subclass(a.DrawingShape,a.DrawingObject);d.setLabel=function(a,c,d){if(a){if(d=d||"#FFF",a!==this._labelText||c!=this._labelColor||d!=this._backgroundColor)if(this._labelText=a,this._labelColor=c||"#000",this._labelBackground=d||"#FFF",this.setTitle(this._labelText),this._labels)for(a=0;a<this._labels.length;a++)c=this._labels[a],c.setText(this._labelText),
c.setColor(this._labelColor,this._labelBackground)}else this._labelText&&(delete this._labelText,delete this._labelColor,delete this._labelBackground,this.setTitle(""),this._labels&&(b.each(this._labels,"destroy"),delete this._labels));this.changed()};d.allocateLabelChildren=function(b){this._labels||(this._labels=[]);for(;this._labels.length<b;){var c=new a.DrawingObjectLabel(this);this._labels.push(c);c.setText(this._labelText);c.setColor(this._labelColor,this._labelBackground)}for(;this._labels.length>
b;)this._labels.pop().destroy();return this._labels};d.labelChildCount=function(){return this._labels?this._labels.length:0};d.getLabelChild=function(a){if(this._labels)return this._labels[a]};d.move=function(a,b,d,h,p){this._pos.movesize(a,b,d,h)&&(this.changed(),this.finishAnimation(),p&&(a=this.position(),p.stepFn&&(this.stepMoveFn=p.stepFn),p.endFn&&(this.endMoveFn=p.endFn),p={offsetLeft:a.left,offsetTop:a.top,innerWidth:a.width,innerHeight:a.height,transition:p.transition||"ease",time:p.timems,
startFn:p.startFn,stepFn:c,endFn:g,context:this},this._animating=!0,this.animate(p)));return this};var c=function(a){this.update(!0);this.stepMoveFn&&this.stepMoveFn(this)},g=function(a){delete this._animating;this.changed();this.endMoveFn&&this.endMoveFn(this);delete this.stepMoveFn;delete this.endMoveFn};d.resize=function(a,b){return this.move(void 0,void 0,a,b)};d.position=function(){return this._pos}});OIT.extend(function(a){a.DrawingRect=function(b,c,g){a.DrawingShape.call(this,b,c,g)};var b=a.subclass(a.DrawingRect,a.DrawingShape);b.customEvent("resizestart");b.customEvent("resizemove");b.customEvent("resizeend");b.activate=function(b,c){this._rectActivation||(this._rectActivation=new a.RectActivation(this),c&&this.insertFirst(this._rectActivation),this._resizable&&this._rectActivation.setResizable(this._resizable));this.moveToTop();return this};b.deactivate=function(){this._rectActivation&&(this._rectActivation.destroy(),
delete this._rectActivation);return this};b.resizable=function(a,b){if(!0===a){b=b||{};var g=!0,f=b.minWidth||0,k=b.minHeight||0,m=b.margin||0;!1===b.bindToObject&&(g=!1);if(!this._resizable||this._resizable.bindToObject!=g||this._resizable.onResizeStart!=b.onResizeStart||this._resizable.onResize!=b.onResize||this._resizable.onResizeEnd!=b.onResizeEnd||this._resizable.onResizeCancel!=b.onResizeCancel||this._resizable.context!==b.context||this._resizable.minWidth!=f||this._resizable.minHeight!=k||
this._resizable.margin!=m)this._resizable={bindToObject:g,minWidth:f,minHeight:k,margin:m},b.onResizeStart&&(this._resizable.onResizeStart=b.onResizeStart),b.onResize&&(this._resizable.onResize=b.onResize),b.onResizeEnd&&(this._resizable.onResizeEnd=b.onResizeEnd),b.onResizeCancel&&(this._resizable.onResizeCancel=b.onResizeCancel),this._resizable.context=b.context||this,this._rectActivation&&this._rectActivation.setResizable(this._resizable)}else this._resizable&&!1===a&&(delete this._resizable,this._rectActivation&&
this._rectActivation.setResizable(null));return this};b.layoutObject=function(){if(this.visible()&&!this._animating&&(a.DrawingShape.prototype.layoutObject.call(this),this._labelText)){var b=this.position().clone();b.left=0;b.top=0;this.allocateLabelChildren(1)[0].setBoundingRect(b)}return this}});OIT.extend(function(a){var b=a.range,d=a.pages;a.TextRect=function(b,c,g){a.DrawingShape.call(this,b,c,g);this._page=d.page(b)};var c=a.subclass(a.TextRect,a.DrawingShape);c.customEvent("textmove");c.customEvent("textmoveend");c.activate=function(b){this._textActivation||(this._textActivation=new a.TextActivation(this));this._textActivation.showHandles(this._showHandles);this.moveToTop();return this};c.deactivate=function(){this._textActivation&&(this._textActivation.destroy(),delete this._textActivation);
return this};c.setRange=function(a){if(a&&"text"===a.type)if(this._range){if(this._range.acc!=a.acc||this._range.accend!==a.accend)this._range.acc=a.acc,this._range.accend=a.accend,this.changed()}else this._range=b.clone(a),this.changed();return this};c.showTextHandles=function(){this._showHandles=!0;this._textActivation&&this._textActivation.showHandles(!0);return this};c.hideTextHandles=function(){this._showHandles=!1;this._textActivation&&this._textActivation.showHandles(!1);return this};c.layoutObject=
function(){if(this.visible()&&!this._animating){var b=this._page.textBoundingRect(this._range);b&&(b.origin=!0==this._page.bNotesBar?"view":"overlay",this.move(b.left,b.top,b.width,b.height));a.DrawingShape.prototype.layoutObject.call(this);if(this._labelText){var c=this._page.textRects(this._range,"overlay"),b=this._page.textBoundingRect(this._range);if(c&&b&&(b.origin="overlay",this.allocateLabelChildren(c.length),0<this._labels.length))for(var d=this.getLabelChild(0).defaultSize(),h=0;h<this._labels.length;h++){var g=
this.getLabelChild(h);g.setDefaultSize(d);this._moveable?g.addClass("oit-moveable"):g.removeClass("oit-moveable");var l=c[h].interiorRect(d,!0);l&&l.offset(-b.left,-b.top);g.setBoundingRect(l)}}}return this};var g=function(a,b,c){var d=a._page.accRect(b,"overlay");if(!d&&(d=a._page.accRect(b+c,"overlay"),!d&&(d=a._page.accRect(b-c,"overlay"))))d.left=d.right;d&&(d.width=0);return d};c.startHandleRect=function(){if(this._range)return g(this,this._range.acc,1)};c.endHandleRect=function(){if(this._range)return g(this,
this._range.accend,-1)}});OIT.extend(function(a){var b=a.doc;a.DrawingLayer=function(c,d,k){a.Element.call(this,"div","oit-drawinglayer-"+d,k);this._drawing=c;this._name=d;this._visible=!0;b.attach(this);c.append(this);this.show()};var d=a.subclass(a.DrawingLayer,a.Element);d.drawing=function(){return this._drawing};d.show=function(a){void 0===a&&(a=!0);a!==this._visible&&(!0===a?(this._visible=!0,this.css("display",null),this.update(!0)):!1===a&&(this._visible=!1,this.css("display","none")))};d.hide=function(){this.show(!1)};
d.visible=function(){return this._visible};d.update=function(a){this.queryChildElements(c,a)};var c=function(a,b,c){a.update&&a.update(c)};d.changed=function(){this._drawing.changed()}});OIT.extend(function(a){var b=a.doc,d=a.util;a.Drawing=function(c){a.Element.call(this,"div","oit-drawingpanel");b.attach(this);this._origin=null;c.append(this);c.onscroll(this,this.updateScroll)};var c=a.subclass(a.Drawing,a.Element);c.destroy=function(){var b=this.parent();b&&b.offscroll(this.updateScroll);a.Element.prototype.destroy.call(this)};c.update=function(a){!0!==a&&(a=!1);this._animationFrame&&(this._animationFrame=null);this.queryChildElements(g,a)};var g=function(a,b,c){a.update&&a.update(c)};
c.changed=function(){this._animationFrame||(this._animationFrame=d.requestAnimationFrame(this.update,this))};c.setOrigin=function(a,b){if(this._origin){if(this._origin.x!=a||this._origin.y!=b)this._origin.x=a,this._origin.y=b,this.updateScroll()}else this._origin={x:a,y:b},this.updateScroll()};c.resetOrigin=function(){this._origin&&(this._origin=null,this.css({left:null,top:null}))};c.updateScroll=function(){if(this._origin){var a=this.parent().scroll();this.css({left:this._origin.x+a.left+"px",top:this._origin.y+
a.top+"px"})}}});OIT.extend(function(a){var b=a.doc,d=a.hyperlinks,c=a.stylemap,g=a.css;a.SpanSplit=function(b,c,d){a.Element.call(this,b);this.acc=c;this.accend=d;if(b=b.parentNode)if((b=b.className)&&"oit-slidenotes"==b)this.bSlideNote=!0;void 0===this.accend&&(this.accend=c+this.text().length)};var f=a.subclass(a.SpanSplit,a.Element);f.destroy=function(){this.unload();a.Element.prototype.destroy.call(this)};f.unload=function(){m(this,null,null)};f.text=function(a){if(void 0!==a){var b=this._anchor||this;b.destroyChildren();
b.dom.textContent=a}return this.dom.textContent};f.textNode=function(){return(this._anchor||this).dom.firstChild};f.createSplit=function(b){var c=new a.SpanSplit("span",this.acc,b);this.copyDataTo(c);var d=this.text(),f=b-this.acc;c.text(d.substring(0,f));this.text(d.substring(f));this.acc=b;this._changed=!0;return c};f.mergeSplit=function(a){var b=this.text()+a.text();this.text(b);this.accend=a.accend;this._changed=!0;a.destroy()};f.dataEquals=function(a){var b=!1,c=this._data;a=a._data;if(c){if(a&&
c.length==a.length)for(var b=!0,d=0;d<c.length;d++){var f=c[d],g=a[d];if(f.type!==g.type||f.id!==g.id){b=!1;break}}}else b=!a;return b};f.addData=function(a){this._data||(this._data=[]);"hyperlink"===a.type?this._data.unshift(a):this._data.push(a);this._changed=!0};f.removeData=function(a,b){if(this._data)for(var c=0;c<this._data.length;c++){var d=this._data[c];if(d.type===a&&d.id===b){this._data.splice(c,1);0==this._data.length&&delete this._data;this._changed=!0;break}}};f.copyDataTo=function(a){this._data&&
(a._data=a._data?a._data.concat(this._data):this._data.slice(0),a._changed=!0)};f.moveDataTo=function(a){this._data&&(k(this,null,null,null),a._data=a._data?a._data.concat(this._data):this._data,delete this._data,this._changed=!0,a._changed=!0)};f.updateData=function(){if(this._changed){var a,b,c;if(this._data)for(var d=0;d<this._data.length;d++){var f=this._data[d];if("style"===f.type)for(var m in f.props){if(f.props.hasOwnProperty(m)){var w=f.props[m];if(c&&"background-color"==m){var t=c[m];t&&
(w=g.blendColors(w,t))}c||(c={});c[m]=w}}else"hyperlink"===f.type?a=f:"bookmark"===f.type&&(b=f)}k(this,c,a,b);this._changed=!1}};var k=function(a,b,d,f){b?(b=c.styleName(b),b!=a._splitClass&&(a._splitClass&&a.removeClass(a._splitClass),a.addClass(b),a._splitClass=b)):a._splitClass&&(a.removeClass(a._splitClass),delete a._splitClass);m(a,d,f)},m=function(a,c,f){var g=a._anchor;if(c||f){var k=c&&0==c.url.indexOf("#");g||(g=k?a._anchor=b.create("span"):a._anchor=b.create("a"),g.text(a.text()),a.html(""),
a.append(g));c&&(a.addClass("oit-hyperlink"),k||g.attr("href",c.url),d.on.addElement(g,c));f&&g.attr("id",f.id)}else g&&(d.on.removeElement(g),c=g.text(),g.destroy(),delete a._anchor,a.removeClass("oit-hyperlink"),a.html(c))}});OIT.extend(function(a){var b=a.range,d=a.math,c=a.util,g=/^[^\u0591-\u07ff\u200f\u202b\u202e\ufb1d-\ufdfd\ufe70-\ufefc]*?[\u0591-\u07ff\u200f\u202b\u202e\ufb1d-\ufdfd\ufe70-\ufefc]/;a.SpanInfo=function(b,c){a.SpanSplit.call(this,b,c)};var f=a.subclass(a.SpanInfo,a.SpanSplit);f.unload=function(){this.discardLayout();c.each(this._splits,"unload");a.SpanSplit.prototype.unload.call(this)};f.discardLayout=function(){delete this._charRects;delete this._spanRect};f.distanceFromPoint=function(a,b,c){return Math.abs(this.spanRect(a).distanceFrom(b,
c))};f.overlapRange=function(a,c){var d=this.spanRect(a);if(d.overlaps(c)){if(c.contains(d))return b.textRange(this.acc,this.accend);if(d=m(this,a)){for(var f,g,k=0;k<d.length;k++)c.overlaps(d[k])&&(g=this.acc+k,void 0===f&&(f=g),g+=1);if(void 0!==f)return b.textRange(f,g)}}};f.spanRect=function(b){if(!this._spanRect&&b){if(!b)throw"Missing page in SpanInfo.spanRect";this._spanRect=new a.Rectangle(this.rect(b.overlay),"overlay");this._spanRect.origin=b}return this._spanRect};f.textAngle=function(){void 0===
this._angle&&(this._angle=this.ancestorData("angle"),this._angle=void 0!==this._angle?d.radians(Number(this._angle)):0);return this._angle};f.rtl=function(){void 0===this._rtl&&(this._rtl=!!g.test(this.text()));return this._rtl};f.findClosestChar=function(a,b,c){var d=m(this,c),f,g;for(c=0;c<d.length;c++){var k=Math.abs(d[c].distanceFrom(a,b,"left","middle"));if(void 0===f||k<g)f=c,g=k,c==d.length-1&&(k=d[c].distanceFrom(a,b,"center","none"),0<k&&f++)}var t,e;if(this._splits){a=this._splits;for(c=
b=0;c<a.length;c++){g=a[c].textNode();d=b+g.textContent.length;if(f>=b&&f<d){t=g;e=f-b;break}b=d}t||(t=a[a.length-1].textNode(),e=t.textContent.length)}else t=this.textNode(),e=f;return{node:t,offset:e,acc:this.acc+f}};f.textRect=function(b,c){if(b.acc<=this.acc&&b.accend>=this.accend)return new a.Rectangle(this.spanRect(c));if(b.acc<this.accend&&b.accend>this.acc){var d=m(this,c);if(d){var f,g=b.acc-this.acc;0>g&&(g=0);var k=b.accend-this.acc;k>d.length&&(k=d.length);f=!0==this.bSlideNote?new a.Rectangle(d[g],
"view"):new a.Rectangle(d[g],c);k==g&&(f.width=0);for(g+=1;g<k;g++)f.union(d[g]);return f}}};f.findTextRange=function(a,b){var c,d,f,g,k=this._splits;if(k){if(a.acc<=this.acc&&(c=k[0].textNode(),d=0),a.accend>=this.accend&&(f=k[k.length-1].textNode(),g=f.textContent.length),!c||!f)for(var m=0;m<k.length;m++){var e=k[m];if(a.accend<e.acc)break;if(!c&&a.acc<e.accend&&(c=e.textNode(),d=a.acc-e.acc,0>d&&(d=0),f))break;if(c&&!f&&a.accend<=e.accend){f=e.textNode();g=a.accend-e.acc;0>g&&(g=0);break}}}else c=
f=this.textNode(),d=0,a.acc>this.acc&&(d+=a.acc-this.acc),g=this.text().length,a.accend<this.accend&&(g-=this.accend-a.accend);k=document.createRange();k.setStart(c,d);k.setEnd(f,g);b.push(k)};var k=function(b,c,d,f){b=new a.Rectangle(b.rect(f.overlay),"overlay");b.convert(f);d._charRects.push(b)},m=function(b,c){if(!b._charRects&&c){var f=b.text(),g=new a.Element;g.transferFrom(b);for(var m="",s=0;s<f.length;s++)m+="<span>",m+=f[s],m+="</span>";b.html(m);b._charRects=[];b.forChildElements(k,b,c);
s=new a.Rectangle(b.rect(c.overlay),"overlay");s.origin=c;b.html("");b.transferFrom(g);f=b.spanRect(c);if(f.width!=s.width&&(g=f.width/s.width,!d.approxEqual(g,1))){f=f.left;for(s=0;s<b._charRects.length;s++){var m=b._charRects[s],w=(m.left-f)*g+f;m.move(w,void 0,w+m.width*g,void 0)}}}return b._charRects};f.createSplit=function(){var b=new a.SpanSplit("span",this.acc,this.accend);this.moveDataTo(b);b.transferFrom(this);return b};f.updateData=function(){var b=this._splits;b?c.each(b,"updateData"):
a.SpanSplit.prototype.updateData.call(this)};f.split=function(a){if(!this._splits){if(a.acc<=this.acc&&a.accend>=this.accend)return[this];var b=this.createSplit();this.append(b);this._splits=[b]}for(var b=this._splits,c=[],d=0;d<b.length;d++){var f=b[d];if(!(a.acc>=f.accend)){if(a.accend<=f.acc)break;if(a.acc>f.acc){var g=f.createSplit(a.acc);b.splice(d++,0,g);this.insert(g,f)}a.accend<f.accend&&(g=f.createSplit(a.accend),b.splice(d++,0,g),this.insert(g,f),f=g);c.push(f)}}return c};f.join=function(){var a=
this._splits;if(a){for(var b=a[a.length-1],c=a.length-2;0<=c;c--){var d=a[c];d.dataEquals(b)&&(d.mergeSplit(b),a.splice(c+1,1));b=d}1==a.length&&(d=a[0],d.moveDataTo(this),this.text(d.text()),d.destroy(),delete this._splits)}};f.addDataToRange=function(a,b,d){if(a=this.split(a))c.each(a,"addData",null,b),this.join(),this.updateData(),"hyperlink"===b.type&&m(this,d)};f.removeData=function(b,d){a.SpanSplit.prototype.removeData.call(this,b,d);c.each(this._splits,"removeData",null,b,d);this.join();this.updateData()}});OIT.extend(function(a){var b=a.doc,d=a.range,c=a.util;a.SpanMap=function(c){this._page=c;this._spans=[];for(var d,g=c.createTreeWalker(NodeFilter.SHOW_ELEMENT),h=g.firstACCNode();h;){var h=g.currentNode,p=b.data(h,"acc");p&&(d=Number(p));for(var p=!0,l=h.firstChild;l;l=l.nextSibling)if(3==l.nodeType){p=!1;break}!p&&void 0!==d?(d=new a.SpanInfo(h,d),this._spans.push(d),d=d.accend,(h=g.skipNode())&&(h=g.firstACCNode())):h=g.nextACCNode()}this._layoutSettings={};if(!c.checkedACCRange){if(g=this.getTextRange())g.acc<
c.acc&&(c.acc=g.acc),g.accend>c.accend&&(c.accend=g.accend);c.checkedACCRange=!0}};var g=a.subclass(a.SpanMap);g.destroy=function(){c.each(this._spans,"unload");this.deleteAll()};g.discardLayout=function(){c.each(this._spans,"discardLayout")};g.getTextRange=function(){for(var a,b=0;b<this._spans.length;b++){var c=this._spans[b];a?(c.acc<a.acc&&(a.acc=c.acc),c.accend>a.accend&&(a.accend=c.accend)):a=d.textRange(c.acc,c.accend)}return a};g.textRanges=function(){for(var a=[],b,c=this._page.isEmailHeader(),
h=0;h<this._spans.length;h++){var g=this._spans[h];!c&&b&&b.accend+1>=g.acc?g.accend>b.accend&&(b.accend=g.accend):(b=d.textRange(g.acc,g.accend),a.push(b))}return a};g.mapPointToSpan=function(a,b,c){if(0<this._spans.length){var d,g=this._page,l=g.isHidden();l&&g.show();for(var n=[],x,s=0;s<this._spans.length;s++){var w=this._spans[s];if(!c||w.equals(c)||w.isDescendantOf(c)){var t=w.spanRect(g),t=b<t.top?t.top-b:b>t.bottom?b-t.bottom:0;if(void 0===x||t<x)n.length=0,x=t;t==x&&n.push(w)}}x=void 0;if(1==
n.length)d=n[0];else for(s=0;s<n.length;s++)if(w=n[s],t=Math.abs(w.spanRect(g).distanceFrom(a,b)),void 0===x||t<x)d=w,x=t;l&&g.hide();return d}};g.findOverlappingText=function(a){if(0<this._spans.length){var b=[],c=this._page.isHidden();c&&this._page.show();for(var d=0;d<this._spans.length;d++){var g=this._spans[d].overlapRange(this._page,a);g&&b.push(g)}c&&this._page.hide();if(0<b.length)return b}};g.findRange=function(a,b){for(var c=[],d=0;d<this._spans.length;d++){var g=this._spans[d];g.acc<=b&&
g.accend>a&&c.push(g)}if(0<c.length)return c};g.findACC=function(a){for(var b=[],c=0;c<this._spans.length;c++){var d=this._spans[c];a>=d.acc&&a<d.accend&&b.push(d)}if(0<b.length)return b}});OIT.extend(function(a){var b=a.glob,d=a.opt,c=a.doc,g=a.pages,f=a.rawtext,k=a.range,m=a.util,h=a.math,p=a.display,l=a.ajax,n=a.dialog,x=a.content,s=OIT.local,w=[" ","\n","\r","\t"],t=["\n","\r"];a.Page=function(b,c,e){var d=document.getElementById(e);d?a.Element.call(this,d):a.Element.call(this,"div","oit-section oit-"+c+" oit-pending",e);this.prop("index",b);this.data("page",this);this._needArrange=!0;this._staticContent=!!this.firstChildElem()};var e=a.subclass(a.Page,a.Element);e.processData=function(b){var c=
this.isEmailHeader(),e={},d=!1,f=!1,h;for(h in b){var k=b[h],u=null,r=!1;switch(h){case "embeds":case "frames":u="_"+h;break;case "data":case "src":u="_"+h+"URL";break;case "section":case "name":case "type":case "dpi":case "autodpi":case "hiddenFromSlideshow":u=h;break;case "acc":case "accend":u=h;r=!0;break;case "w":c||this.css("width",k);u="width";k=parseInt(k);r=!0;break;case "h":c||this.css("height",k);u="height";k=parseInt(k);r=!0;break;case "oid":if((k=g.overlayById(b.oid))&&k!==this.overlay)u=
"overlay",f=!0}u&&!this.hasOwnProperty(u)&&(e[u]={value:k,writable:r,enumerable:!1},d=!0)}d&&Object.defineProperties(this,e);f&&this.overlay.add(this);b.content&&!this.isLoaded()&&(!0===this.deferContent?this.deferredContent=b.content:q(this,b.content));!this._ssmodel&&b.ssdata&&(this._ssmodel=new a.SpreadsheetModel(b.ssdata,this._embeds));this._staticContent&&g.on.pageload.dispatch(this,!1)};var q=function(a,e){var d=c.create("div");d.html(e);var f=d.byClass("oit-view");if(f&&0<f.length)for(d=0;d<
f.length;d++){var h=f[d].byClass("oit-section");if(h)for(var k=0;k<h.length;k++){var u=h[k],r=g.pageById(u.id);r&&!r.firstChildElem()&&(b.baseURL&&z(u),r.transferFrom(u))}}else b.baseURL&&z(d),a.transferFrom(d),a._needArrange=!0};e.destroy=function(){this.unload();a.Element.prototype.destroy.call(this)};e.unload=function(){var a=this.isLoaded();this.abortLoad();this._needArrange=!0;this._selRect&&(this._selRect.destroy(),delete this._selRect);0<this.loadedSize&&(this._ssmodel&&(this._ssmodel.unload(),
delete this._ssmodel),this._spanMap&&(this._spanMap.destroy(),delete this._spanMap),this.pageLayoutChanged(),this.html(""),this.addClass("oit-pending"),this.loadedSize=0);this.logUnload&&this.logUnload();a&&g.on.pageunload.dispatch(this)};e.show=function(a){if(this.isHidden()){a=a||{};this.finishAnimation();var b;if(!a.insertLast)for(var c=this.index+1;;c++){var e=g.page(c);if(!e||e.overlay!==this.overlay)break;if(!e.isHidden()){b=e;break}}this.css("opacity",0);b?this.overlay.insert(this,b):this.overlay.append(this);
void 0===a.time&&(a.time=a.animate?150:0);a.opacity=1;this.animate(a)}return this};e.hide=function(){var a=c.unwrap(this).parentNode;a&&(this.finishAnimation(),a.removeChild(this.dom));return this};e.isHidden=function(){return this._hidden||!this.parent()||!this.overlay||this.overlay.isHidden()};e.filter=function(a){return a!==this.index};e.info=function(){var b={page:this.index,type:this.type,features:a.fmt.features(this.type)};"slide"==this.type&&(void 0!==document.getElementById(this.id+".note")?
b.notes=!0:b.notes=!1);void 0!=this.hiddenFromSlideshow&&(b.hiddenFromSlideshow=this.hiddenFromSlideshow);void 0!==this.acc&&(b.acc=this.acc,void 0!==this.accend&&(b.accend=this.accend));this.width&&this.height&&(b.width=this.width,b.height=this.height);return b};e.features=function(){return a.fmt.features(this.type)};e.isEmailHeader=function(){return"emailheader"===this.id||"emailheader.1"===this.id};e.isPending=function(){return this.hasClass("oit-pending")};e.isLoading=function(){return this.hasClass("oit-loading")};
e.isLoaded=function(){return!this.hasClass("oit-pending")&&!this.hasClass("oit-loading")};e.isEnabled=function(){return"slideshow"!=d.presentationMode?!0:"slide"!=this.type||!this.hiddenFromSlideshow};e.mapPointToText=function(a,b,c){!0==this.bNotesBar&&(b=this.toNotesBarY(b));var e,d=u(this);d&&(e=d.mapPointToSpan(a,b,c));if(e){var f=e.textAngle(),g=e.spanRect(this);c=g.left;var d=g.top,k=g.right,g=g.bottom;if(0!=f){var r=[{x:c,y:d},{x:k,y:d},{x:k,y:g},{x:c,y:g}];h.rotatePoints(r,{x:a,y:b},f);c=
k=r[0].x;d=g=r[0].y;for(f=1;4>f;f++){var q=r[f];q.x<c?c=q.x:q.x>k&&(k=q.x);q.y<d?d=q.y:q.y>g&&(g=q.y)}}e=e.findClosestChar(a,b,this);e.overlaps=a>=c-2&&a<=k+2&&b>=d-2&&b<=g+2;return e}};e.findTextBoundary=function(a,b,c){a=k.accFromNode(a);if(f&&void 0!==a){a+=b;c="line"===c?t:w;b=f.findBoundaryStart(a,c);c=f.findBoundaryEnd(b,c);b=k.textRange(b,c);if(this._frames){var e,d;for(c=0;c<this._frames.length;c++){var g=this._frames[c];a>=g.acc&&a<g.accend&&(void 0==e?(e=g.acc,d=g.accend):(g.acc<e&&(e=g.acc),
g.accend>d&&(d=g.accend)))}b.acc<e&&(b.acc=e);b.accend>d&&(b.accend=d)}if(e=this.findTextRange(b))return k.consolidateDOMRanges(e)}};e.resetCache=function(){delete this._cachedRects};var y=function(a){var c=a._cachedRects;c||(c=a._cachedRects={});var e=b.viewNode,f=e.clientWidth,g=e.clientHeight,h=e.scroll(),e=h.left,h=h.top,k=a.offsetLeft;a=a.offsetTop;var u=d.zoom,r=d.rotation;if(c.viewWidth!=f||c.viewHeight!=g||c.scrollLeft!=e||c.scrollTop!=h||c.offsetLeft!=k||c.offsetTop!=a||c.zoom!=u||c.rotation!=
r)c.view=null,c.overlay=null,c.pos=null,c.viewWidth=f,c.viewHeight=g,c.scrollLeft=e,c.scrollTop=h,c.offsetLeft=k,c.offsetTop=a,c.zoom=u,c.rotation=r;return c};e.pageRect=function(a){var b=y(this);if("view"===a||"overlay"===a){var c=b[a];c||(c=p.pageRect(this.index,a),b[a]=c);return c}b.page||(b.page=p.pageRect(this.index,this));return b.page};e.pagePos=function(a){if("overlay"===a)return a=y(this),a.pos||(a.pos=this.pos(this.overlay)),a.pos;if("view"===a){a=this.pagePos("overlay");var b=p.padding(),
c=p.scrollOffset();return{left:a.left+b.left-c.left,top:a.top+b.top-c.top}}};e.containsRange=function(a){if("text"!==a.type)return a.page==this.index;if(a.acc<=this.accend&&a.accend>=this.acc)switch(this.type){case "worksheet":case "database":var b=this.spreadsheetModel();return b?b.containsRange(a.acc,a.accend):!0;default:if(this._frames)for(b=0;b<this._frames.length;b++){var c=this._frames[b];if(a.acc<=c.accend&&a.accend>=c.acc)return!0}else if(this.isLoaded()){if(a.acc===a.accend)return!!this.findACC(a.acc);
b=this.findRange(a.acc,a.accend);if(void 0!==b&&0<b.length)return!0==b[0].bSlideNote&&(a.bSlideNote=!0),!0}else return!0}return!1};var v=function(a,b){return a.acc-b.acc},D=function(a,b){if(b&&0<b.length){b.sort(v);for(var c=[],e,d=a.isEmailHeader(),f=0;f<b.length;f++){var g=b[f];void 0!==g.acc&&(!d&&e&&e.accend+1>=g.acc?g.accend>e.accend&&(e.accend=g.accend):(e=k.textRange(g.acc,g.accend),c.push(e)))}return c}};e.mapRectRangeToText=function(b){if("rect"===b.type){var c=u(this);if(c)return b=new a.Rectangle(b,
this),D(this,c.findOverlappingText(b))}};e.textRanges=function(){var a=u(this);if(a)return D(this,a.textRanges())};e.mapRangeToEmbeds=function(a){var b;if(this._embeds&&("rect"===a.type||"cell"===a.type))if(a=p.rangeRect(a,this))for(var c=0;c<this._embeds.length;c++){var e=this._embeds[c],d=this.embeddingRect(e.uid);if(d&&d.overlaps(a)){var f=d.left,g=d.top;d.intersect(a);d.offset(-f,-g);b||(b=[]);e=k.rectRange(e.uid,this.index,d.left,d.top,d.right,d.bottom);k.convert(e,"pct");b.push(e)}}return b};
e.embeddingRect=function(b){if(this._embeds&&(b=m.byProperty(this._embeds,"uid",b)))return b.position?(b=b.position,b=new a.Rectangle(b.left,b.top,b.right,b.bottom,this)):b=new a.Rectangle(b.x,b.y,b.x+b.w,b.y+b.h,this),b};e.textBoundingRect=function(a){if(this.isLoaded()&&"text"===a.type){var b;if(this.isSpreadsheet())g.activeOverlay()==this.overlay&&(b=p.rangeRect(a,this));else{var c=this.findRange(a.acc,a.accend);if(c&&0<c.length){var e=this.isHidden();e&&this.show();b=c[0];b=c[0].textRect(a,this);
for(var d=1;d<c.length;d++){var f=c[d].textRect(a,this);f&&b.union(f)}!b&&1==c.length&&(b=c[0],a=k.clone(a),a.accend==b.acc&&a.accend++,b=c[0].textRect(a,this));e&&this.hide()}}return b}};e.textRects=function(b,c){var e=this;if("text"===b.type){var d;if(e.isSpreadsheet()){if(g.activeOverlay()==this.overlay){var f=p.rangeRect(b,c);f&&(d=[new a.RectangleSet(f)])}}else{var k=e.findRange(b.acc,b.accend);if(k&&0<k.length){k.sort(function(a,b){var c=a.spanRect(e),d=b.spanRect(e),f=c.top-d.top;f||(f=c.left-
d.left);return f});var u=this.isHidden();u&&this.show();for(var r=[],q=0;q<k.length;q++){var l=k[q].textRect(b,this);l&&(f&&h.approxEqual(l.top,f.top)&&h.approxEqual(l.bottom,f.bottom)&&l.left<=f.right+1?f.union(l):(f=l,r.push(f)))}u&&this.hide();if(0<r.length){d=[];k=new a.RectangleSet(r[0]);d.push(k);for(q=1;q<r.length;q++)if(u=r[q],8>u.width||8>u.height)k.add(u);else{for(var l=u.left-5,n=u.right+5,v=u.top-2,B=u.bottom+2,z=k.length-1;0<=z;z--)if(f=k.item(z),n>=f.left&&l<=f.right&&B>=f.top&&v<=f.bottom){k.add(u);
u=null;break}u&&(k=new a.RectangleSet(u),d.push(k))}}}}d&&("overlay"===c||"view"===c)&&m.each(d,"convert",null,c);return d}};e.accRect=function(a,b){var c,e=k.textRange(a,a+1);if(this.isSpreadsheet())c=p.rangeRect(e,b);else{var d=this.findACC(a);if(d&&0<d.length){var f=this.isHidden();f&&this.show();c=d[0].textRect(e,this);for(var g=1;g<d.length;g++){var h=d[g].textRect(e,this);c.union(h)}c.origin=b;f&&this.hide()}}return c};e.findTextRange=function(a){if("text"===a.type&&a.acc<=this.accend&&a.accend>=
this.acc&&this.isLoaded()){var b=[],c=!1;if(!this._frames||"email"===this.type)c=!0;else for(var e=0;e<this._frames.length;e++){var f=this._frames[e];if(a.acc<=f.accend&&a.accend>=f.acc)if((f=document.getElementById(f.id))&&0==f.childNodes.length){var h=document.createRange();h.setStart(f,0);h.setEnd(f,0);b.push(h)}else c=!0}if(c&&(c=a.acc===a.accend?this.findACC(a.acc):this.findRange(a.acc,a.accend))){if(void 0!==c[0].bSlideNote&&(d.showSlideNotes=!0,e=g.notesBar()))e=e.extractMatchingSpanInfos(c),
0<e.length&&(c=e);m.each(c,"findTextRange",null,a,b)}if(0<b.length)return b}};e.layer=function(a){if(this.overlay)return this.overlay.layer(a)};e.hasSelectionRect=function(){return!!this._selRect};e.selectionRect=function(){if(!this._selRect){var b=this.layer("selection");this._selRect=new a.DrawingRect(this.index,b,"oit-sel-rect")}return this._selRect};e.showSelectionRect=function(a){this._selRect&&this._selRect.show(a)};e.findRange=function(a,b){var c=u(this);if(c)return c.findRange(a,b)};e.findACC=
function(a){var b=u(this);if(b)return b.findACC(a)};e.pageLayoutChanged=function(){delete this._cachedRects;this._spanMap&&this._spanMap.discardLayout()};e.isSpreadsheet=function(){return this._ssmodel||this._dataURL};e.spreadsheetModel=function(){return this._ssmodel};var u=function(b){void 0===b._spanMap&&(b.isSpreadsheet()?b._spanMap=null:b._spanMap=new a.SpanMap(b));return b._spanMap},E=function(a){if(a.showProgressDialog&&void 0!==a.srcSize&&void 0!==a.dataSize){var b=a.srcSize+a.dataSize;262144<=
b&&(b=100*(a.srcLoaded+a.dataLoaded)/b,a.progressDialog||(a.progressDialog=n.createProgressDialog(s.PLEASE_WAIT_INITIALIZING,!0)),a.progressDialog&&a.progressDialog.update(b))}},r=function(a){void 0===a.srcRequest&&(void 0===a.dataRequest&&a.isLoading())&&(a.logLoad&&a.logLoad(),a.removeClass("oit-loading"),a.pageLayoutChanged(),a.loadedSize=0,a.dataSize&&(a.loadedSize+=a.dataSize),a.srcSize&&(a.loadedSize+=a.srcSize),g.applyMemoryLimit(a.loadedSize),a.deferredContent&&(q(a,a.deferredContent),delete a.deferredContent,
delete a.deferContent),g.on.pageload.dispatch(a,!0),a.progressDialog&&(a.progressDialog.hide(),delete a.progressDialog),delete a.showProgressDialog,a.completionFunc&&(a.completionFunc(a),delete a.completionFunc),delete a.locked)},z=function(a){a=c.wrap(a);if(b.baseURL){a=a.createTreeWalker(NodeFilter.SHOW_ELEMENT);for(var e;e=a.nextNode();)if("IMG"===e.tagName){var d=e.getAttribute("src");d&&("/"!=d.charAt(0)&&(d=m.concatURL(b.baseURL,d)),e.setAttribute("src",d))}else if("image"===e.tagName&&(d=e.getAttribute("xlink:href")))"/"!=
d.charAt(0)&&(d=m.concatURL(b.baseURL,d)),e.setAttribute("xlink:href",d)}};e.abortLoad=function(){this.isLoading()&&(this.srcRequest&&(l.abort(this.srcRequest),delete this.srcRequest),this.dataRequest&&(l.abort(this.dataRequest),delete this.dataRequest),this.removeClass("oit-loading"),this.addClass("oit-pending"))};e.load=function(a,c,e){!1===a&&this.abortLoad();var d=this.isPending();d&&(this._srcURL||this._dataURL)?(this.srcLoaded=this.srcSize=this.dataLoaded=this.dataSize=0,this.completionFunc=
e,this.removeClass("oit-pending"),this.addClass("oit-loading"),this.locked=!0,!0===c&&(this.showProgressDialog=!0),c=b.baseURL,this._dataURL&&(e=this._dataURL,c&&"/"!=e.charAt(0)&&(e=m.concatURL(c,e)),this.dataRequest=l.start({url:e,async:a,context:this,loading:B,complete:C})),this._srcURL&&(e=this._srcURL,c&&"/"!=e.charAt(0)&&(e=m.concatURL(c,e)),this.srcRequest=l.start({url:e,async:a,context:this,loading:J,complete:H}))):(d&&(this.removeClass("oit-pending"),g.on.pageload.dispatch(this,!1)),e&&e())};
var B=function(a,b,c){this.dataSize=b;c&&(this.dataLoaded=c.length);E(this)},C=function(a,b,c,e){c&&(this.dataLoaded=c.length,E(this));if(200===e)try{var d=JSON.parse(c);this.processData({ssdata:d})}catch(f){this.logFatalError(null,"Corrupt data from server: "+a)}else this.logFatalError(null,"Failed to load resource from server (Error "+e+"): "+a);delete this.dataRequest;r(this)},J=function(a,b,c){this.srcSize=b;c&&(this.srcLoaded=c.length);E(this)},H=function(a,b,c,e){c&&(this.srcLoaded=c.length,
E(this));200===e?(this.deferContent=!0,x.isICD(c)?x.processContentData(c):this.processData({content:c})):this.logFatalError(null,"Failed to load resource from server (Error "+e+"): "+a);delete this.srcRequest;r(this)}});OIT.extend(function(a){var b=a.glob,d=a.opt,c=a.pages,g=a.dialog,f=a.util;a.Overlay=function(c,d){var f={index:{value:c},length:{get:function(){return this.firstPage?this.lastPage.index-this.firstPage.index+1:0}}};d.name&&(f.name={value:d.name});Object.defineProperties(this,f);(f=document.getElementById(d.oid))?a.Element.call(this,f):(f="oit-overlay",d.cls&&(f=-1==d.cls.indexOf(f)?f+(" "+d.cls):d.cls),a.Element.call(this,"article",f,d.oid));b.viewNode.append(this)};var k=a.subclass(a.Overlay,a.Element);
k.updateCSS=function(){"text"===d.selectionMode&&!g.modalOverlayVisible()?this.removeClass("oit-unselectable"):this.addClass("oit-unselectable");"rect"===d.selectionMode?this.css("cursor","crosshair"):this.css("cursor",null)};k.item=function(a){if(this.firstPage)return c.page(this.firstPage.index+a)};k.add=function(a){this.append(a);this.firstPage||(this.firstPage=a);this.lastPage=a;if(!this.maxWidth||a.width>this.maxWidth)this.maxWidth=a.width;if(!this.maxHeight||a.height>this.maxHeight)this.maxHeight=
a.height;this._pagesHidden&&a.hide()};k.containsPage=function(a){return c.page(a).overlay==this};k.show=function(){this.css("display","block");this.layers&&f.eachSparse(this.layers,"show");this.updateCSS()};k.hide=function(){this.layers&&f.eachSparse(this.layers,"hide");this.css("display",null)};k.isHidden=function(){return"block"!==this.css("display")};k.showPages=function(a){this.each("show",a);this._pagesHidden=!1};k.hidePages=function(a){this.each("hide",a);this._pagesHidden=!0};k.each=function(a,
b){f.eachArgs(this,arguments)};k.layer=function(c){var d;this.layers&&(d=this.layers[c]);d||(d=new a.DrawingLayer(b.drawing,c,this.id+"."+c),this.layers||(this.layers={}),this.layers[c]=d);return d}});OIT.extend(function(a){var b=a.doc,d=a.range,c=a.pages,g=a.css,f=a.highlights,k=a.display,m=a.stylemap,h=a.util;a.Highlight=function(a,b){this.id=a;this.range=d.clone(b.range);this.range.bSlideNote=b.range.bSlideNote;this.type=b.type;b.style&&(this._style=b.style);b.cls&&(this._class=b.cls);b.comment&&(this._comment=b.comment);b.label&&(this._label=b.label);b.properties&&(this._properties=b.properties);b.options&&this.setOptions(b.options);if(b.compound&&(this._compound=!0,Array.isArray(b.compound))){this._cRanges=
[];for(var c=0;c<b.compound.length;c++){var e=d.clone(b.compound[c]);"rect"===e.type&&d.convert(e,"px");this._cRanges.push(e)}}this._pageInfo=[];"rect"===this.range.type&&(void 0!==this.range.embedId?d.convert(this.range,"pct"):d.convert(this.range,"px"));this.range=d.validateRange(this.range,!0);f.map(this)};var p=a.subclass(a.Highlight);p.isNote=function(){return!1};p.isRedaction=function(){return!1};p.isCompoundRedaction=function(){return!1};p.isEmptyRedaction=function(){return!1};p.setRange=function(a){return void 0!==
a&&0!=d.compare(a,this.range)?("cell"==this.range.type&&this.eachPage(function(a,b){B(b,c.page(a.index))},null,this),f.unmap(this),this.range=d.clone(a),f.map(this),delete this._cRanges,"text"==a.type&&this._compound&&(this._cRanges=[a]),this.updateStyle(),f.alignHighlight(),f.on.move.dispatch(this),!0):!1};p.updateStyle=function(){this._hidden||this.eachPage(l,null,this)};var l=function(a,b){var c=a.index;b.removeFromPage(a);b.addToPage(c)};p.filter=function(b){if(b){if("string"===typeof b)return this[b]();
if(b instanceof a.Page)return this.isOnPage(b.index);if(!b(this.id,this._properties))return!1}return!0};p.properties=function(a){void 0!==a&&(this._properties=a);return this._properties};p.property=function(a,b){void 0!==b&&(this._properties||(this._properties={}),this._properties[a]=b);if(this._properties)return this._properties[a]};p.style=function(a){a&&(this._style=a,this.updateStyle());return this._style};p.fillStyle=function(){if("text"!==this.range.type)return this._style};p.css=function(a){return g.get(this._style,
a)};p.matches=function(a,b,c,e,f){return this._style===a&&0==d.compare(this.range,b)&&this._properties===c&&this._comment===e&&this._label===f};p.serialize=function(){var a={type:this.type};a.range=d.clone(this.range);if("rect"===a.range.type)if(void 0!==a.range.embedId)d.convert(a.range,"pct");else{var b=c.page(a.range.page);b&&b.autodpi?d.convert(a.range,"pct"):b&&"bitmap"===b.type?d.convert(a.range,"px"):d.convert(a.range,"tw")}this._style&&(a.style=this._style);this._properties&&(a.properties=
this._properties);"string"===typeof this._comment&&(a.comment=this._comment);this._label&&(a.label=this._label);this._options&&(a.options=this._options);if(this._cRanges){a.compound=[];for(b=0;b<this._cRanges.length;b++){var e=d.clone(this._cRanges[b]);"rect"===e.type&&(void 0!==e.embedId?d.convert(e,"pct"):d.convert(e,"tw"));a.compound.push(e)}}return a};p.destroy=function(){this.destroyDialog();this.eachPage(n,null,this);f.unlink(this);this.deleteAll()};var n=function(a,b){b.removeFromPage(a)};
p.getOption=function(a){if("text"==this.range.type){if("enableUserMove"===a)return!1;if("enableUserResize"===a)for(var b in this._pageInfo){if(c.page(Number(b)).isSpreadsheet())return!1;break}}return(b=this._options)&&void 0!==b[a]?b[a]:!0};p.setOptions=function(a){if(a&&(C(this,"enableUserDelete",a,!0),C(this,"enableUserComment",a,!0),C(this,"enableUserResize",a,!0),"text"!==this.range.type&&C(this,"enableUserMove",a,!0),a=this._options)){var b=!1,c;for(c in a)if(a.hasOwnProperty(c)){b=!0;break}b||
delete this._options}};p.comment=function(a){void 0!==a&&(this._comment=null===a?void 0:String(a),this.updateComment(void 0,this._comment));return this._comment};p.dialog=function(b){var c=this._dialog;c?(c.abortAnimation(),c.show(!0)):c=this._dialog=new a.CommentDialog(this);c.loadComment();c.setMode(b);c.align();return c};p.alignDialog=function(a){this._dialog&&this._dialog.align(a)};p.hideDialog=function(){var a=this._dialog;a&&a.show(!1,{endFn:a.close,context:a})};p.exitDialog=function(){this._dialog&&
this._dialog.exit()};p.destroyDialog=function(){this._dialog&&this._dialog.destroy()};p.onDialogDestroy=function(a){a===this._dialog&&delete this._dialog};p.label=function(a){void 0!==a&&(this._label=null===a||""===a?void 0:String(a),this.eachPage(x,null,this));return this._label};var x=function(a,b){b.applyLabel(a)};p.showLabel=function(a){this._label&&(!1===a?this._labelVisible=!1:delete this._labelVisible,this.eachPage(x,null,this))};p.isOnPage=function(a){return!!this._pageInfo[a]};p.createPageInfo=
function(a){var b=this._pageInfo[a];b||(this._pageInfo[a]=b={index:a});return b};p.eachPage=function(a,b){h.eachSparseArgs(this._pageInfo,arguments)};p.activate=function(a){this._hidden&&(this.show(),this._autohide=!0,k.update());this._active=!0;this.eachPage(s,null,this);this.positionAll()};var s=function(a,b){if(a.drawingRect){var c=a.drawingRect;b.oldFocusPage=void 0;c.addClass("oit-highlight-active");if("text"===b.range.type)c.setRange(b.range),b.getOption("enableUserResize")?c.ontextmove(b,w).ontextmoveend(b,
e).showTextHandles():c.offtextmove(w).offtextmoveend(e).hideTextHandles();else{var d="cell"!==b.range.type;b.updateMoveable(!0,c);b.updateResizable({bindToObject:d,minWidth:10,minHeight:10},c)}c.activate()}a.embedRect&&a.embedRect.addClass("oit-highlight-embed")};p.updateMoveable=function(a,b,c){c=c||b;if(!1!==a&&this.getOption("enableUserMove"))b.addClass("oit-moveable").on("dragstart",this,K,c).on("dragmove",this,I,c).on("dragend",this,L,c).on("dragcancel",this,N,c).on("click",this,A,c).on("tap",
this,F,c);else b.removeClass("oit-moveable").offdragstart(K).offdragmove(I).offdragend(L).offdragcancel(N).offclick(A).offtap(F)};p.updateResizable=function(a,b,c){c=c||b;if(a&&this.getOption("enableUserResize"))c.resizable(!0,a).onresizemove(this,P).onresizeend(this,O);else c.resizable(!1).offresizemove(P).offresizeend(O)};var w=function(a){var b=a.range;a=a.page;var e=c.pagesForRange(b);a!=this.oldFocusPage&&(this.oldFocusPage=a,this.eachPage(t,null,e,this));this._pageInfo[a.index]||this.addToPage(a.index,
!0);this._cRanges&&(this._cRanges=[b]);z(this,a,this.style(),b);this.alignDialog({animate:!1})},t=function(a,b,e){a.spanList&&(a=a.index,h.byProperty(b,"index",a)||B(e,c.page(a)))},e=function(a){this.setRange(a.range)};p.deactivate=function(){this._active&&(delete this._active,this.eachPage(q,null,this),this._autohide&&(this.hide(),delete this._autohide,k.update()))};var q=function(a,b){var c=a.drawingRect;c&&(c.removeClass("oit-highlight-active").deactivate(),"text"!==b.range.type&&(b.updateMoveable(!1,
c),b.updateResizable(!1,c)));a.embedRect&&a.embedRect.removeClass("oit-highlight-embed")};p.show=function(){if(this._hidden){var a=this._hidden;delete this._hidden;for(var b=0;b<a.length;b++)this.addToPage(a[b])}delete this._autohide};p.hide=function(){this._hidden||(this._hidden=[],this.eachPage(y,null,this))};var y=function(a,b){b._hidden.push(a.index);b.removeFromPage(a)};p.collapse=function(){};p.isHidden=function(){return this._hidden||this._autohide};var v=function(a,b,e){!0==a.range.bSlideNote&&
(b=c.notesBar());if(b)return"overlay"!==e&&"view"!==e&&(e=b),"text"===a.range.type&&(b=b.textBoundingRect(a.range))?(b.origin=e,b):k.rangeRect(a.range,e)};p.boundingRectList=function(a){var b=[];this.eachPage(D,null,a,b,this);if(0<b.length)return b};var D=function(a,b,e,d){(a=v(d,c.page(a.index),b))&&e.push(a)};p.addToDocument=function(){var a=c.pagesForRange(this.range);if(a){for(var b=0;b<a.length;b++)this.addToPage(a[b].index);f.link(this)}};var u=function(a){a.highlightLayer||(E(a),a.highlightLayer=
a.layer("highlights"));return a.highlightLayer},E=function(a){a.compoundHighlightLayer||(a.compoundHighlightLayer=a.layer("chighlights"));return a.compoundHighlightLayer};p.addToPage=function(e,d){var g=c.page(e),h=this._pageInfo[e];if(!this._hidden&&(!h||h.needRect)&&g&&g.isLoaded()&&(d||g.containsRange(this.range))){var h=z(this,g,this.style(),this.range),q=v(this,g,"overlay");q?(h?delete h.needRect:h=this.createPageInfo(e),void 0!==this.range.embedId&&!h.embedRect&&(h.embedRect=new a.DrawingRect(e,
u(g))),h.drawingRect||(!0==this.range.bSlideNote?(g=c.notesBar(),g.highlightLayer||(g.highlightLayer=g.makeHighlightLayer("highlights")),h.drawingRect=this.createDrawingRect(g.index,g.highlightLayer),h.drawingRect._page=g,h.drawingRect._pos.convert("view")):h.drawingRect=this.createDrawingRect(g.index,u(g)),f.on.addElement(h.drawingRect,this)),(g=this.fillStyle())?(h.styleDiv||(h.styleDiv=b.create("div","oit-highlight-style"),h.drawingRect.append(h.styleDiv)),h.styleDiv.attr("style",g)):h.styleDiv&&
(h.styleDiv.destroy(),delete h.styleDiv),this._label&&this.applyLabel(h),r(this._pageInfo[e],this,q),this.updateComment(h,this._comment)):h&&(h.needRect=!0);f.link(this,q);k.update(!1,!0)}};p.removeFromPage=function(a){"number"==typeof a&&(a=this._pageInfo[a]);if(a){var b=a.index;B(this,c.page(b));a.commentFlag&&(a.commentFlag.destroy(),delete a.commentFlag);a.drawingRect&&(f.on.removeElement(a.drawingRect),a.drawingRect.destroy());a.embedRect&&a.embedRect.destroy();this._pageInfo[b]=null;k.update(!1,
!0)}};p.createDrawingRect=function(b,c){var e;"text"===this.range.type?(e=new a.TextRect(b,c),e.setRange(this.range)):e=new a.DrawingRect(b,c);return e};p.distanceFromPoint=function(a,b,e){var d,f=c.page(a);if(a=this._pageInfo[a])if(a.spanList){if(f=f.textRects(this.range))for(a=0;a<f.length;a++)for(var g=f[a],h=0;h<g.length;h++){var k=g.item(h).distanceFrom(b,e);if(void 0===d||Math.abs(k)<Math.abs(d))if(d=k,0===d)break}}else(f=v(this,f))&&(d=f.distanceFrom(b,e));return d};var r=function(a,b,e){if(a){var d=
a.index,f;f=!0==b.range.bSlideNote?c.notesBar():c.page(d);if(f.isHidden()||!f.isEnabled()){a.drawingRect&&a.drawingRect.hide();a.embedRect&&a.embedRect.hide();if(a.cRects)for(e=0;e<a.cRects.length;e++)a.cRects[e].rect.hide();a.needRect=!0}else if("text"===b.range.type)a.drawingRect&&a.drawingRect.show().changed();else if(e||(e=v(b,f,"overlay")),e){a.drawingRect&&a.drawingRect.show().move(e.left,e.top,e.width,e.height);if(a.embedRect&&(d=c.page(d).embeddingRect(b.range.embedId)))d.origin="overlay",
a.embedRect.show().move(d.left,d.top,d.width,d.height);if(a.cRects)for(e=0;e<a.cRects.length;e++)f=a.cRects[e],(d=k.rangeRect(f.range,"overlay"))&&f.rect.show().move(d.left,d.top,d.width,d.height);b.updateComment(a,b._comment)}}};p.positionAll=function(){this.eachPage(r,null,this)};p.generateKey=function(a){var b=c.forRange(this.range,0);if(b&&void 0===this.prevId&&void 0===this.nextId)return this.key&&this.key.page!=b.index&&delete this.key,this.key||(this.key={page:b.index,x:0,y:0}),b.isEmailHeader()&&
"text"===this.range.type?this.key.x=this.range.acc:(a||(a=v(this,b)),a&&(this.key.x=a.left,this.key.y=a.top)),this.key;delete this.key};p.applyLabel=function(a){if(a&&a.drawingRect)if(!this._label||!1===this._labelVisible)a.drawingRect.setLabel(null);else{var b=this.css("background-color"),c;a:{if(b&&(c=g.stringToColor(b))){c.r=255-c.r;c.g=255-c.g;c.b=255-c.b;c=g.colorToString(c.r,c.g,c.b);break a}c=void 0}c||(b=null);a.drawingRect.setLabel(this._label,c,b)}};var z=function(e,d,f,h){var u=!1;B(e,
d);if(e._compound){if(e._cRanges||(e._cRanges=c.decomposeRange(h,!0)),e._cRanges){var u=!0,r=d.spreadsheetModel();r&&r.addHighlight(e);var q=e._pageInfo[d.index];q||(q=e.createPageInfo(d.index));for(var r="rect"===h.type,l,n,p=0;p<e._cRanges.length;p++){var v=e._cRanges[p];if("text"===v.type){if(n||(n=g.parse(f)),n&&!d.isSpreadsheet()){var z=m.applyStyle(d,v,n,e.id);z&&(q.compoundSpanList||(q.compoundSpanList=[]),q.compoundSpanList.push(z))}}else if(z=k.rangeRect(v,"overlay")){var y=new a.DrawingRect(d.index,
E(d));if(f){var s=b.create("div","oit-highlight-style");s.attr("style",f);y.append(s)}y.move(z.left,z.top,z.width,z.height);q.cRects||(q.cRects=[]);q.cRects.push({range:v,rect:y})}r&&(v="text"===h.type?d.textBoundingRect(v):k.rangeRect(v,d))&&(l?l.union(v):l=v)}if(l&&(f=k.rangeFromRect(d.index,l.left,l.top,l.right,l.bottom,d,"highlight")))e.range=f}}else if("text"===h.type)if(r=d.spreadsheetModel())u=r.addHighlight(e);else if(n=g.parse(f))if(z=m.applyStyle(d,h,n,e.id))q||(q=e.createPageInfo(d.index)),
q.spanList=z,u=!0;if(u)return e.createPageInfo(d.index)},B=function(a,b){var c=a._pageInfo[b.index];if(c){var e=b.spreadsheetModel();e&&("text"===a.range.type||a._compound)&&e.removeHighlight(a);c.spanList&&(m.removeStyle(c.spanList,a.id),delete c.spanList);c.compoundSpanList&&(h.each(c.compoundSpanList,m.removeStyle,null,a.id),delete c.compoundSpanList);if(c.cRects){for(e=0;e<c.cRects.length;e++){var d=c.cRects[e].rect;d&&(f.on.removeElement(d),d.destroy())}delete c.cRects}}},C=function(a,b,c,e){var d=
!1;c=c[b];if(void 0!==c)if(c==e){if((c=a._options)&&void 0!==c[b])delete c[b],d=!0,a.optionChanged(b)}else a._options||(a._options={}),a._options[b]=!!c,d=!0,a.optionChanged(b);return d};p.optionChanged=function(a){switch(a){case "enableUserMove":case "enableUserResize":this.id===f.active()&&this.activate(!0)}};var J=function(a,b,c){c.updateComment(a,b)};p.updateComment=function(b,c){b?b.drawingRect&&(c?(b.commentFlag||(b.drawingRect.onmouseenter(this,H).onmouseleave(this,M),b.commentFlag||(b.commentFlag=
new a.DrawingChildObject(b.drawingRect,{hpos:"right",vpos:"top",margin:2,classList:"oit-comment-flag"}))),b.commentFlag.show()):b.commentFlag&&(b.commentFlag.destroy(),delete b.commentFlag)):this.eachPage(J,null,c,this)};var H=function(a){this.id!=f.active()&&f.showComment(this.id)},M=function(a){this.id!=f.active()&&f.hideComment(this.id)},A=function(b,c){var e=a.glob.viewNode.mousePos(b);f.activateNearest(e.x,e.y,b,!0)},F=function(a,b){var c=a.center;f.activateNearest(c.x,c.y,a.srcEvent,!0)},K=
function(a,b){if(this.getOption("enableUserMove")){var c=b.position();this._moveable={startRect:c.clone(),curRect:c.clone()};return!0}return!1},I=function(a,b){if(this._moveable){var c=this.range,e=this._moveable.startRect,f=this._moveable.curRect,g=a.delta;f.left=e.left+g.x;f.top=e.top+g.y;"cell"===c.type&&!c.offsets?(this.moveOriginalRect||(this.moveOriginalRect=k.rangeRect(c,f.origin)),e=this.moveOriginalRect.clone(),e.left=f.left,e.top=f.top,f=k.rangeFromRect(c.page,e.left,e.top,e.right,e.bottom,
e.origin,"move",c.embedId),e=c.c2-c.c1,g=c.r2-c.r1,f.c2-f.c1<e&&(f.c2=f.c1+e),f.r2-f.r1<g&&(f.r2=f.r1+g),delete f.offsets):f=k.rangeFromRect(c.page,f.left,f.top,f.right,f.bottom,f.origin,"move",c.embedId);0!=d.compare(f,c)&&(f=k.rangeRect(f,"overlay"),b.move(f.left,f.top,f.width,f.height),this._active&&(this._comment&&this._dialog)&&this._dialog.align({rect:f,animate:!1}))}},L=function(a,b){if(this._moveable){var c=this.range,e=this._moveable.curRect,e=k.rangeFromRect(c.page,e.left,e.top,e.right,
e.bottom,e.origin,"move",c.embedId);if("cell"===e.type&&!c.offsets){delete this.moveOriginalRect;var d=c.c2-c.c1,c=c.r2-c.r1;e.c2-e.c1<d&&(e.c2=e.c1+d);e.r2-e.r1<c&&(e.r2=e.r1+c);delete e.offsets}this.setRange(e);delete this._moveable}},N=function(a,b){if(this._moveable){var c=a.center;f.activateNearest(c.x,c.y,a.srcEvent);delete this._moveable}},P=function(a){var b=this.range,c=a.drawingRect;a=a.newRect;var e=k.rangeFromRect(b.page,a.left,a.top,a.right,a.bottom,a.origin,"resize",b.embedId);"cell"===
e.type&&!b.offsets&&delete e.offsets;if(e=d.validateRange(e,!0))b=k.rangeRect(e,"overlay"),"rect"===e.type&&(a=b),c.move(b.left,b.top,b.width,b.height);this._active&&(this._comment&&this._dialog)&&this._dialog.align({rect:a,animate:!1})},O=function(a){var b=this.range;a=a.newRect;a=k.rangeFromRect(b.page,a.left,a.top,a.right,a.bottom,a.origin,"resize",b.embedId);"cell"===a.type&&!b.offsets&&delete a.offsets;a=d.validateRange(a,!0);this.setRange(a)};p.loadPage=function(){var a=c.forRange(this.range);
a&&!a.isLoaded()&&a.load(!1)}});OIT.extend(function(a){var b=a.opt;a.Redaction=function(b,d){a.Highlight.call(this,b,d)};var d=a.subclass(a.Redaction,a.Highlight);d.isRedaction=function(){return!0};d.isCompoundRedaction=function(){return!0===this._compound};d.isEmptyRedaction=function(){return!0===this._compound&&!this._cRanges};d.style=function(a){a=b.redactionColor;return"color:"+a+";background-color:"+a+";"};d.fillStyle=function(){if("text"!==this.range.type){var a;if(a=this._compound&&("rect"===this.range.type||"cell"===this.range.type)?
b.redactionFillColor:b.redactionColor)return"background-color:"+a+";"}};d.css=function(a){if("color"===a||"background-color"===a)return b.redactionColor}});OIT.extend(function(a){var b=a.doc,d=a.glob,c=a.highlights,g=a.dialog,f=OIT.local;a.Note=function(b,c){a.Highlight.call(this,b,c);this._newNote=!0;this._state="oit-note-pinned";this._pinned=!0;this._hidden=this._hover=this._active=this._editing=!1};var k=a.subclass(a.Note,a.Highlight);k.isNote=function(){return!0};k.isEditing=function(){return this._editing};k.isHidden=function(){return this._hidden};k.removeFromPage=function(b){this.endEditText(!1);a.Highlight.prototype.removeFromPage.call(this,
b)};k.activate=function(a){if(!this._active||a)this._active=!0,this.updateState(a)};k.deactivate=function(){this._active&&(this._active=!1,this.updateState())};k.show=function(){this._hidden&&(this._hidden=!1,this.updateState())};k.hide=function(){this._hidden||(this._hidden=!0,this.updateState())};k.pin=function(){this._pinned||(this._pinned=!0,this.updateState())};k.unpin=function(){this._pinned&&(this.endEditText(!0),c.active()==this.id&&c.deactivate(),this._pinned=!1,this.updateState())};k.beginEditText=
function(a){void 0!==a&&(this._newNote=a);this._editing||(this._editing=!0,d.editingComment++,this.updateState())};k.endEditText=function(a){this._editing&&(!1===a&&(this.buttons.textArea.value=c.comment(this.id)),this._editing=!1,d.editingComment--,this.updateState(),this._newNote&&(a?delete this._newNote:c.remove(this.id)))};k.ok=function(){this.endEditText(!0);return!1};k.cancel=function(){this.endEditText(!1);return!1};k.optionChanged=function(a){switch(a){case "enableUserMove":case "enableUserResize":this.updateState(!0)}};
var m=function(){this.addClass("oit-note-expanding")},h=function(){this.removeClass("oit-note-expanding")},p=function(){this.addClass("oit-note-collapsing")},l=function(){this.removeClass("oit-note-collapsing")};k.updateState=function(a){var b;b=this._editing?"oit-note-editing":this._active?this._pinned?"oit-note-active":"oit-note-shown":this._hidden?"oit-note-hidden":this._pinned?"oit-note-pinned":this._hover?"oit-note-hover":"oit-note-iconic";var e=this.noteRect;if(e){if(b!=this._state||a){a=this._state;
this._state=b;e.removeClass(a).addClass(b);switch(a){case "oit-note-editing":c.comment(this.id,this.buttons.textArea.value);g.showModalOverlay(!1);this.buttons.iconBar.focus();e.layer().removeClass("oit-note-layer-edit");e.removeClass("oit-highlight-active").deactivate();break;case "oit-note-hidden":e.show();break;case "oit-note-iconic":if("oit-note-hidden"!==b){var d=this.originalRect;e.move(d.left,d.top,d.width,d.height,{timems:200,startFn:m,endFn:h})}break;case "oit-note-active":e.removeClass("oit-highlight-active").deactivate();
case "oit-note-pinned":"oit-note-active"!==b&&"oit-note-pinned"!==b&&(this.updateMoveable(!1,this.buttons.iconBar,e),this.updateResizable(!1,e))}this.positionAll();switch(b){case "oit-note-hidden":e.hide();break;case "oit-note-iconic":this.originalRect=e.position().clone();d=this.collapsedRect={left:this.originalRect.right-20,top:this.originalRect.top,width:20,height:20};"oit-note-hidden"===a?e.move(d.left,d.top,d.width,d.height):e.move(d.left,d.top,d.width,d.height,{timems:200,startFn:p,endFn:l});
break;case "oit-note-editing":e.layer().addClass("oit-note-layer-edit");e.addClass("oit-highlight-active").activate(!1,!0);c.activate(this.id);g.showModalOverlay(!0);b=this.buttons.textArea;b.blur();b.focus();this._newNote&&b.moveCaret(b.value.length||0);break;case "oit-note-active":e.addClass("oit-highlight-active").activate(!1,!0);case "oit-note-pinned":this.updateMoveable(!0,this.buttons.iconBar,e),this.updateResizable({bindToObject:"cell"!==this.range.type,minWidth:60,minHeight:45,margin:-5},
e)}}e.update()}};k.createDrawingRect=function(c,e){var d=new a.DrawingRect(c,e),g={};this.noteRect=d;this.buttons=g;d.addClass("oit-note").addClass("oit-note-pinned");g.iconBar=new a.DrawingChildObject(d,{classList:"oit-note-icons",inheritMoveable:!0});g.iconBar.attr("tabindex","-1");g.cancel=new a.DrawingChildObject(g.iconBar,{classList:"oit-note-cancel",title:f.DISCARD_CHANGES});g.cancel.onclick(this,this.cancel).ontap(this,this.cancel);g.ok=new a.DrawingChildObject(g.iconBar,{classList:"oit-note-ok",
title:f.SAVE_CHANGES});g.ok.onclick(this,this.ok).ontap(this,this.ok);g.pin=new a.DrawingChildObject(d,{classList:"oit-note-pin"});g.pin.onmouseenter(this,n).onmouseleave(this,x).onclick(this,s).ontap(this,s);g.textArea=new a.TextArea;g.textArea.onfocus(this,t).ontap(this,w);g.textForm=b.create("form");g.textForm.append(g.textArea);d.append(g.textForm);this.updateState(!0);return d};var n=function(a){this._hover=!0;this.updateState()},x=function(a){this._hover=!1;this.updateState()},s=function(a){this._pinned?
this.unpin():this.pin();return!1},w=function(a){this.buttons.textArea.blur();this.buttons.textArea.focus()},t=function(a){this.getOption("enableUserComment")?this.beginEditText():this.buttons.textArea.blur()},e=function(a,b,c){c.updateComment(a,b)};k.updateComment=function(a,b){a?!this._hidden&&!this._editing&&this.buttons&&(this.buttons.textArea.value=b||""):this.eachPage(e,null,b,this)}});OIT.extend(function(a){var b=a.highlights;a.Stamp=function(d,c){a.Highlight.call(this,d,c);c.name&&(this._name=c.name);c.sizing&&(this._sizing=c.sizing);c.opacity&&(this._opacity=c.opacity);if(!this._style){var g="background:url("+b.stamp(this._name).url+") no-repeat";1!=this._opacity&&(g+=";opacity:"+this._opacity);"scale"===this._sizing?g+=";background-size:contain":"stretch"===this._sizing&&(g+=";background-size:100% 100%");this._style=g}};a.subclass(a.Stamp,a.Highlight).serialize=function(){var b=
a.Highlight.prototype.serialize.call(this);b.stamp=this._name;b.opacity=this._opacity;b.sizing=this._sizing;delete b.style;return b}});OIT.extend(function(a){var b=a.glob,d=a.highlights,c=a.selection,g=a.css,f=200,k=150;a.CommentDialog=function(b){var c="#000",d=b.css("background-color");d&&(d=g.blendColors(d,"#FFFFFF"));if(d){var f=g.stringToColor(d);128>f.r&&(128>f.g&&128>f.b)&&(c="#FFF")}a.DialogBox.call(this,{ok:!0,cancel:!0,className:"oit-dialog-comment",resultFn:h,destroyFn:p,textColor:c,backgroundColor:d});this._highlight=b};var m=a.subclass(a.CommentDialog,a.DialogBox),h=function(a,b){"view"!==a._mode&&(f=a.width(),k=a.height(),
"new"===a._mode&&(!b||!a._textarea.value)?(d.remove(a._highlight.id),c.select(null)):(b&&a.saveComment(),d.active()===a._highlight.id?a.setMode("view"):a._highlight.exitDialog()))},p=function(a){a.setMode(null);a._highlight.onDialogDestroy(a)};m.setMode=function(a){if(a!==this._mode){if("edit"===this._mode||"new"===this._mode)b.editingComment--,this.removeClass("oit-comment-edit");this._mode=a;switch(a){case "view":this._highlight.comment()?(this._textarea&&(this._textarea.destroy(),delete this._textarea),
this._label||(this._label=this.addLabel(null),this._label.onclick(this,l).ontap(this,l).onmouseenter(this,n).onmouseleave(this,x)),this.resizable(!1),this.modal(!1),this.showFooter(!1),this.maxsize(f,k),this._mode=a,this.loadComment(),this.align(),this.show()):this._highlight.exitDialog();break;case "edit":case "new":b.editingComment++,this.addClass("oit-comment-edit"),this.modal(!0),this.align({endFn:s,context:this})}}};var l=function(){this._highlight.getOption("enableUserComment")&&this.setMode("edit")},
n=function(){d.showComment(this._highlight.id)},x=function(){var a=this._highlight.id,b=d.active();a!=b&&(d.hideComment(a),void 0!==b&&d.showComment(b))},s=function(){this.show(!0,{endFn:w,context:this})},w=function(){this._label&&(this._label.destroy(),delete this._label);this._textarea||(this.resetForm(),this._textarea=this.addTextArea(null),this._textarea.onfocus(this,t));this.loadComment();this.resizable(!0,180,100);this.showFooter(!0);this.maxsize(0,0);this._textarea&&this._textarea.focus&&this._textarea.focus()},
t=function(){var a=this._textarea;a&&("number"==typeof a.selectionStart?a.selectionStart=a.selectionEnd=a.value.length:"undefined"!=typeof a.createTextRange&&(a.focus(),a=a.createTextRange(),a.collapse(!1),a.select()))};m.loadComment=function(){var a=this._highlight.comment()||"";this._textarea?this._textarea.value=a:this._label&&this._label.text(a)};m.saveComment=function(){this._textarea&&d.comment(this._highlight.id,this._textarea.value,!0)};m.align=function(a){var c;a:{var d=a?a.rect:null;if(this){var g=
this._highlight,h=g.isNote(),u,l,r;if(d)"view"!==d.origin&&(d=d.clone(),d.origin="view"),h?(c=d.left,u=d.top,l=d.right-d.left,r=d.bottom-d.top):(c=d.right+10,u=d.top);else if(d=g.boundingRectList("view"))for(g=0;g<d.length;g++){var m=d[g];h?(c=m.left,u=m.top,l=m.right-m.left,r=m.bottom-m.top):(c=m.right+10,u=m.top);0>u&&0<=m.bottom&&(u=0);if(0<=c&&0<=u)break}if(void 0!=c){10>c&&(c=10);10>u&&(u=10);h=b.viewNode.pos();c+=h.left;u+=h.top;if(l&&r){c={left:c,top:u,width:l,height:r};break a}c={left:c,top:u};
break a}}c=void 0}c&&(u=c.width||f,l=c.height||k,"view"===this._mode?this.autoSize(c.left,c.top,u,l,a):this.move(c.left,c.top,u,l,a))}});OIT.extend(function(a){var b=a.doc,d=a.glob,c=a.view;a.ToolBar=function(a,c,g,h,p,l){this.prop("id",a);this._edge=c;this._visible=!1;this._autoSize=!0;this._overlay=!!p;this._height=this._width=void 0;switch(this._edge){case "top":this._dimension="height";this._border="borderBottom";this._direction=1;break;case "bottom":this._dimension="height";this._border="borderTop";this._direction=-1;break;case "left":this._dimension="width";this._border="borderRight";this._direction=1;break;case "right":this._dimension=
"width",this._border="borderLeft",this._direction=-1}this._frame=b.create("div","oit-toolframe");this._toolbar=b.create("div","oit-toolbar");this._toolsElem=g;this._content=b.create("div","oit-toolcontent");this._toolbar.append(this._toolsElem);this._frame.append(this._toolbar,this._content);this._overlay&&this._toolbar.css("z-index",10);h&&(b.unwrap(this._toolbar).style[this._border]=h);a=l?l._content:d.rootNode;this._content.transferFrom(a);a.append(this._frame)};var g=a.subclass(a.ToolBar);g.filter=
function(a){return a===this.id};g.refresh=function(){this.applySize();this.dispatchSize()};g.isInternal=function(){return 0>this.id};g.remove=function(){var b=this._frame.parent();b&&(b.transferFrom(this._content),this._frame.destroy());this.isInternal()||a.dispatch("toolbars","remove",this.id,this._edge)};g.isVisible=function(){return this._visible};g.show=function(d){var g=this._toolbar;d=d||{};if(!this._visible){this._visible=!0;this._toolbar.css("display","block");if(void 0===this._borderSize&&
(this._borderSize=0,b.unwrap(this._toolbar).style[this._border])){var m=this._toolbar.computedStyle();m&&(this._borderSize=parseInt(m[this._border+"Width"]))}this.applySize();this.isInternal()||a.dispatch("toolbars","show",this.id,this._edge,g.offsetWidth,g.offsetHeight)}this.dispatchSize(d.refresh);c.dispatchResize()};g.hide=function(){this._visible&&(this._visible=!1,this._toolbar.removeStyle("display"),this.applySize(),this.dispatchSize(),this.isInternal()||a.dispatch("toolbars","hide",this.id,
this._edge),c.dispatchResize())};g.setSize=function(a){"auto"===a?(this._toolbar.css(this._dimension,null),this._autoSize=!0):(this._toolbar.css(this._dimension,a),this._autoSize=!1);this.applySize();this.dispatchSize()};g.applySize=function(a){var b=this._toolbar,c=this._content,d=this._toolsElem,g=this._frame;b.removeStyle(["bottom","top","right","left"]);if(void 0===a)if(this._visible){switch(this._edge){case "top":case "bottom":this._size=this._autoSize?d.offsetHeight:b.offsetHeight;break;case "left":case "right":this._size=
this._autoSize?d.offsetWidth:b.offsetWidth}a=this._size}else a=0;void 0!==this._borderSize&&(a+=this._borderSize);d=g.clientWidth;g=g.clientHeight;switch(this._edge){case "top":b.css("bottom",g-a+"px");this._overlay||c.css("top",a+"px");break;case "bottom":b.css("top",g-a+"px");this._overlay||c.css("bottom",a+"px");break;case "left":b.css("right",d-a+"px");this._overlay||c.css("left",a+"px");break;case "right":b.css("left",d-a+"px"),this._overlay||c.css("right",a+"px")}};g.dispatchSize=function(b){if(!this.isInternal()){var c=
this._toolbar;if(b||c.offsetWidth!=this._width||c.offsetHeight!=this._height)this._width=c.offsetWidth,this._height=c.offsetHeight,a.dispatch("toolbars","resize",this.id,this._edge,this._width,this._height)}};g.getRect=function(){var a={top:0,height:0,left:0,width:0};a.top=this._toolbar.dom.offsetTop;a.height=this._toolbar.dom.offsetHeight;a.left=this._toolbar.dom.offsetLeft;a.width=this._toolbar.dom.offsetWidth;return a}});OIT.extend(function(a){var b=a.doc,d=a.toolbars,c=OIT.local;a.TabBar=function(){var g,f,k,m,h,p=[],l,n,x,s;this.show=function(){g&&g.show()};this.hide=function(){g&&g.hide()};this.length=function(){return p.length};this.addPrevNext=function(d,e){if(!m){m=new a.Button("\u25c4",c.PAGE_UP);d&&(m.onclick(d),m.ontap(d));h=new a.Button("\u25ba",c.PAGE_DOWN);e&&(h.onclick(e),h.ontap(e));var g=b.create("div","oit-tab-nextprev");g.append(m,h);f.append(g)}};this.addTab=function(a,c,d){var f=b.create("div",
"oit-tab");f.html("<div>"+a+"</div>");k.append(f);p.push(f);if(c instanceof Function)f.on("click",null,w,c,d).on("tap",null,w,c,d);return p.length-1};var w=function(a,b,c){b(c)};this.setActiveTab=function(a){if(0<=a&&(a<p.length&&a!=l)&&(void 0!=l&&p[l].removeClass("oit-tab-selected"),l=a,p[l].addClass("oit-tab-selected"),m.disabled=0==l,h.disabled=l+1>=p.length,void 0!==l)){a=p[l].rect(f);var b=k.rect(f),c=b.left;a.right>b.right?c-=a.right-b.right:0>a.left&&(c-=a.left);0<=c?k.css("left",null):k.css("left",
c+"px")}};this.destroy=function(){g&&d.removeInternal(-2);f&&f.destroy();p=h=m=k=f=g=null};f=b.create("div","oit-tab-bar");k=b.create("div","oit-tab-list");f.append(k);k.kinetic(!0);k.ondragstart(function(a){a=k.rect(f);n=a.left;x=a.right;s=p[p.length-1].rect(f).right});k.ondragmove(function(a){var b=a.delta.x;a=n+b;0>a&&(b=s+b,b<x&&(a+=x-b));0<a&&(a=0);k.css("left",a+"px")});g=new a.ToolBar(-2,"bottom",f);d.addInternal(-2,g);g.show()}});OIT.extend(function(a){var b=a.doc,d=a.toolbars,c=a.highlights;a.NotesBar=function(){var f,g,m,h,p=6,l,n,x={},s=-1;this.show=function(){g&&g.show()};this.hide=function(){g&&g.hide()};this.setContents=function(a){h.html(a);this._spanMap=void 0};this.getContents=function(){return h};this.destroy=function(){OIT.toolbars.removeEventListener("resize",D);OIT.toolbars.removeEventListener("show",q);g&&d.removeInternal(-1);m&&m.off("mousedown",t);m=h=f=g=void 0};this.createSpanList=function(){for(var b=[],
c,d=h.createTreeWalker(NodeFilter.SHOW_ELEMENT),e=d.firstACCNode();e;){e=d.currentNode;e.dataset&&e.dataset.acc&&(c=Number(e.dataset.acc));for(var f=!0,g=e.firstChild;g;g=g.nextSibling)if(3==g.nodeType){f=!1;break}!f&&void 0!==c?(c=new a.SpanInfo(e,c),b.push(c),c=c.accend,(e=d.skipNode())&&(e=d.firstACCNode())):e=d.nextACCNode()}0==b.length&&(b=null);return b};this.extractMatchingSpanInfos=function(a){var b=[],c=this.createSpanList();if(void 0!==a&&null!=c&&0<a.length&&0<c.length)for(var d=0;d<a.length;d++)for(var e=
0;e<c.length;e++)if(a[d].acc==c[e].acc&&a[d].accend==c[e].accend){b.push(c[e]);break}return b};this.getHeight=function(){return f.offsetHeight};this.toolbar=function(){return g};this.toNotesBarY=function(a){var b=g.getRect();return a-b.top};this.makeHighlightLayer=function(b){var c=x[b];void 0===n&&(n=new a.Drawing(f));void 0===c&&(c=new a.DrawingLayer(n,b,"oit.nboverlay.1."+b),x[b]=c);return c};this.removeHighlightsFromPage=function(a){c.each(y,null,a)};this.addHighlightsToPage=function(a){c.each(v,
null,a)};this.setPageNumber=function(a){s=a};this.getPageNumber=function(){return s};var w=function(a){a=window.innerHeight-a.clientY-2;a<p&&(a=p);g.setSize(a+"px")},t=function(a){l=b.cursor();b.cursor("ns-resize");a.preventDefault();document.addEventListener("mousemove",w);document.addEventListener("mouseup",e)},e=function(){b.cursor(l);document.removeEventListener("mouseup",e);document.removeEventListener("mousemove",w)},q=function(a){f.css("height",(a?a.detail.height:f.offsetHeight)+"px")},y=function(a,
b){a._pageInfo&&b<a._pageInfo.length&&a.removeFromPage(a._pageInfo[b])},v=function(a,b){a.addToPage(b,!1)},D=function(a){-1==a.detail.id&&(p=m.offsetHeight+1,q(a))};f=b.create("div","oit-slidenotesbar","oit-notesbar.1");m=b.create("div","oit-vertical-sizebar");f.append(m);h=b.create("div","oit-slidenotes");f.append(h);g=new a.ToolBar(-1,"bottom",f);d.addInternal(-1,g);g.show();p=m.offsetHeight+1;OIT.toolbars.addEventListener("resize",D);OIT.toolbars.addEventListener("show",q);m.onmousedown(t);this.bNotesBar=
!0;a.Page.call(this,1E4,"slidenotesbar","oit-notesbar.1");this.type="slide"};var g=a.subclass(a.NotesBar,a.Page);g.inRect=function(a,b){var c=!1,d=this.toolbar().getRect();d.top<=b&&(b<=d.top+d.height&&d.left<=a&&a<=d.left+d.width)&&(c=!0);return c};g.mousePos=function(a){var b={x:0,y:0};b.x=a.clientX;b.y=a.clientY;return b};g.isHidden=function(){return!this.toolbar().isVisible()}});OIT.extend(function(a){var b=a.util;a.SpreadsheetCellGroup=function(a,b,g){this._index=a;this._size=g;this._hidden=!1;b&&(this._hidden=!0===b.hidden,void 0!==b.h?this._size=b.h:void 0!==b.w&&(this._size=b.w),void 0!==b.t&&(this._title=b.t),void 0!==b.st&&(this._styleIndex=b.st),this._acc=b.acc,this._accend=b.accend);this._originalHidden=this._hidden;this._originalSize=this._size};a=a.subclass(a.SpreadsheetCellGroup);a.index=function(){return this._index};a.title=function(){this._title||(this._title=
b.defaultSSColHeader(this._index));return this._title};a.style=function(){return this._styleIndex};a.setCellData=function(a){this._data=a;if(void 0===this._acc){for(a=0;a<this._data.length;a++){var b=this._data[a];if(b.t&&void 0!==b.a){this._acc=b.a;break}}if(void 0!=this._acc)for(a=this._data.length-1;0<=a;a--)if(b=this._data[a],b.t&&void 0!==b.a){this._accend=b.a+b.t.length-1;break}}};a.hidden=function(){return this._hidden};a.show=function(a){return this._hidden||5>this._size?(this._hidden=!1,
5>this._size&&(this._size=a),!0):!1};a.reset=function(){var a=!1;void 0!=this._originalSize&&(this._size=this._originalSize,a=!0);!this._hidden&&this._originalHidden&&(a=this._hidden=!0);return a};a.size=function(){return this._hidden?0:this._size};a.setSize=function(a){if("number"!==typeof a)throw"Invalid argument to setSize";this._size=a;this._hidden=0==a};a.getCellsForRange=function(a,b){if(this._data&&void 0!==this._acc&&a<=this._accend&&b>=this._acc){for(var g,f=0;f<this._data.length;f++){var k=
this._data[f];k.t&&void 0!==k.a&&(a<=k.a+k.t.length&&b>=k.a)&&(g||(g=[]),g.push(k))}return g}};a.getIndexForCell=function(a){if(this._data){for(var b=0,g=0;g<this._data.length;g++){var f=this._data[g];if(f==a)break;null==f||!f.e?b++:b+=f.e}return b}};a.getCell=function(a){if(this._data){if(void 0===this._getCellIndex||a<this._getCellIndex)this._getCellEmpty=this._getCellIndex=this._cellDataIndex=0,0<this._data.length&&this._data[0].e&&(this._getCellEmpty=this._data[0].e);for(;this._getCellIndex<a;){0<
this._getCellEmpty&&this._getCellEmpty--;if(0===this._getCellEmpty){this._cellDataIndex++;if(this._cellDataIndex>=this._data.length){this._getCellIndex=a;return}var b=this._data[this._cellDataIndex];this._getCellEmpty=b?b.e||0:1}this._getCellIndex++}if(this._cellDataIndex<this._data.length)return this._data[this._cellDataIndex]}}});OIT.extend(function(a){var b=a.doc,d=a.glob,c=a.selection,g=a.range,f=a.ajax,k=a.util,m=a.dialog,h=a.display,p=OIT.local,l=a.SpreadsheetCellGroup;a.SpreadsheetModel=function(a,b){this._top=this._left=null;this._extRowCount=this._extColCount=this._bottom=this._right=void 0;this._merged=null;this._ajax=[];this._hideMsg=!1;this._fonts=a.sheet.fonts;this._styles=a.styles;a.sheet.hasOwnProperty("s")?this._sheetStyle=this.cellStyle(a.sheet.s):this._sheetStyle={};this._colMajor="colmajor"===a.sheet.order;
this._defColWidth=a.sheet.defcw||80;this._defRowHeight=a.sheet.defrh||20;a.cols||(a.cols=[]);a.rows||(a.rows=[]);this._colCount=0<a.sheet.c?a.sheet.c:a.cols.length;this._rowCount=0<a.sheet.r?a.sheet.r:a.rows.length;this._cols=[];for(var c=0;c<a.cols.length;c++){var d=a.cols[c];if(void 0!==d.s)for(var f=d.e||d.s,g=d.s;g<=f;g++)this._cols[g]=new l(g,d,this._defColWidth);else this._cols[c]=new l(c,d,this._defColWidth)}this._rows=[];for(c=0;c<a.rows.length;c++)if(d=a.rows[c],void 0!==d.s){f=d.e||d.s;
for(g=d.s;g<=f;g++)this._rows[g]=new l(g,d,this._defRowHeight)}else this._rows[c]=new l(c,d,this._defRowHeight);a.cells&&s(this,a.cells);if(a.data){this._extraData=a.data;for(f=0;f<this._extraData.length;f++)this._extraData[f].iend=f+1<this._extraData.length?this._extraData[f+1].i-1:this._colMajor?this._colCount:this._rowCount}this._embeds=b};a=a.subclass(a.SpreadsheetModel);var n=function(a,b,c){a=a.getCell(b,c);return!a?"":a.t||a.v||""};a.updateDimensions=function(){this._right=this.colLeft(this._colCount);
this._bottom=this.rowTop(this._rowCount);this._extColCount=this._colCount;this._extRowCount=this._rowCount;var a=this.embeddingCount();if(a){for(var b=0;b<a;b++){var c=this.embed(b);if(c){if(!c.expansionApplied){var d=this.embed(b);if(d.node&&!d.originApplied){d.originApplied=!0;d.adjustX=0;d.adjustY=0;var f=d.node.data("origin");f&&(f=f.split(","),2==f.length&&(d.adjustX=Number(f[0]),d.adjustY=Number(f[1])))}}var g=this.colWidth(c.c1),h=this.rowHeight(c.r1),k=c.x1,l=c.y1;k>g&&(k=g);l>h&&(l=h);d=
this.colLeft(c.c1)+k;f=this.rowTop(c.r1)+l;c.position={left:d,top:f};void 0===c.c2?(c.position.right=d+c.w,c.position.bottom=f+c.h):(g=this.colWidth(c.c2),h=this.rowHeight(c.r2),k=c.x2,l=c.y2,k>g&&(k=g),l>h&&(l=h),g=this.colLeft(c.c2)+k,l=this.rowTop(c.r2)+l,g<d&&(g=d),l<f&&(l=f),c.position.right=g,c.position.bottom=l);c.position.right>this._right&&(this._right=c.position.right);c.position.bottom>this._bottom&&(this._bottom=c.position.bottom)}}this._extColCount=this.colFromX(this._right)+1;this._extRowCount=
this.rowFromY(this._bottom)+1;this._right=this.colLeft(this._extColCount);this._bottom=this.rowTop(this._extRowCount)}};a.unload=function(){k.each(this._ajax,f.abort);this._ajax=[];this._embeds=this._styles=this._fonts=this._sheetStyle=this._merged=this._rows=this._cols=null};a.sheetStyle=function(){return this._sheetStyle};a.webFonts=function(){return this._fonts};a.showHidden=function(a){a&&(this._showHidden="columns"===this._showHidden&&"rows"===a||"rows"===this._showHidden&&"columns"===a?"all":
a);return this._showHidden};a.embeddingCount=function(){return this._embeds?this._embeds.length:0};a.embed=function(a){if(this._embeds&&0<=a&&a<this._embeds.length){if((a=this._embeds[a])&&!a.node)a.node=b.byId(a.id),a.node&&(!a.node.hasClass("oit-svg-embed")&&!a.node.hasClass("oit-image-embed"))&&(a.node=a.node.parent());return a}};a.embedByUID=function(a){return k.byProperty(this._embeds,"uid",a)};a.getCell=function(a,b){if(this._colMajor){var c=this._cols[a];if(c)return c.getCell(b)}else if(c=
this._rows[b])return c.getCell(a);return null};a.cellFromPos=function(a,b,c){(!this._right||!this._bottom)&&this.updateDimensions();a=this.colFromX(a);b=this.rowFromY(b);a>=this._extColCount&&(a=this._extColCount-1);b>=this._extRowCount&&(b=this._extRowCount-1);if(!1!==c&&(c=this.getMergedCell(a,b)))a=c.range.c1,b=c.range.r1;return g.cellRange(a,b)};a.prevTextCell=function(a,b){var c=a-50;0>c&&(c=0);if(this._colMajor)for(var d=a-1;d>=c;d--){var f=this._cols[d];if(f&&(f=f.getCell(b))&&(f.t||f.v))return d}else{var g=
this._rows[b];if(g)for(d=a-1;d>=c;d--)if((f=g.getCell(d))&&(f.t||f.v))return d}};a.cellStyle=function(a){return this._styles&&void 0!==a&&0<=a&&a<this._styles.length?this._styles[a]:{}};a.rowCount=function(){void 0===this._bottom&&this.updateDimensions();return this._extRowCount};a.colCount=function(){void 0===this._right&&this.updateDimensions();return this._extColCount};a.eachRow=function(a){for(var b in this._rows)a(Number(b))};a.eachCol=function(a){for(var b in this._cols)a(Number(b))};a.rowHeight=
function(a){a=this._rows[a];return!a?this._defRowHeight:a.size()};a.colWidth=function(a){a=this._cols[a];return!a?this._defColWidth:a.size()};a.setRowHeight=function(a,b){this._rows[a]||(this._rows[a]=new l(a,null,this._defRowHeight));var c=this._rows[a];c&&(c.setSize(b),this._top=null,this._right=void 0)};a.setColWidth=function(a,b){this._cols[a]||(this._cols[a]=new l(a,null,this._defColWidth));var c=this._cols[a];c&&(c.setSize(b),this._left=null,this._bottom=void 0)};a.showRow=function(a){return(a=
this._rows[a])&&a.show(this._defRowHeight)?(this._top=null,this._right=void 0,!0):!1};a.showCol=function(a){return(a=this._cols[a])&&a.show(this._defColWidth)?(this._left=null,this._bottom=void 0,!0):!1};a.resetRow=function(a){return(a=this._rows[a])&&a.reset()?(this._top=null,this._right=void 0,!0):!1};a.resetCol=function(a){return(a=this._cols[a])&&a.reset()?(this._left=null,this._bottom=void 0,!0):!1};a.colHidden=function(a){return(a=this._cols[a])?a.hidden():!1};a.rowHidden=function(a){return(a=
this._rows[a])?a.hidden():!1};a.colStyle=function(a){return(a=this._cols[a])?this.cellStyle(a.style()):{}};a.rowTop=function(a){if(!this._top){this._top=[];for(var b=0,c=0;c<=this._rows.length;c++){this._top.push(b);var d=this._rows[c],b=d?b+d.size():b+this._defRowHeight}}if(a<this._top.length)return this._top[a];b=this._top.length-1;return this._top[b]+(a-b)*this._defRowHeight};a.rowBottom=function(a){return this.rowTop(a+1)};a.rowFromY=function(a){for(var b=0;a>this.rowBottom(b);)b++;for(;0==this.rowHeight(b)&&
0<b;)b--;return b};a.colLeft=function(a){if(!this._left){this._left=[];for(var b=0,c=0;c<=this._cols.length;c++){this._left.push(b);var d=this._cols[c],b=d?b+d.size():b+this._defColWidth}}if(a<this._left.length)return this._left[a];b=this._left.length-1;return this._left[b]+(a-b)*this._defColWidth};a.colRight=function(a){return this.colLeft(a+1)};a.colFromX=function(a){for(var b=0;a>this.colRight(b);)b++;for(;0==this.colWidth(b)&&0<b;)b--;return b};a.sheetRight=function(){void 0===this._right&&this.updateDimensions();
return this._right};a.sheetBottom=function(){void 0===this._bottom&&this.updateDimensions();return this._bottom};a.colTitle=function(a){var b=this._cols[a];return b?b.title():k.defaultSSColHeader(a)};a.getMergedCell=function(a,b){var c;if(this._merged)for(var d=0;d<this._merged.length;d++){var f=this._merged[d].range;if(a>=f.c1&&a<=f.c2&&b>=f.r1&&b<=f.r2){c=this._merged[d];break}}return c};a.containsRange=function(a,b){if(this._colMajor)for(var c in this._cols){if(this._cols[c].getCellsForRange(a,
b))return!0}else for(var d in this._rows)if(this._rows[d].getCellsForRange(a,b))return!0;return!1};a.getCellsForRange=function(a,b){var c;if(this._colMajor)for(var d in this._cols){var f=this._cols[d].getCellsForRange(a,b);f&&(c=c?c.concat(f):f)}else for(var g in this._rows)(f=this._rows[g].getCellsForRange(a,b))&&(c=c?c.concat(f):f);return c};a.select=function(a){var b=!1;if(a&&"text"===a.type){if(0!=g.compare(a,this._selectedRange)){this.select(null);var c=this._selectedCells=this.getCellsForRange(a.acc,
a.accend);if(c){this._selectedRange=g.clone(a);for(b=0;b<c.length;b++){var d=c[b];d.selection=a;d.highlightsChanged=!0}b=!0}}}else if(this._selectedCells){c=this._selectedCells;delete this._selectedCells;delete this._selectedRange;for(b=0;b<c.length;b++)d=c[b],delete d.selection,d.highlightsChanged=!0;b=!0}return b};a.addHighlight=function(a){var b=!1;if(a)if("text"===a.range.type){var c=this.getCellsForRange(a.range.acc,a.range.accend);if(c){for(var d=0;d<c.length;d++){var f=c[d];f.highlights?-1==
f.highlights.indexOf(a)&&(f.highlights.push(a),f.highlightsChanged=!0):(f.highlights=[a],f.highlightsChanged=!0)}b=!0}}else if(a.isCompoundRedaction()&&"cell"===a.range.type&&(c=this.mapToText(a.range)))for(d=0;d<c.length;d++)if(f=c[d],f=this.getCell(f.cell.c,f.cell.r))f.highlights?-1==f.highlights.indexOf(a)&&(f.highlights.push(a),f.highlightsChanged=!0):(f.highlights=[a],f.highlightsChanged=!0);return b};a.removeHighlight=function(a){if(a)if("text"==a.range.type){var b=this.getCellsForRange(a.range.acc,
a.range.accend);if(b){for(var c=0;c<b.length;c++){var d=b[c];d.highlights&&(k.remove(d.highlights,a),0==d.highlights.length&&delete d.highlights,d.highlightsChanged=!0)}return!0}}else if(a.isCompoundRedaction()&&"cell"===a.range.type&&(b=this.mapToText(a.range)))for(c=0;c<b.length;c++)if(d=b[c],(d=this.getCell(d.cell.c,d.cell.r))&&d.highlights)k.remove(d.highlights,a),0==d.highlights.length&&delete d.highlights,d.highlightsChanged=!0;return!1};a.expandRange=function(a){if(this._merged){var b=!1;do for(var b=
!1,c=0;c<this._merged.length;c++){var d=this._merged[c];a.c1<=d.range.c2&&(a.c2>=d.range.c1&&a.r1<=d.range.r2&&a.r2>=d.range.r1)&&(d.range.c1<a.c1&&(a.c1=d.range.c1,b=!0),d.range.r1<a.r1&&(a.r1=d.range.r1,b=!0),d.range.c2>a.c2&&(a.c2=d.range.c2,b=!0),d.range.r2>a.r2&&(a.r2=d.range.r2,b=!0))}while(b)}return a};a.getHoverText=function(){if(this.isRangeSelected())return null;var a=c.cellSelection(),a=this.getCell(a.c1,a.r1);return!a||!a.clipped?null:a.t||a.v};a.isRangeSelected=function(){var a=c.cellSelection();
return a&&(a.c1!=a.c2||a.r1!=a.r2)};a.getSelectedText=function(){var a="";switch(c.selectionType()){case "text":if(this._selectedCells)for(var b=c.textSelection(),d=this._selectedCells,f=0;f<d.length;f++){var g=d[f];if(g.t){var h=b.acc-g.a;0>h&&(h=0);var k=b.accend-g.a;k>h&&(a&&(a+="\t"),a+=g.t.substring(h,k))}}break;case "cell":if(b=c.cellSelection(),this.isRangeSelected()){d=0;for(f=b.r1;f<=b.r2;f++){g=0;for(h=b.c1;h<=b.c2;h++){if(k=n(this,h,f)){if(0<d)for(1E3<d&&(d=1E3);0<d;d--)a+="\r\n";if(0<
g)for(1E3<g&&(g=1E3);0<g;g--)a+="\t";a+=k}g++}d++}}else a=n(this,b.c1,b.r1)||""}return a};a.mapToCells=function(a){if("text"==a.type){var b=[],c=a.acc;a=a.accend;if(this._colMajor)for(var d in this._cols){var f=this._cols[d],h=b,k=f.getCellsForRange(c,a);if(k)for(var r=0;r<k.length;r++){var l=f.getIndexForCell(k[r]),m=this.getMergedCell(f.index(),l);m?h.push(g.clone(m.range)):h.push(g.cellRange(f.index(),l))}}else for(f in this._rows)if(d=this._rows[f],h=b,k=d.getCellsForRange(c,a))for(r=0;r<k.length;r++)l=
d.getIndexForCell(k[r]),(m=this.getMergedCell(l,d.index()))?h.push(g.clone(m.range)):h.push(g.cellRange(l,d.index()));return b}};a.mapToText=function(a){if("cell"==a.type){var b;a=x(a);for(var c=a.r1;c<=a.r2;c++)for(var d=a.c1;d<=a.c2;d++){var f=this.getCell(d,c);if(f&&f.t&&void 0!==f.a){var h=f.a+f.t.length;b||(b=[]);f=g.textRange(f.a,h);f.cell={c:d,r:c};b.push(f)}}return b}};a.decomposeRange=function(a,b){if("cell"==a.type){a=x(a);var c=this.mapToText(a);if(b)c?c.push(a):c=[a];else{for(var d=[],
f=a.r1;f<=a.r2;f++)for(var h=null,k=a.c1;k<=a.c2;k++){var r=this.getCell(k,f);r&&r.v&&(h&&h.c2==k-1?h.c2=k:(h=g.cellRange(a.page,k,f,k,f),d.push(h)))}if(0<d.length){c||(c=[]);for(f=0;f<d.length;f++)if(h=d[f]){for(k=f+1;k<d.length;k++)if((r=d[k])&&r.r1==h.r2+1&&r.c1==h.c1&&r.c2==h.c2)h.r2=r.r2,d[k]=null;c.push(h)}}}return c}};var x=function(a){var b=a;if("cell"==a.type&&a.offsets){var b=a.c1,c=a.c2,d=a.r1,f=a.r2;if(b>c)var h=b,b=c,c=h;d>f&&(h=d,d=f,f=h);0>a.offsets.left&&0<b&&b--;0<a.offsets.right&&
c++;0>a.offsets.top&&0<d&&d--;0<a.offsets.bottom&&f++;b=g.cellRange(a.page,b,d,c,f)}return b},s=function(a,b){for(var c=a._colMajor?a._cols:a._rows,d=0,f=0;f<b.length;f++){var h=b[f];h instanceof Array||(d=h.i,h=h.d);c[d]||(a._colMajor?a._cols[d]=new l(d,null,a._defColWidth):a._rows[d]=new l(d,null,a._defRowHeight));c[d].setCellData(h);for(var k=0,r=0;k<h.length;k++){h=h[k];if(h.mh||h.mv){a._merged||(a._merged=[]);var m;m=a._colMajor?g.cellRange(f,r,f,r):g.cellRange(r,f,r,f);h.mh&&(m.c2+=h.mh);h.mv&&
(m.r2+=h.mv);a._merged.push({cell:h,range:m})}h.e?r+=h.e:r++}d++}},w=function(a,b,c,d){b=-1;for(var f=0;f<this._ajax.length;f++)if(this._ajax[f].url===a){b=f;break}-1!=b&&(this._ajax.splice(b,1),0===this._ajax.length&&this._hideMsg&&(m.hideMessage(),this._hideMsg=!1));200===d?(a=JSON.parse(c),a.cells&&(s(this,a.cells),h.update(!0))):this.logFatalError(null,"Failed to load resource from server (Error "+d+"): "+a)};a.loadDataForCells=function(a,b,c,d){if(this._extraData&&(this._colMajor||(a=b,c=d),
!this._pendingRange||this._pendingRange.start!=a||this._pendingRange.end!=c))this._pendingRange={start:a,end:c},void 0!==this._pendingTimer&&(k.clearTimeout(this._pendingTimer),this._pendingTimer=void 0),this._pendingTimer=k.setTimeout(t,200,this)};var t=function(){for(var a=!1,b=0;b<this._extraData.length;b++){var c=this._extraData[b];if(c){a=!0;if(c.i>this._pendingRange.end)break;c.iend>=this._pendingRange.start&&((c=c.f)&&"/"!=c.charAt(0)&&(c=k.concatURL(d.baseURL,c)),c=f.start({url:c,context:this,
complete:w}),m.messageVisible()||(m.showMessage(p.PLEASE_WAIT_DOWNLOADING),this._hideMsg=!0),this._ajax.push(c),this._extraData[b]=null)}}a||(this._extraData=null)}});OIT.extend(function(a){var b=a.doc,d=a.glob,c=a.util,g=a.math,f=a.css,k=a.selection,m={f:"_font",s:"_fontSize",fs:"_fontStyle",fw:"_fontWeight",d:"_textdec",ba:"_baseline",ta:"_angle",c:"_color",w:"_wrap",a:"_align",i:"_indent",v:"_valign",bdr:"_bdr",b:"_fill",bb:"_fillBg",bh:"_fillHatch"};a.TextMeasureDiv=null;a.SpreadsheetCellRenderer=function(a,b,c,d){this._data=a;this._model=b;this._style=a.s?b.cellStyle(a.s):{};a.t?this._text=a.t:a.v&&(this._text=a.v);d=this._style;c=a.c?b.colStyle(c):{};b=b.sheetStyle();
this._font="Arial";this._fontSize=10;this._align="g";this._indent=0;this._valign="b";for(var e in m)if(m.hasOwnProperty(e)){var f=d[e]||c[e]||b[e];void 0!==f&&(this[m[e]]=f)}a.c&&(this._color=a.c);if(this._angle&&"vertical"!==this._angle){for(;0>this._angle;)this._angle+=360;for(;360<=this._angle;)this._angle-=360;0==this._angle?this._angle=null:(this._angle=g.radians(360-this._angle),this._align="l",this._valign="b",this._indent=0)}this._bdr&&(this._topBorder=this._bdr[0],this._rightBorder=this._bdr[1],
this._bottomBorder=this._bdr[2],this._leftBorder=this._bdr[3],a.bs&&(-1!=a.bs.indexOf("t")&&(this._topBorder=null),-1!=a.bs.indexOf("r")&&(this._rightBorder=null),-1!=a.bs.indexOf("b")&&(this._bottomBorder=null),-1!=a.bs.indexOf("l")&&(this._leftBorder=null)),delete this._bdr);2>this._indent&&(this._indent=2);this._clearLeft=this._textRight=this._textLeft=0;this._clearRight=void 0};var h=a.subclass(a.SpreadsheetCellRenderer);h.hasText=function(){return this._text&&0<this._text.length};h.textRight=
function(){return this._textRight};h.horizontalMerge=function(){return this._data.mh||0};h.verticalMerge=function(){return this._data.mv||0};h.horizontalAlign=function(){return this._align};h.leftBorder=function(){return this._leftBorder||null};h.topBorder=function(){return this._topBorder||null};h.rightBorder=function(){return this._rightBorder||null};h.bottomBorder=function(){return this._bottomBorder||null};h.rangeRect=function(a){var b=this._wrappedText;if("text"===a.type&&b){var c,d=a.acc-this._data.a;
a=a.accend-this._data.a;0>d&&(d=0);a>this._text.length&&(a=this._text.length);for(var e=0;e<b.length;e++)for(var f=b[e],g=f.x,h=f.y,k=f.o,l=0;l<f.spans.length;l++){var m=f.spans[l],n=k+m.t.length;if(n>d&&k<a){var k=g+m.w,p=h+f.h;c?(g<c.left&&(c.left=g),h<c.top&&(c.top=h),k>c.right&&(c.right=k),p>c.bottom&&(c.bottom=p)):c={left:g,top:h,right:k,bottom:p}}g+=m.w;k=n}return c}};h.drawTextBackground=function(a,b,c,d,e,f,g){if(0>this._textLeft||this._textRight>f)b=d+this._textLeft,d+=this._textRight,b<
this._clearLeft&&(b=this._clearLeft),void 0!==this._clearRight&&d>=this._clearRight&&(d=this._clearRight-1),a.oitrect(b+1,e+1,d-b-1,g-1,"#ffffff")};h.drawBackground=function(c,d,e,f,g,h,k){if(this._fill||this.horizontalMerge()||this.verticalMerge())if(this._fillHatch){d=new a.Canvas(8,8);e=d.getContext("2d");this._fillBg&&e.oitrect(0,0,8,8,this._fillBg);e.strokeStyle=this._fill||"#ffffff";e.lineCap="square";"d"==this._fillHatch.charAt(0)?e.lineWidth=2:e.lineWidth=1;switch(this._fillHatch){case "lv":case "dv":e.oitline(1.5,
0,1.5,8);e.oitline(5.5,0,5.5,8);break;case "lh":case "dh":e.oitline(0,1.5,8,1.5);e.oitline(0,5.5,8,5.5);break;case "ldd":case "ddd":e.oitline(-0.5,-0.5,8.5,8.5);break;case "lud":case "dud":e.oitline(8.5,-0.5,-0.5,8.5);break;case "lg":case "dg":e.oitline(1.5,0,1.5,8);e.oitline(5.5,0,5.5,8);e.oitline(0,1.5,8,1.5);e.oitline(0,5.5,8,5.5);break;case "lt":case "dt":e.oitline(0,0,8,8),e.oitline(8,0,0,8)}d=c.createPattern(b.unwrap(d),"repeat");c.fillStyle=d;c.globalAlpha=1;c.fillRect(f+0.5,g+0.5,h+0.5,k+
0.5)}else c.oitrect(f+0.5,g+0.5,h+0.5,k+0.5,this._fill||"#ffffff")};var p=function(a,b,c,d,e){c||(c=1);var f=2*c;switch(b){case "dotted":b=[f,f];break;case "dashed":b=[2*f,f];break;case "dashdot":b=[2*f,f,f,f];break;case "dashdotdot":b=[2*f,f,f,f,f,f];break;case "double":b=[];c=Math.floor(c/3);1>c&&(c=1);break;default:b=[]}for(var g=f=0;g<b.length;g++)f+=b[g];e%=f;a.strokeStyle=d||"black";a.fillStyle=d||"black";a.lineWidth=c;a.setLineDash?(a.setLineDash(b),a.lineDashOffset=e):(a.mozDash=b,a.mozDashOffset=
e)},l=function(a){var b=Math.floor(a.w/3);1>b&&(b=1);a=a.w-(b+b);1>a&&(a=1);b=(b+a)/2;return[-b,b]},n=function(a,b){var c=0,d=0;if(a&&"double"===a.s)var e=l(a),c=-e[0];b&&"double"===b.s&&(e=l(b),d=e[1]);return c&&d?c>d?-c:-d:c?c:d},x=function(a,b){var c=0,d=0;if(a&&"double"===a.s)var e=l(a),c=-e[0];b&&"double"===b.s&&(e=l(b),d=e[1]);return c&&d?[-c,-d]:c?[-c,c]:[d,-d]},s=function(a,b,c,d,e,f,g,h,k){p(a,e.s,e.w,e.c,b);"double"===e.s?(e=l(e),f=x(f,g),h=x(h,k),f[0]||(f[0]=-0.5),f[1]||(f[1]=-0.5),h[0]||
(h[0]=0.5),h[1]||(h[1]=0.5),a.beginPath(),a.moveTo(b-f[0],c+e[0]),a.lineTo(d+h[0],c+e[0]),a.moveTo(b-f[1],c+e[1]),a.lineTo(d+h[1],c+e[1])):(e=n(f,g),h=n(h,k),e||(e=-0.5),h||(h=0.5),a.beginPath(),a.moveTo(b-e,c+0.5),a.lineTo(d+h,c+0.5));a.stroke()},w=function(a,b,c,d,e,f,g,h,k){p(a,e.s,e.w,e.c,c);"double"===e.s?(e=l(e),f=x(f,g),h=x(h,k),f[0]||(f[0]=-0.5),f[1]||(f[1]=-0.5),h[0]||(h[0]=0.5),h[1]||(h[1]=0.5),a.beginPath(),a.moveTo(b+e[0],c-f[0]),a.lineTo(b+e[0],d+h[0]),a.moveTo(b+e[1],c-f[1]),a.lineTo(b+
e[1],d+h[1])):(e=n(f,g),h=n(h,k),e||(e=-0.5),h||(h=0.5),a.beginPath(),a.moveTo(b+0.5,c-e),a.lineTo(b+0.5,d+h));a.stroke()},t=function(a,b){var c=null;a&&(c=a.bottomBorder());if(b){var d=b.topBorder();if(d&&(!c||d.w>c.w))c=d}return c},e=function(a,b){var c=null;a&&(c=a.rightBorder());if(b){var d=b.leftBorder();if(d&&(!c||d.w>c.w))c=d}return c};h.drawBorder=function(a,b,c,d,f,g,h,k){if(this._topBorder||this._rightBorder||this._bottomBorder||this._leftBorder){var l=d+g;h=f+h;a.lineCap="square";a.lineJoin=
"miter";a.globalAlpha=1;if(this._leftBorder&&0<=this._textLeft&&0<b){b=t(k[0][0],k[1][0]);var m=t(k[1][0],k[2][0]);w(a,d,f,h,this._leftBorder,b,this._topBorder,m,this._bottomBorder)}this._topBorder&&0<c&&(b=e(k[0][0],k[0][1]),c=e(k[0][1],k[0][2]),s(a,d,f,l,this._topBorder,b,this._leftBorder,c,this._rightBorder));this._rightBorder&&this._textRight<=g&&(c=t(k[0][2],k[1][2]),g=t(k[1][2],k[2][2]),w(a,l,f,h,this._rightBorder,this._topBorder,c,this._bottomBorder,g));this._bottomBorder&&(m=e(k[2][0],k[2][1]),
g=e(k[2][1],k[2][2]),s(a,d,h,l,this._bottomBorder,this._leftBorder,m,this._rightBorder,g));p(a,null)}};var q=function(a,b,c,d){if(c||d){var e={s:{},o:-1,oend:-1};"text"===b.type?(e.o=b.acc-a._data.a,0>e.o&&(e.o=0),e.oend=b.accend-a._data.a):(e.o=0,e.oend=a._text.length);c&&(e.s.c=c);d&&(e.s.bg=f.colorToString(d));return e}};h.layoutText=function(a,b,d,e,g,h,l){if(this.hasText()){d=!1;var m=null,n=this._data.selection,p=this._data.highlights;if(n||p&&0<p.length){m=[];if(n){var s=k.style()||"color:white;background-color:#3399FF;",
t=f.get(s,"color"),s=f.get(s,"background-color");(t=q(this,n,t,s))&&m.push(t)}if(p)for(n=0;n<p.length;n++){var w=p[n],t=w.css("color"),s=w.css("background-color");(t=q(this,w.range,t,s))&&m.push(t)}delete this._data.highlightsChanged}if(!this._wrappedText||!c.arraysEqual(m,this._highlightSpecs))this._highlightSpecs&&!m?delete this._highlightSpecs:this._highlightSpecs=m,this._wrappedText=null;this.horizontalMerge()||this.verticalMerge()?(this._clearLeft=b,this._clearRight=b+e):(this._clearLeft=h,this._clearRight=
l);e!=this._layoutWidth&&(this._wrappedText=null);g!=this._layoutHeight&&(d=!0);if(!this._wrappedText&&(this._textLeft=0,this._layoutWidth=this._textRight=e,"l"==this._align?this._textLeft=this._indent:"r"==this._align&&(this._textRight=e-this._indent),n=this._textRight-this._textLeft,d=!0,this._wrap||this._angle?this._wrappedText=this.wrapText(a,n):this._data.cs||-1!=this._text.indexOf("\n")?this._wrappedText=this.wrapText(a):(b=this.createLine(0,this._text.length,null),y(a,b,this),v(a,b,this),this._wrappedText=
[b]),a=this._wrappedText))if(n=void 0!==this._data.v,n="r"==this._align||"rs"==this._align||n&&"g"==this._align,"c"==this._align||"cs"==this._align)for(n=0;n<a.length;n++)b=a[n],b.x=(e-b.w)/2,h=b.x+b.w,b.x<this._textLeft&&(this._textLeft=b.x),h>this._textRight&&(this._textRight=h);else if(n)for(n=0;n<a.length;n++)b=a[n],b.x=e-2-b.w-this._indent,b.x<this._textLeft&&(this._textLeft=b.x);else for(n=0;n<a.length;n++)b=a[n],b.x=this._indent,h=b.x+b.w,h>this._textRight&&(this._textRight=h);if(d){this._layoutHeight=
g;a=this._wrappedText;e=a[a.length-1];e=e.y+e.h-a[0].y;d=0;"c"==this._valign?d=(g-e)/2:"b"==this._valign&&(d=g-e-2);for(n=0;n<a.length;n++)b=a[n],b.y=d,d+=b.h}}};h.drawText=function(a,b,c,d,e,h,k){if(b=this._wrappedText){c=!1;var l=b[b.length-1],l=l.y+l.h-b[0].y;this._data.clipped=!1;if(0>this._textLeft||this._textRight>h||l>k){h=d+this._textLeft;var m=d+this._textRight;if(h<this._clearLeft||void 0!==this._clearRight&&m>this._clearRight||l>k)h<this._clearLeft&&(h=this._clearLeft),void 0!==this._clearRight&&
m>this._clearRight&&(m=this._clearRight),a.save(),c=!0,a.beginPath(),a.fillStyle="black",a.rect(h,e,m-h,k),a.clip(),this._data.clipped=!0}a.globalAlpha=1;a.textAlign="left";a.textBaseline="alphabetic";this._angle&&("vertical"!==this._angle&&0<b.length)&&(c||(a.save(),c=!0),a.translate(d+b[0].x,e+b[0].y),d=-b[0].x,e=-b[0].y,a.rotate(this._angle));for(h=0;h<b.length;h++){l=b[h];if(l.y>k)break;for(var m=d+l.x,n=e+l.y,p=0;p<l.spans.length;p++){var q=l.spans[p],s=this._font,t=this._fontSize,v=this._fontStyle,
w=this._fontWeight,x=this._color,y=this._textdec,W=this._baseline,G=null;q.s&&(q.s.f&&(s=q.s.f),q.s.s&&(t=q.s.s),q.s.fs&&(v=q.s.fs),q.s.fw&&(w=q.s.fw),q.s.c&&(x=q.s.c),q.s.d&&(y=q.s.d),q.s.ba&&(W=q.s.ba),q.s.bg&&(G=q.s.bg));q.hs&&(q.hs.c&&(x=q.hs.c),q.hs.bg&&(G=q.hs.bg));var S=g.round(n+l.a);W&&("sup"===W?(S+=-0.35*l.a,t*=0.65):"sub"===W&&(S+=0.141*l.a,t*=0.65));G&&(a.fillStyle=f.rgbStringFromString(G),a.globalAlpha=f.opacityFromString(G),a.fillRect(m-1,S-l.a,q.w+2,l.h+2));a.font=D(s,t,v,w);a.fillStyle=
x||"black";a.globalAlpha=1;a.fillText(q.t,m,S);if(y){var R,U,T;switch(y){case "u":T=1;R=S+T;break;case "d":T=1;R=S+T;U=R+T+T;break;case "l":T=1,R=S-0.25*q.a}void 0!==R&&(R=g.round(R)+0.5,a.strokeStyle=x,a.lineWidth=T,a.beginPath(),a.moveTo(m,R),a.lineTo(m+q.w,R),void 0!==U&&(U=g.round(U)+0.5,a.moveTo(m,U),a.lineTo(m+q.w,U)),a.stroke(),a.closePath())}m+=q.w}}c&&a.restore()}};h.createLine=function(a,b,c){var d={x:0,y:0,w:0,h:0,spans:[],o:a};if(c){for(var e=a,f,g=0;g<c.length;g++){var h=c[g];if(h.o>
e){var k=h.o;k>b&&(k=b);e=this._text.substring(e,k);d.spans.push({t:e,w:0,s:f});e=k;if(e>=b)break}f=this._model.cellStyle(h.s)}e<b&&(e=this._text.substring(e,b),d.spans.push({t:e,w:0,s:f}))}else e=this._text.substring(a,b),d.spans.push({t:e,w:0});if(this._highlightSpecs)for(b=0;b<this._highlightSpecs.length;b++){c=this._highlightSpecs[b];e=a;for(f=0;f<d.spans.length;f++){g=d.spans[f];k=e+g.t.length;if(c.o<k&&c.oend>e){h=c.o-e;if(0<h){var k=g.t.substring(0,h),h=g.t.substring(h),l={t:k,w:0};g.s&&(l.s=
g.s);d.spans.splice(f,0,l);f++;g.t=h;e+=k.length;k=e+g.t.length}h=c.oend-e;h<g.t.length&&(k=g.t.substring(0,h),h=g.t.substring(h),l={t:h,w:0},g.s&&(l.s=g.s),d.spans.splice(f+1,0,l),g.t=k,k=e+g.t.length);g.hs||(g.hs={});c.s.c&&(g.hs.c=c.s.c);c.s.bg&&(g.hs.bg=c.s.bg)}e=k}}return d};var y=function(a,b,c){for(var d=b.w=0;d<b.spans.length;d++){var e=b.spans[d],f=c._font,g=c._fontSize,h=c._fontStyle,k=c._fontWeight,l=c._baseline;e.s&&(e.s.f&&(f=e.s.f),e.s.s&&(g=e.s.s),e.s.fs&&(h=e.s.fs),e.s.fw&&(k=e.s.fw),
e.s.baseline&&(l=e.s.baseline));l&&("sup"===l?g*=0.65:"sub"===l&&(g*=0.65));a.font=D(f,g,h,k);e.w=a.measureText(e.t).width;b.w+=e.w}return b.w},v=function(c,e,f){a.TextMeasureDiv||(a.TextMeasureDiv=b.create("div","oit-textmeasure"),d.rootNode.append(a.TextMeasureDiv));e.h=0;e.a=0;c=a.TextMeasureDiv;c.css("display","inline");for(var g=0;g<e.spans.length;g++){var h=e.spans[g],k=f._font,l=f._fontSize,m=f._fontStyle,n=f._fontWeight;h.s&&(h.s.f&&(k=h.s.f),h.s.s&&(l=h.s.s),h.s.fs&&(m=h.s.fs),h.s.fw&&(n=
h.s.fw));c.text(h.t);var p=b.create("span");c.append(p);c.css("font",D(k,l,m,n));c.offsetHeight>e.h&&(e.h=c.offsetHeight);h.a=p.offsetTop+1;h.a>e.h&&(h.a=e.h);h.a>e.a&&(e.a=h.a)}c.html("");c.attr("style","");c.removeStyle("display")};h.wrapText=function(a,b){var c=[];void 0!==b&&(b-=4);var d=0,e=0,f=0;if("vertical"===this._angle)b=0;else if(this._angle)if(this._angle===Math.PI/2||this._angle===3*Math.PI/2)b=this._layoutHeight;else{var g=Math.tan(this._angle),h=-this._layoutHeight-g,h=Math.sqrt(h*
h),k=Math.sqrt(g*g+this._layoutHeight*this._layoutHeight),g=2*this._layoutHeight+g,g=Math.sqrt(this._layoutHeight*this._layoutHeight+g*g),h=Math.min(Math.min(h,k),g);h<b&&(b=h)}for(;d<this._text.length;){for(;f<this._text.length;){h=this._text[f];if(" "==h||"\t"==h||"\n"==h)break;f++}h=this.createLine(d,f,this._data.cs);y(a,h,this);if((k=void 0!==b&&h.w>b)||"\n"==this._text[f]||f>=this._text.length){if(k)if(e>d)f=e,h=this.createLine(d,f,this._data.cs),y(a,h,this);else for(k=d+1;f>k&&!(f--,h=this.createLine(d,
f,this._data.cs),y(a,h,this),h.w<=b););c.push(h);f<this._text.length&&(h=this._text[f],(" "==h||"\t"==h||"\n"==h)&&f++);d=f}else e=f++}if(0!=c.length){for(e=d=0;e<c.length;e++)f=c[e],v(a,f,this),f.y=d,d+=f.h;return c}};var D=function(a,b,c,d){0>=b&&(b=10);var e="";c&&"normal"!==c&&(e+=c+" ");d&&"normal"!=d&&(e+=d+" ");return e+(b+"px "+a)}});OIT.extend(function(a){var b=a.doc,d=a.glob,c=a.opt,g=a.document,f=a.selection,k=a.util,m=a.math,h=a.range,p=a.highlights;a.SpreadsheetView=function(l,n){var x=this,s=l,w=n,t,e,q,y,v,D,u,E,r,z,B,C,J,H,M=[],A,F=0,K=0,I=40,L=22,N,P,O,Q,W=0,G=c.zoom,S="database"!==n.type,R,U=-1,T=-1,X=-1,Z=-1,fa=!1;this.unload=function(){x.hidePopup(!0);a.off("document","scroll",ha);a.off("selection","selectionchanged",ia);a.off("pages","pageload",ca);a.off("view","resize",$);J&&J.destroy();for(var b=s.embeddingCount(),
c=0;c<b;c++)s.embed(c).node=void 0;z&&(w.append(z),z=void 0);v&&v.destroy();u&&u.destroy();r&&r.destroy();t&&t.destroy();a.TextMeasureDiv&&(a.TextMeasureDiv.destroy(),delete a.TextMeasureDiv);A=M=H=J=C=B=z=r=E=u=D=v=y=t=w=s=x=null};this.layoutChanged=function(a){c.zoom!=G&&(x.hidePopup(),$(a))};var ca=function(a){z&&(w.append(z),B=z=void 0);$()};this.maxPageWidth=function(){var a=s.sheetRight();void 0!==R&&R>a&&(a=R);return a};this.maxPageHeight=function(){return s.sheetBottom()};this.padding=function(){return{left:I,
top:L,right:0,bottom:0}};this.visibleRange=function(){return h.cellRange(K,F,Q,O)};this.visibleHeight=function(){return sa(O)-ra(F)};this.scrollOffset=function(a,b){void 0===a&&(a=K);void 0===b&&(b=F);var c=m.round(s.colLeft(a)*G)+1,d=m.round(s.rowTop(b)*G)+1;return{left:c,top:d}};var ha=function(a,b,c,d,e){var f=F;d/=G;if(0<c)for(;!(s.rowBottom(f)>=d);)f++;else if(0>c)for(c=F;0<=c;c--)if(s.rowTop(c)<=d){f=c;break}c=K;d=b/G;if(0<a)for(;!(s.colRight(c)>=d);)c++;else if(0>a)for(a=K;0<=a;a--)if(s.colLeft(a)<=
d){c=a;break}if(c!=K||f!=F)K=c,F=f,!1!==e&&(x.update(),x.hidePopup())},ia=function(a,c){if(c){if(H){var e=s.getSelectedText();H.html(e);H.select()}x.hidePopup();if(!s.isRangeSelected()){var f=g.cellSelection();if(f){var h=s.getHoverText(f.c1,f.r1);if(h){e=d.viewNode;C=w.overlay.childByClass("oit-cellpopup");C||(C=b.create("div","oit-cellpopup"),w.overlay.append(C));var k=Math.floor(0.8*e.clientWidth);C.css({"max-width":k+"px","white-space":"nowrap",opacity:0,display:null});C.html(h);h=C.clientWidth;
h>k&&(h=k);var k=I-s.colLeft(K)+s.colLeft(f.c1)+1,f=L-s.rowTop(F)+s.rowBottom(f.r1),k=m.round(k*G),f=m.round(f*G),l=m.round((e.clientWidth-10-h)*G);k>l&&(k=l);e=e.pos();C.css({left:e.left+k+"px",top:e.top+f+"px","max-width":h+"px","white-space":null});C.animate({opacity:1,startCSS:{display:null}})}}}}da();ja()};this.showHidden=function(a,b){var c=!1;!0===a?s.eachCol(function(a){s.showCol(a)&&(c=!0)}):!1===a&&s.eachCol(function(a){s.resetCol(a)&&(c=!0)});!0===b?s.eachRow(function(a){s.showRow(a)&&
(c=!0)}):!1===b&&s.eachRow(function(a){s.resetRow(a)&&(c=!0)});c&&(p.deactivate(),f.update(),x.update(),p.positionAll())};var $=function(a,f){var g=d.viewNode;if(!y||e!=g.clientWidth||q!=g.clientHeight||G!=c.zoom)e=g.clientWidth,q=g.clientHeight,G=c.zoom,m.round(e/G),W=m.round(q/G),(g=va())&&(1==G?g.css("transform",null):g.css("transform","scale("+G+","+G+")")),y&&(y.destroy(),D.destroy(),E.destroy()),v||(v=b.create("div","oit-ssgrid"),u=b.create("div","oit-sscolheader"),u.onmousemove(ma),u.ondragstart(ga),
u.ondragmove(la),u.ondragend(pa),u.ondragcancel(pa),u.onpress(qa),u.onpressup(wa),r=b.create("div","oit-ssrowheader"),r.onmousemove(xa),r.ondragstart(ya),r.ondragmove(za),r.ondragend(ta),r.ondragcancel(ta),r.onpress(Aa),r.onpressup(Ba),t.append(v,u,r)),t.css({width:e+"px",height:q+"px"}),I=r.offsetWidth,L=u.offsetHeight,y=v.createCanvas(),D=u.createCanvas(),E=r.createCanvas(),s.updateDimensions(),x.update()};this.pageRect=function(b,d){if("view"===d||"overlay"===d||d===w){var e=0,f=0,g=s.sheetRight(),
h=s.sheetBottom();if("view"===d||"overlay"===d){var k=c.zoom;1!=k&&(e*=k,f*=k,g*=k,h*=k);"view"===d&&(k=this.scrollOffset(),e+=I-k.left,f+=L-k.top,g+=I-k.left,h+=L-k.top)}return new a.Rectangle(e,f,g,h,d)}};this.rangeRect=function(b,c,d){var e;if("cell"===b.type)e=b.offsets?new a.Rectangle(s.colLeft(b.c1)+b.offsets.left,s.rowTop(b.r1)+b.offsets.top,s.colLeft(b.c2)+b.offsets.right,s.rowTop(b.r2)+b.offsets.bottom,w):new a.Rectangle(s.colLeft(b.c1)+1,s.rowTop(b.r1)+1,s.colRight(b.c2),s.rowBottom(b.r2),
w);else if("rect"===b.type){if("px"!==b.units&&(b=h.clone(b),h.convert(b,"px")),e=new a.Rectangle(b),void 0!==b.embedId){var f=s.embedByUID(b.embedId);b=w.embeddingRect(b.embedId);f&&b&&e.offset(b.left,b.top)}}else if("text"==b.type)for(var f=s.mapToCells(b),g=0;g<f.length;g++){var k=f[g],l=s.colLeft(k.c1),m=s.rowTop(k.r1),n=s.getCell(k.c1,k.r1),r;r=k.c1;var p=k.r1;r=r>=A.c1&&r<=A.c2&&p>=A.r1&&p<=A.r2?M[p-A.r1][r-A.c1]:void 0;p=!1;r?n&&n.highlightsChanged&&(p=!0):(r=ba(k.c1,k.r1),p=!0);p&&(n=y.getContext("2d"),
n.save(),n.font="12px Arial,Helvetica,sans-serif",Y(n,k.c1,k.r1,r),n.restore());if(k=r.rangeRect(b))k.left+=l,k.right+=l,k.top+=m,k.bottom+=m,e?e.union(k):e=new a.Rectangle(k,w)}if(e)return!0===d&&(d=s.colLeft(K)-100,b=s.rowTop(F)-100,f=s.colRight(P)+100,g=s.rowBottom(N)+100,e.intersect(d,b,f,g)),e.origin=c,e};this.rangeFromRect=function(b,c,d,e,f,g,k,l,m,r){b=new a.Rectangle(c,d,e,f,g);b.origin=w;if(void 0!==l)return m=n.embeddingRect(l),"move"===k?b.constrain(m):b.intersect(m),b.offset(-m.left,
-m.left),c=b.toRange(),c.embedId=l,h.convert(c,"pct"),c;"move"!==k&&("resize"!==k&&"extend"!==k)&&("view"===g&&(c-=I,d-=L),r|=c<s.colLeft(K),m|=d<s.rowTop(F));l=new a.Rectangle(0,0,s.sheetRight(),s.sheetBottom(),w);"move"===k?b.constrain(l):b.intersect(l);l=!r&&!m;c=s.cellFromPos(b.left,b.top,l);l=s.cellFromPos(b.right,b.bottom,l);r?(c.c1=0,c.c2=s.colCount()-1,c.selectingRows=!0):c.c2=l.c1;m?(c.r1=0,c.r2=s.rowCount()-1,c.selectingCols=!0):c.r2=l.r1;if("move"===k||"resize"===k)k=x.rangeRect(c,w,!1),
b.left-1>k.left&&c.c1<c.c2&&(c.c1+=1),b.top-1>k.top&&c.r1<c.r2&&(c.r1+=1),b.right<k.right&&c.c1<c.c2&&(c.c2-=1),b.bottom<k.bottom&&c.r1<c.r2&&(c.r2-=1);!r&&!m?(c.offsets={left:b.left-s.colLeft(c.c1),top:b.top-s.rowTop(c.r1),right:b.right-s.colLeft(c.c2),bottom:b.bottom-s.rowTop(c.r2)},s.expandRange(c)):(r&&(c.selectingRows=!0),m&&(c.selectingCols=!0));return c};this.extendRange=function(a,b,c,d){var e=x.rangeRect(a,d,!1),f=e.left,e=e.top,f=a.selectingRows?f-I:f+1,e=a.selectingCols?e-L:e+1;b=x.rangeFromRect(a.page,
f,e,b,c,d,"extend",void 0,a.selectingCols,a.selectingRows);b.offsets&&!a.offsets&&delete b.offsets;return b};this.update=function(a){var b=d.viewNode;if(!fa){fa=!0;var c=s.webFonts();if(c&&0<c.length)for(var g=c.length-1;0<=g;g--)k.loadWebFont(c[g])}c=m.round(-s.colLeft(K)*G);g=m.round(-s.rowTop(F)*G);d.drawing.setOrigin(c+I,g+L);P=K;Q=void 0;for(var l=I;P<s.colCount();){l+=m.round(s.colWidth(P)*G);if(l>=b.clientWidth){l==b.clientWidth?Q=P:(Q=P-1,Q<K&&(Q=K));break}P++}void 0===Q&&(Q=P);N=F;O=void 0;
for(l=L;N<s.rowCount();){l+=m.round(s.rowHeight(N)*G);if(l>=b.clientHeight){l==b.clientHeight?O=N:(O=N-1,O<F&&(O=F));break}N++}void 0===O&&(O=N);s.loadDataForCells(K,F,P,N);if(l=ua()){var n=d.viewNode,r=n.pos(n.parent());l.css({left:r.left+I+"px",top:r.top+L+"px",width:n.clientWidth-I+"px",height:n.clientHeight-L+"px"});va().css({left:c+"px",top:g+"px"});c=s.embeddingCount();for(g=0;g<c;g++)if((l=s.embed(g))&&l.node&&l.position)if(void 0===l.c2)l.node.css({left:l.position.left-l.adjustX+"px",top:l.position.top-
l.adjustY+"px"});else if(l.position.left===l.position.right||l.position.top===l.position.bottom)l.node.css("display","none");else{var n=(l.position.right-l.position.left)/l.w,r=(l.position.bottom-l.position.top)/l.h,p,q;if(1!=n||1!=r)p="scale("+n+","+r+")",q="left top";l.node.css({display:null,left:l.position.left-l.adjustX*n+"px",top:l.position.top-l.adjustY*r+"px",transform:p,"transform-origin":q})}}p=y.getContext("2d");p.clearRect(0,0,y.width,y.height);p.save();!0===a&&(A=null);c=K;if(0<K)for(a=
F;a<=N;a++)if(g=s.getCell(K,a),!g||!g.t&&!g.v)q=s.prevTextCell(K,a),void 0!==q&&q<c&&(c=q);if((q=A)&&(A.c1!=c||A.c2!=P||A.r1!=F||A.r2!=N)){if(c>A.c2||P<A.c1||F>A.r2||N<A.r1)M=q=null;A=null}if(!A){A=h.cellRange(c,F,P,N);g=A.r2-A.r1+1;l=A.c2-A.c1+1;c=M;M=Array(g);for(a=0;a<g;a++)M[a]=Array(l);r=n=null;for(a=A.r1;a<=A.r2;a++)for(l=A.c1;l<=A.c2;l++){var g=s.getCell(l,a),t=s.colStyle(l),r=g===n&&null===t?r:null;g&&!r&&(q&&(n=a-q.r1,0<=n&&n<c.length&&(t=l-q.c1,0<=t&&t<c[n].length&&(r=c[n][t]))),r||(r=ba(l,
a)));M[a-A.r1][l-A.c1]=r;n=g}}p.font="12px Arial,Helvetica,sans-serif";c=m.round((s.colRight(s.colCount()-1)-s.colLeft(K))*G);g=m.round((s.rowBottom(s.rowCount()-1)-s.rowTop(F))*G);l=d.viewNode;a=l.clientWidth;q=l.clientHeight;S||(a>c&&(a=c),q>g&&(q=g));p.oitrect(0,0,a,q,"#ffffff");p.fillStyle=S?"#f0f0f0":"#666666";l.clientWidth>c&&p.fillRect(c,0,l.clientWidth-c,l.clientHeight);l.clientHeight>g&&p.fillRect(0,g,l.clientWidth,l.clientHeight-g);for(c=K;;c++){g=m.round((s.colLeft(c)-s.colLeft(K))*G);
if(g>a)break;g+=0.5;p.oitline(g,0,g,q,"#e0e0e0")}for(c=F;;c++){g=ra(c);if(g>q)break;g+=0.5;p.oitline(0,g,a,g,"#e0e0e0")}a=R;s.colLeft(K);s.rowTop(F);for(c=q=0;c<M.length;c++)if(g=M[c],l=c+A.r1,n=s.rowHeight(l),0<n){r=0;A.c1!=K&&(r=s.colLeft(A.c1)-s.colLeft(K));for(var u=r,t=0;t<g.length;t++){var v=t+A.c1,z=s.colWidth(v);if(0<z){var B=g[t];if(B&&B.hasText()){Y(p,v,l,B,u,r,q,z,n);u=s.colLeft(v)+B.textRight();if(void 0===R||u>R)R=u;u=r+z}r+=z}}q+=n}q=b.clientWidth;c=b.clientHeight;B=s.sheetRight();t=
s.sheetBottom();void 0!==R&&R>B&&(B=R);w.width=B;w.height=t;g=d.viewNode;z=g.clientWidth/G;l=g.clientHeight/G;n=20/G;u=I/G;r=L/G;g=B+u+n;if(g>z){for(v=s.colCount()-1;s.colLeft(v)<B;)v++;for(var C=v,B=s.colWidth(C),C=C-1;0<=C;C--){var x=B+s.colWidth(C);if(x>z)break;B=x}B=z-B;0>B&&(B=0);z=s.colRight(v)+u+(B+n);z>g&&(g=z)}z=t+r+n;if(z>l){for(u=s.rowCount()-1;s.rowTop(u)<t;)u++;v=u;t=s.rowHeight(v);for(v-=1;0<=v;v--){B=t+s.rowHeight(v);if(B>l)break;t=B}B=l-t;0>B&&(B=0);B+=n;l=s.rowBottom(u)+r+B;l>z&&
(z=l)}w.css({width:g*G+"px",height:z*G+"px"});R!=a||q!=b.clientWidth||c!=b.clientHeight?(p.restore(),e=-1,$()):(p.scale(G,G),ka(p,"drawTextBackground"),ka(p,"drawBackground"),ka(p,"drawBorder",!0),ka(p,"drawText"),p.restore(),da(),ja(),f.update())};this.hidePopup=function(a){C&&C.animate({opacity:0,time:a?120:0,endCSS:{display:"none"}})};this.moveto=function(a,b,c){var d=!1;h.isRangeObject(a)&&("text"===a.type?(a=s.mapToCells(a))&&0<a.length&&(d=this.moveto(a[0],b,c)):"cell"===a.type&&(this.scrollToRange(a.c1,
a.r1,a.c2,a.r2),b&&b(c),d=!0));return d};this.scrollToRange=function(a,b,c,e){var f=d.viewNode,g,h;if(a<K)g=a;else if(c>Q){a=f.clientWidth-I;for(g=c;0<=g;){a-=m.round(s.colWidth(g)*G);if(0==a)break;if(0>a){g++;break}if(0==g)break;g--}}if(b<F)h=b;else if(e>O){b=f.clientHeight-L;for(h=e;0<=h;){b-=m.round(s.rowHeight(h)*G);if(0==b)break;if(0>b){h++;break}if(0==h)break;h--}}e=this.scrollOffset(g,h);var k,l;void 0!==g&&(k=e.left);void 0!==h&&(l=e.top);f.scroll(k,l)};var da=function(a){a=D.getContext("2d");
a.save();a.oitrect(0,0,u.clientWidth,u.clientHeight,"#d0d0d0");a.oitrect(0,0,I,L,"#aaa");a.oitrect(I-11.5,L-11.5,8,8,"#d0d0d0","#e0e0e0");a.fillStyle="black";a.textAlign="center";a.textBaseline="middle";var b=12;1<=G?a.font="12px Arial,Helvetica,sans-serif":(b*=G,8>b&&(b=8),a.font=b+"px Arial,Helvetica,sans-serif");for(var b=g.cellSelection(),c=L/2,d=!1,e=K;;e++){var f=m.round((s.colLeft(e)-s.colLeft(K))*G)+I+0.5;if(f>u.clientWidth)break;var h=m.round(s.colWidth(e)*G);0==h?d=!0:d&&(f+=1,d=!1);b&&
(e>=b.c1&&e<=b.c2)&&(a.oitrect(f,0,h,L,"#e8e8e8"),a.fillStyle="black");a.strokeStyle=b&&e>b.c1&&e<=b.c2?"#ccc":"#aaa";a.oitline(f,0,f,L,a.strokeStyle);f+=1;a.oitline(f,0,f,L,"#e0e0e0");if(!S&&e>=s.colCount())break;if(0<h){a.save();a.beginPath();a.rect(f,0,h,L);a.clip();var k=s.colTitle(e);a.measureText(k).width>=h?(f+=1,a.textAlign="left"):(f+=h/2,a.textAlign="center");a.fillText(k,f,c);a.restore()}}b=L+0.5;a.oitline(0,b,W,b,"#aaa");a.restore()},ja=function(a){a=E.getContext("2d");a.save();a.oitrect(0,
0,r.clientWidth,r.clientHeight,"#d0d0d0");a.fillStyle="black";a.textAlign="center";a.textBaseline="middle";var b=12;1<=G?a.font="12px Arial,Helvetica,sans-serif":(b*=G,8>b&&(b=8),a.font=b+"px Arial,Helvetica,sans-serif");for(var b=g.cellSelection(),c=I/2,d=!1,e=F;;e++){var f=ra(e)+0.5;if(f>r.clientHeight)break;var h=m.round(s.rowHeight(e)*G);0==h?d=!0:d&&(f+=1,d=!1);b&&(e>=b.r1&&e<=b.r2)&&(a.oitrect(0,f,I,h,"#e8e8e8"),a.fillStyle="black");a.strokeStyle=b&&e>b.r1&&e<=b.r2?"#ccc":"#aaa";a.oitline(0,
f,I,f,a.strokeStyle);f+=1;a.oitline(0,f,I,f,"#e0e0e0");if(!S&&e>=s.rowCount())break;0<h&&(a.save(),a.beginPath(),a.rect(0,f,I,h),a.clip(),a.fillText(String(e+1),c,f+h/2,I),a.restore())}b=I+0.5;a.oitline(b,0,b,r.clientHeight,"#aaa");a.restore()},aa=function(a,b){return!a||0>b||b>=a.length?null:a[b]},ka=function(a,b,c){var d=0,e;c&&(e=[[null,null,null],[null,null,null],[null,null,null]]);for(var f=null,g=null,h=0<M.length?M[0]:null,k=0;k<M.length;k++){var f=g,g=h,h=k+1<M.length?M[k+1]:null,l=k+A.r1,
m=s.rowHeight(l);if(0<m){var n=0;A.c1!=K&&(n=s.colLeft(A.c1)-s.colLeft(K));for(var r=0;r<g.length;r++){var p=r+A.c1,q=s.colWidth(p),t=g[r];if(0<q&&t){for(var u=t.horizontalMerge(),v=t.verticalMerge(),B=q,z=m,w=1;w<=u;w++)B+=s.colWidth(p+w);for(w=1;w<=v;w++)z+=s.rowHeight(l+w);!0==c&&(e[0][0]=aa(f,r-1),e[0][1]=aa(f,r),e[0][2]=aa(f,r+1),e[1][0]=aa(g,r-1),e[1][1]=t,e[1][2]=aa(g,r+1),e[2][0]=aa(h,r-1),e[2][1]=aa(h,r),e[2][2]=aa(h,r+1));t[b](a,p,l,n,d,B,z,e)}n+=q}d+=m}}},Y=function(a,b,c,d,e,f,g,h,k){void 0===
f&&(f=s.colLeft(b)-s.colLeft(K));void 0===g&&(g=s.rowTop(c)-s.rowTop(F));void 0===h&&(h=s.colWidth(b));void 0===k&&(k=s.rowHeight(c));if(void 0===e){e=f;for(var l=b-1;0<=l;l--){var m=s.getCell(l,c);if(m&&(m.t||m.v))break;e=s.colLeft(l)-s.colLeft(K)}}var m=d.horizontalMerge(),n=d.verticalMerge();if((l="cs"===d.horizontalAlign())||0<m)for(var r=1;(l||r<=m)&&(!l||!(l=s.getCell(b+r,c),l=!l||l.t||l.v?!1:"cs"===s.cellStyle(l.s).a,!l&&r>m));)h+=s.colWidth(b+r),r++;for(r=1;r<=n;r++)k+=s.rowHeight(c+r);m=
s.colLeft(K);n=s.colRight(P)-m;r=void 0;S||(r=s.colRight(b)-m);for(b+=1;;b++){l=s.getCell(b,c);if(!l)break;if(l.t||l.v){r=s.colLeft(b)-m;break}l=s.colRight(b)-m;if(l>n)break;S||(r=l)}d.layoutText(a,f,g,h,k,e,r)},ba=function(b,c){var d=s.getCell(b,c);if(d)return new a.SpreadsheetCellRenderer(d,s,b,c)},V=function(a){var b;if(a>=I){a-=I;for(var c=K;c<s.colCount();){var d=m.round((s.colRight(c)-s.colLeft(K))*G),e=d-3;if(e>a)break;var f=d+3;if(a>=e&&a<=f&&(b=c,a<=d))break;c++}}return b},na=function(a){var b;
if(a>=I){a-=I;for(b=K;!(a<m.round((s.colRight(b)-s.colLeft(K))*G));b++);}return b},ea=function(a){var b;if(a>=L){a-=L;for(var c=F;c<s.rowCount();){var d=sa(c),e=d-3;if(e>a)break;var f=d+3;if(a>=e&&a<=f&&(b=c,a<=d))break;c++}}return b},oa=function(a){var b;if(a>=L){a-=L;for(b=F;!(a<sa(b));b++);}return b},ma=function(a){-1==Z&&-1==T&&(a=d.viewNode.mousePos(a),a=void 0!==V(a.x)?"col-resize":null,D.css("cursor",a))},ga=function(a){return-1==Z&&(a=V(a.center.x),void 0!==a)?(T=a,!0):!1},la=function(a){if(-1!=
Z)a=na(a.center.x),f.select(h.cellRange(w.index,Z,0,a,s.rowCount()-1));else if(-1!=T){a=m.round((a.center.x-I)/G)+s.colLeft(K);var b=s.colLeft(T);a=a>=b?a-b:0;a!=s.colWidth(T)&&(s.setColWidth(T,a),f.update(),x.update(),p.positionAll())}},pa=function(a){-1!=T&&(T=-1,$(),p.positionAll())},qa=function(a){Z=na(a.center.x);f.select(h.cellRange(w.index,Z,0,Z,s.rowCount()-1))},wa=function(a){Z=-1},xa=function(a){-1==X&&-1==U&&(a=d.viewNode.mousePos(a),a=void 0!==ea(a.y)?"row-resize":null,E.css("cursor",
a))},ya=function(a){return-1==X&&(a=ea(a.center.y),void 0!==a)?(U=a,!0):!1},za=function(a){if(-1!=X)a=oa(a.center.y),f.select(h.cellRange(w.index,0,X,s.colCount()-1,a));else if(-1!==U){a=m.round((a.center.y-L)/G)+s.rowTop(F);var b=s.rowTop(U);a=a>=b?a-b:0;a!=s.rowHeight(U)&&(s.setRowHeight(U,a),f.update(),x.update(),p.positionAll())}},ta=function(a){-1!==U&&(U=-1,$(),p.positionAll())},Aa=function(a){X=oa(a.center.y);f.select(h.cellRange(w.index,0,X,s.colCount()-1,X))},Ba=function(a){X=-1},ra=function(a){return m.round((s.rowTop(a)-
s.rowTop(F))*G)},sa=function(a){return m.round((s.rowBottom(a)-s.rowTop(F))*G)},ua=function(){void 0===z&&(z=w.childByClass("oit-sheet-embedpane"))&&d.viewNode.parent().append(z);return z},va=function(){if(void 0===B){var a=ua();B=a?a.childByClass("oit-sheet-embedlist"):null}return B};(function(){var c=d.viewNode;t=c.parent().childByClass("oit-ssoverlay");t||(t=b.create("div","oit-ssoverlay"),c.parent().insert(t,c));t.html("");J=w.overlay.childByClass("oit-sel-text");J||(J=b.create("div"),w.overlay.append(J));
H=b.create("pre");J.addClass("oit-sel-text");J.html("");J.append(H);a.on("document","scroll",ha);a.on("selection","selectionchanged",ia);a.on("pages","pageload",ca);a.on("view","resize",$);c=c.scroll();ha(c.left,c.left,c.top,c.top,!1);$()})()}});OIT.extend(function(a){var b=a.opt,d=a.doc,c=a.glob,g=a.util,f=a.pages,k=a.highlights,m=a.selection,h=OIT.local,p=a.attachments,l=a.display,n=a.rawtext,x=a.range,s=a.view;a.EmailHeader=function(c){a.Element.call(this,c);d.attach(this);for(var e=h.LABEL_SEPARATOR,g=0;g<D.length;g++)if(c=d.byId("oit-email_"+D[g])){var k="EMAIL_"+D[g].toUpperCase();c.html(h[k]+e);c.attr("data-acc","none");c.addClass("oit-noacc")}this._hdrsection=f.page(0);this._hdrtable=d.byId("oit-maildata");c=d.create("div","oit-headerpadding");
this._hdrtable.parent().insert(c,this._hdrtable);c.append(this._hdrtable);this.tabs=[];b.removeExtraEmailHeaders?this.removeExtraEmailHeaders():d.byId("oit-em_allheaders")&&(this.allHeadersTab=new a.EmailHeaderTab(this,"oit-em_allheaders","oit-email_gear_icon",18,18,h.SHOWDETAILS,h.HIDEDETAILS),this.tabs.push(this.allHeadersTab));this.append(this.tabs);if((c=d.byClass("oit-attachedFile"))&&0<c.length)for(g=0;g<c.length;g++)k=c[g],e=k.data("index"),e=void 0!=e?parseInt(e):g,p.on.addElement(k,e);c=
this._fields=[];if((e=d.bySelector("#oit-maildata tr"))&&0<e.length)for(g=0;g<e.length;g++){var k=e[g],l=k.byClass("oit-emhdrlabel"),m=k.byClass("oit-emhdrvalue");if(l&&m)for(var n=0;n<m.length;n++){var q=l[n],s=m[n];3==s.attr("colspan")&&s.attr("colspan",4);var u=d.create("td","oit-expander");k.insert(u,s);var v=s.firstChildElem(),q={row:k,label:q,expander:u,value:s,content:v,header:this,show:t},u=s.data("acc");void 0!==u&&(u=parseInt(u),s=u+s.text().length,q.range=x.textRange(u,s));c.push(q);v&&
v.addClass("oit-expandable")}}a.on("selection","beginselection",this,this.beginSelection);this.onStyleChanged()};var w=a.subclass(a.EmailHeader,a.Element),t=function(){this.expanded||e.call(this)},e=function(){var a=this.content,b=this.expander,c=this.icon,d=this.header;a&&(b&&c)&&(this.expanded?(a.css("white-space","nowrap"),c.attr("class","oit-expand_icon"),this.expanded=!1,d.applyViewSize(!1),"expandable"===d._selectionPos&&(m.select(null),k.deactivate())):(a.css("white-space","normal"),c.attr("class",
"oit-contract_icon"),this.expanded=!0,d.applyViewSize(!1)),f.each("pageLayoutChanged"))};w.destroy=function(){a.off("selection","beginselection",this.beginSelection);g.each(this.tabs,"destroy");delete this.tabs;delete this.allHeadersTab;a.Element.prototype.destroy.call(this)};var q=function(a){for(var b=0;b<a._fields.length;b++){var c=a._fields[b];c.temprow&&(c.row.append(c.label,c.expander,c.value),c.temprow.destroy(),delete c.temprow);c.content&&c.content.css("width",null);delete c.nowrapHeight;
delete c.wrapWidth;delete c.wrapHeight}},y=function(a){for(var b,c=0;c<a._fields.length;c++){var d=a._fields[c],e=d.content;e&&(d.nowrapHeight=e.offsetHeight,e.css("white-space","normal"),d.wrapWidth=e.offsetWidth,d.wrapHeight=e.offsetHeight,e.css("white-space",null));!d.temprow&&d.row==b&&(d.wrapHeight=d.nowrapHeight);b=d.row}},v=function(a){for(var b=0;b<a._fields.length;b++){var c=a._fields[b],f=c.content;f&&(c.wrapHeight!=c.nowrapHeight?(f.css("width",c.wrapWidth+"px"),c.iconWrap||(f=c.expander,
c.iconWrap=d.create("div"),c.icon=d.create("div","oit-expand_icon"),c.iconWrap.append(c.icon),f.insertFirst(c.iconWrap),f.onclick(c,e),f.ontap(c,e),c.icon.css("visibility","visible"),c.expanded=!1,f.css("cursor","default"))):c.iconWrap&&(c.expander.offclick(e),c.expander.offtap(e),c.iconWrap.destroy(),delete c.iconWrap,delete c.icon))}};w.applyViewSize=function(a){if(!1!==a){a=!1;c.isMobile&&(a=!0);if(!a){q(this);y(this);v(this);var b=this._hdrtable.offsetWidth,e=this._hdrtable.parent().offsetWidth;
b>e&&(a=!0)}if(a){q(this);var g;for(a=0;a<this._fields.length;a++)b=this._fields[a],b.row==g&&(b.temprow=d.create("tr"),b.temprow.append(b.label,b.expander,b.value),b.row.parent().insertAfter(b.temprow,b.row)),g=b.row;y(this);v(this)}}this._hdrsection&&this._hdrsection.css("height",this.offsetHeight+"px");g=0;this._hdrtable&&(g=this._hdrtable.offsetHeight+this._hdrtable.offsetTop);for(a=0;a<this.tabs.length;a++)this.tabs[a].applyViewSize(g);k.onEmailTabActivate();f.each("pageLayoutChanged")};w.finishAnimation=
function(){this._hdrsection&&this._hdrsection.finishAnimation()};w.adjustHeightForTab=function(a,b,c){if(this._hdrsection){var d;a.isActive()?d=this.offsetHeight:this._hdrtable&&(d=this._hdrtable.offsetHeight+13);this._hdrsection.animate({innerHeight:d+4,time:!1===c?0:200,stepFn:k.positionAll,endFn:function(){a.isActive()||a._clientDiv.css("display","none");s.dispatchResize();f.each("pageLayoutChanged");k.onEmailTabActivate();b&&b(a)}})}};var D="attachments calendarexceptions subject to cc bcc from topic priority owner date percent status startdate enddate duedate created category name received fullname first last middle suffix title fileas displayas company jobtitle bphone baddress fax email hphone haddress mobile im webpage entrytype starttime duration reqattend optattend location endtime importance recurtype recurrange".split(" ");
w.beginSelection=function(a){this._selectionPos=null;this.showEmailHeader(a)};w.getEmailHeader=function(a){if(a&&"text"==a.type){for(var b=0;b<this._fields.length;b++){var c=this._fields[b];if(c.range&&x.contains(c.range,a))return{field:c}}if(a=f.page(0).findTextRange(a))for(b=0;b<a.length;b++)for(var c=a[b],d=0;d<this.tabs.length;d++){var e=this.tabs[d].containsRange(c);if(e)return e}}};w.moveto=function(a,b,d){return(a=this.showEmailHeader(a,b,d))&&a.tab?(c.viewNode.scroll(0,0),!0):!1};w.showEmailHeader=
function(a,b,c){var d=this.getEmailHeader(a);d&&(c=c||{},d.field?(d.field.show(),this._selectionPos="expandable",b&&b(c)):d.tab&&(d.tab.activate(null,!0,function(){d.tab.scrollToRange(a);b&&b(c)},c.animate),this._selectionPos="tab"));return d};var u="font font-style font-variant font-weight font-stretch font-size line-height font-family text-transform color background background-image background-position background-size background-repeat background-origin background-clip background-attachment background-color".split(" ");
w.onStyleChanged=function(){var a=b.emailHeaderStyle;this._headerStyle&&this.removeStyle(this._headerStyle);this._headerStyle={};if(a)for(var c in a)-1!=u.indexOf(c)&&(this._headerStyle[c]=a[c]);this.applyEmailHeaderStyles()};w.applyEmailHeaderStyles=function(){try{this._headerStyle&&this.css(this._headerStyle),this.applyViewSize()}catch(a){this.logError("email header style","An error occurred setting email header style")}};w.removeExtraEmailHeaders=function(){this.allHeadersTab&&this.allHeadersTab.activate(null,
!1,null,!1);var a=d.byId("oit-em_allheaders");if(a&&!1!==n.hasRawText()){for(var b=[],c,a=a.createTreeWalker(NodeFilter.SHOW_ELEMENT),e=a.firstACCNode();e;){var f=a.currentNode,e=d.data(f,"acc"),f=f.textContent||f.innerText;e&&f&&f.length?(e=Number(e),f=e+f.length,c&&e<=c.accend+2&&f>=c.acc-2?(c.acc=Math.min(c.acc,e),c.accend=Math.max(c.accend,f)):(c=x.textRange(e,f),b.push(c)),e=a.skipNode()):e=a.nextACCNode()}b.length&&(n.replaceRawText(b),k.removeFromRange(b))}this.allHeadersTab&&(g.remove(this.tabs,
this.allHeadersTab),this.allHeadersTab.destroy(),delete this.allHeadersTab)};a.EmailHeaderTab=function(b,e,f,g,h,k,l){a.Element.call(this,"div","oit-button");d.attach(this);f&&this.addClass(f);this.css({position:"absolute","z-index":40,left:b.offsetWidth-24+"px"});this._header=b;this._minHeight=this._fullHeight=h;this._clientDiv=d.byId(e);this._active=!1;this._utip=k;c.isMobile||this._clientDiv.css("max-height","300px");l&&(this._atip=l);k&&this.attr("title",k);this._clientDiv&&(this._clientDiv.on("scroll",
null,E,this),this._clientDiv.css("display","none"));this.on("click",this,this.activate,"toggle");this.on("tap",this,this.activate,"toggle")};w=a.subclass(a.EmailHeaderTab,a.Element);w.destroy=function(){this._clientDiv&&(this._clientDiv.offscroll(E),this._clientDiv.destroy(),delete this._clientDiv);this.offclick(this.activate);this.offtap(this.activate);a.Element.prototype.destroy.call(this)};var E=function(a,b){var c=b._clientDiv.scroll();if(!b._scroll||c.left!=b._scroll.left||c.top!=b._scroll.top)b._scroll=
c,c=f.page(0),k.deactivate(),c.pageLayoutChanged(),k.positionAll(c)};w.isActive=function(){return void 0!==this._pendingState?this._pendingState:this._active};w.applyViewSize=function(a){this.css({left:this._header.offsetWidth-24+"px",top:a-this._minHeight+"px"})};w.containsRange=function(a){var b=d.wrap(a.startContainer);a=d.wrap(a.endContainer);var c=d.isDescendantOf(b,this._clientDiv);if(c||d.isDescendantOf(a,this._clientDiv))return{tab:this,rangeElem:c?b:a}};w.scrollToRange=function(a){if(this._clientDiv.childByClass("oit-emheadervalues")){var c=
f.page(0);if(a=l.rangeRect(a,c)){var d=this._clientDiv,c=d.pos(c);a.offset(-c.left,-c.top);var c=d.clientWidth,e=d.clientHeight,g=b.zoom;1<g&&(c/=g,e/=g);var h=g=0;0>a.left?g=a.left-10:a.right>c&&(g=a.right+10-c);0>a.top?h=a.top-10:a.bottom>e&&(h=a.bottom+10-e);if(g||h)d.dscroll(g,h),E(null,this)}}};w.activate=function(a,b,c,d){var e=this;a=e._active;"toggle"==b?a=!a:"boolean"===typeof b&&(a=b);if(a==e._active)c&&c(e);else if(a==e._pendingState)c&&e._stateCallbacks.push(c);else{e._header.finishAnimation();
e._pendingState=a;e._stateCallbacks=[];c&&e._stateCallbacks.push(c);!a&&"tab"===e._selectionPos&&(m.select(null),k.deactivate());if(a)for(b=0;b<e._header.tabs.length;b++)e._header.tabs[b]!=e&&e._header.tabs[b].activate(null,!1);a?(e._clientDiv.css("display","block"),e.css("height",e._fullHeight+"px"),e.addClass("oit-activetab"),e._atip&&e.attr("title",e._atip)):(e.css("height",e._minHeight+"px"),e.removeClass("oit-activetab"),e._utip&&e.attr("title",e._utip));e._header.adjustHeightForTab(e,function(){e._active=
e._pendingState;delete e._pendingState;for(var a=0;a<e._stateCallbacks.length;a++)e._stateCallbacks[a](e);delete e._stateCallbacks},d)}}});OIT.extend(function(a){a.glob.libversion="8.5.3.0.1604151004"});OIT.extend(!1);
